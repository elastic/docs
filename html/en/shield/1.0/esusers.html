
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>esusers - Internal File Based Authentication</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Shield - Elasticsearch Security Plugin" /><link rel="up" href="authentication.html" title="Authentication" /><link rel="prev" href="authentication.html" title="Authentication" /><link rel="next" href="ldap.html" title="LDAP Authentication" />
  
 
 	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
 	
	<meta name="description" content="" />
	<meta name="keywords" content="" />



	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
	<link type="text/css" rel="stylesheet" href="/static/css/load.css" />
	<link type="text/css" rel="stylesheet" href="/static/css/skel.css" />		
	
	<script src="/static/js/jquery.min.js"></script>
	<script src="/static/js/loading.js"></script>
	<script src="/static/js/skel.min.js"></script>
	<script src="/static/js/skel-layers.min.js"></script>
	<script src="/static/js/classie.js"></script>	
	<script type="text/javascript">form_name = "common_layout"</script>
	<script src="/static/js/init.js"></script>
	
	<link type="text/css" rel="stylesheet" href="/static/css/prettify.css" />	
	<script type="text/javascript" src="/static/js/prettify.js"></script>



<link rel="stylesheet" type="text/css" href="/static/css/style.css" />
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript">
  jQuery(function() {
    jQuery('#guide a[id]').each(function() { this.href='#'+this.id });
    jQuery('pre.prettyprint').each(function() {
      var pre = jQuery(this);
      pre.css('position','absolute');
      pre.css('width','auto');
      var height = pre.innerHeight();
      pre.wrap('<div class="pre_wrapper" style="height:' + height + 'px"></div>');
    })
  });
</script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

</head>
<body >

	<div class="preloader">
    	<div class="status"></div>
	</div>
	<!-- Google Tag Manager -->
	<script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
													  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script>
	<!-- End Google Tag Manager -->
	
	<div class="header-cont">
		<div id="header-wrapper">
			

<div class="container">
	<div class="row">
		<div class="12u">
			<section>
				<div class="row">
					<div class="8u 6u(small) 5u(xsmall)">
						<div id="elastic">
							<h1><a href="/"></a></h1>
						</div>
						<!-- Searchbar Input box -->
						<form method="get" action="/search" name="searchForm" class="header-search-form">
						   <input type="text" id="search-header" name="q" class="form-control global-input" placeholder="elastic{search}">
						</form>
					</div>
					<div class="4u 6u(small) 7u(xsmall)">
						<!-- Mobile Menu -->
						<div class="mobile-menu-wrapper">
							<ul class="m-shortcuts">
								<li><a id="header-search" class="m-search" href="#"></a></li>
								<li><a class="m-guide" href="/guide"></a></li>
							</ul>											
							<nav class="nav-menu">
								<div class="menu-button">
									<span></span>
								</div>
								<div class="nav-menu-list-wrap">
									<div class="nav-menu-list">
										<h3><a href="/products">Products</a></h3>
										<ul>
											<li><a href="/products/elasticsearch">Elasticsearch</a></li>
											<li><a href="/products/logstash">Logstash</a></li>
											<li><a href="/products/kibana">Kibana</a></li>
											<li><a href="/products/shield">Shield</a></li>
											<li><a href="/products/marvel">Marvel</a></li>
											<li><a href="/products/hadoop">Hadoop</a></li>
											<li><a href="/subscriptions">Support</a></li>
											<li><a href="/downloads">Downloads</a></li>
										</ul>
										<h3><a href="/subscriptions">Subscriptions</a></h3>
										<h3><a href="/learn">Learn</a></h3>
										<ul>
											<li><a href="/guide">Docs</a></li>
											<li><a href="/videos">Videos</a></li>
											<li><a href="http://purchases.elasticsearch.com" target="_blank">Training</a></li>
											<li><a href="/blog">Blog</a></li>
										</ul>
										<h3><a href="/community">Community</a></h3>
										<ul>
											<li><a href="/community/meetups">Meetups</a></li>
										</ul>
										<h3><a href="/use-cases">Use Cases</a></h3>
										<h3><a href="/about">About</a></h3>
										<ul>
											<li><a href="/about/leadership">Leadership</a></li>
											<li><a href="/about/board">Board of Directors</a></li>
											<li><a href="/about/careers">Careers</a></li>
											<li><a href="/about/partners">Partners</a></li>
											<li><a href="/about/press">Press</a></li>
										</ul>
									</div>
								</div>
							</nav>
						</div>
						<!-- Shortcuts -->
						<nav id="shortcuts">
							<ul class="links">
								
									<li class="sc-downloads grayscale"><a href="/downloads" id="header_downloads">downloads</a></li>
								
									<li class="sc-docs grayscale"><a href="/guide" id="header_guide">docs</a></li>
								
									<li class="sc-support grayscale"><a href="/subscriptions" id="header_subscriptions">support</a></li>
								
									<li class="sc-contact grayscale"><a href="/contact" id="header_contact">contact</a></li>
								
							</ul>
						</nav>
					</div>
				</div>
			</section>
			

<section class="desktop-main-nav">
	<div class="row">
		<div class="9u">
			<!-- Nav -->
			<nav id="nav">
				<ul>
					
					<li>
						<a href="/products" id="nav_products" >PRODUCTS</a>
						
						<ul class="dropdown">
							
								<li><a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a></li>								
							
								<li><a href="/products/logstash" id="nav_logstash" >logstash</a></li>								
							
								<li><a href="/products/kibana" id="nav_kibana" >kibana</a></li>								
							
								<li><a href="/products/shield" id="nav_shield" >shield</a></li>								
							
								<li><a href="/products/marvel" id="nav_marvel" >marvel</a></li>								
							
								<li><a href="/products/hadoop" id="nav_hadoop" >hadoop</a></li>								
							
								<li><a href="/subscriptions" id="nav_support" >support</a></li>								
							
								<li><a href="/downloads" id="nav_downloads" >downloads</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/subscriptions" id="nav_subscriptions" >SUBSCRIPTIONS</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/learn" id="nav_learn" >LEARN</a>
						
						<ul class="dropdown">
							
								<li><a href="/guide" id="nav_guide" >docs</a></li>								
							
								<li><a href="/videos" id="nav_videos" >videos</a></li>								
							
								<li><a href="http://purchases.elasticsearch.com" id="nav_training" >training</a></li>								
							
								<li><a href="/blog" id="nav_learn_blog" >blog</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/community" id="nav_community" >COMMUNITY</a>
						
						<ul class="dropdown">
							
								<li><a href="/community/meetups" id="nav_meetups" >meetups</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/use-cases" id="nav_usecases" >USE CASES</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/blog" id="nav_blog" >BLOG</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/about" id="nav_about" >ABOUT</a>
						
						<ul class="dropdown">
							
								<li><a href="/about/leadership" id="nav_leadership" >leadership</a></li>								
							
								<li><a href="/about/board" id="nav_board" >board of directors</a></li>								
							
								<li><a href="/about/careers" id="nav_careers" >careers</a></li>								
							
								<li><a href="/about/partners" id="nav_partners" >partners</a></li>								
							
								<li><a href="/about/press" id="nav_press" >press</a></li>								
								
						</ul>							
					</li>
					
				</ul>
			</nav>
		</div>
		<!-- Search -->
		<div class="3u">
			<div id="searchbar">
				<form method="get" action="/search" name="searchForm">
					<input type="text" value="" name="q" placeholder="elastic{search}">
					<button class="button icon" onclick="searchForm.submit()">GO</button>
				</form>
			</div>
		</div>
	</div>
</section>

		</div>
	</div>
</div>

<style>	
	
		.sc-downloads{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-docs{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-support{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-contact{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
		
</style>
		</div>
	</div>
  	<div id="content">
  		
  			
            <div id="pageheader">
    <div class="container">
        <header>
            <h1>Learn |</h1>
            <h2>Docs</h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Shield - Elasticsearch Security Plugin</a></span> » <span class="breadcrumb-link"><a href="authentication.html">Authentication</a></span> » <span class="breadcrumb-node">esusers - Internal File Based Authentication</span></div><div class="navheader"><span class="prev"><a href="authentication.html">
              « 
              Authentication</a>
           
        </span><span class="next">
           
          <a href="ldap.html">LDAP Authentication
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="esusers"></a>esusers - Internal File Based Authentication</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="esusers.html">esusers - Internal File Based Authentication</a></span></dt><dt><span class="section"><a href="ldap.html">LDAP Authentication</a></span></dt><dt><span class="section"><a href="active_directory.html">Active Directory Authentication</a></span></dt></dl></div><p>The <span class="emphasis"><em>esusers</em></span> realm is the default Shield realm. The <span class="emphasis"><em>esusers</em></span> realm enables the registration of users, passwords for
those users, and associates those users with roles. The <code class="literal">esusers</code> command-line tool assists with the registration and
administration of users.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_literal_esusers_literal_realm_settings"></a><code class="literal">esusers</code> Realm Settings</h3></div></div></div><p>Like all other realms, the <code class="literal">esusers</code> realm is configured under the <code class="literal">shield.authc.realms</code> settings namespace in the
<code class="literal">elasticsearch.yml</code> file. The following snippet shows an example of such configuration:</p><p><strong>Example <code class="literal">esusers</code> Realm Configuration. </strong>
</p><pre class="programlisting prettyprint lang-yaml">shield:
  authc:
    realms:
      default:
        type: esusers
        order: 0</pre><p>
</p><div class="table"><a id="esusers-settings"></a><p class="title"><strong>Table 1. <code class="literal">esusers</code> Realm Settings</strong></p><div class="table-contents"><table summary="esusers Realm Settings" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><tbody><tr><td align="left" valign="top"><p>Setting</p></td><td align="left" valign="top"><p>Required</p></td><td align="left" valign="top"><p>Description</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">type</code></p></td><td align="left" valign="top"><p>yes</p></td><td align="left" valign="top"><p>Indicates the realm type and must be set to <code class="literal">esusers</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">order</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>Indicates the priority of this realm within the realm chain. Realms with lower order will be consulted first. Although not required, it is highly recommended to explicitly set this value when multiple realms are configured. Defaults to <code class="literal">Integer.MAX_VALUE</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">enabled</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>Indicates whether this realm is enabled/disabled. Provides an easy way to disable realms in the chain without removing their configuration. Defaults to <code class="literal">true</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">files.users</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>Points to the location of the <code class="literal">users</code> file where the users and their passwords are stored. Defaults to <code class="literal">users</code> file under shield’s <a class="link" href="getting-started.html#shield-config">config directory</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">files.users_roles</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>Points to the location of the <code class="literal">users_roles</code> file where the users and their roles are stored. Defaults to <code class="literal">users_roles</code> file under shield’s <a class="link" href="getting-started.html#shield-config">config directory</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">cache.ttl</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specified the time-to-live for cached user entries (a user and its credentials will be cached for this configured period of time). Defaults to <code class="literal">20m</code> (use the standard elasticsearch <a class="ulink" href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/common-options.html#time-units" target="_top">time units</a>).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">cache.max_users</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specified the maximum number of user entries that can live in the cache at a given time. Defaults to 100,000.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">cache.hash_algo</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>(Expert Setting) Specifies the hashing algorithm that will be used for the in-memory cached user credentials (see <a class="link" href="esusers.html#esusers-cache-hash-algo" title="Table 2. Cache hash algorithms">here</a> for possible values).</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>When no realms are explicitly configured in <code class="literal">elasticsearch.yml</code>, a default realm chain will be created that holds
      a single <code class="literal">esusers</code> realm. If you wish to only work with <code class="literal">esusers</code> realm and you’re satisfied with the default
      files paths, there is no real need to add the above configuration.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_the_literal_esusers_literal_command_line_tool"></a>The <code class="literal">esusers</code> Command Line Tool</h3></div></div></div><p>The <code class="literal">esusers</code> command line tool is located under Shield’s <a class="link" href="getting-started.html#shield-bin">bin</a> directory and enables several
administrative tasks for managing users:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="link" href="esusers.html#esusers-add" title="Adding Users">Adding users</a>
</li><li class="listitem">
<a class="link" href="esusers.html#esusers-list" title="Listing Users">Listing users and roles</a>
</li><li class="listitem">
<a class="link" href="esusers.html#esusers-pass" title="Changing Users' Passwords">Managing user passwords</a>
</li><li class="listitem">
<a class="link" href="esusers.html#esusers-roles" title="Changing Users' Roles">Managing users' roles</a>
</li><li class="listitem">
<a class="link" href="esusers.html#esusers-del" title="Deleting Users">Removing users</a>
</li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="esusers-add"></a>Adding Users</h4></div></div></div><p>The <code class="literal">esusers useradd</code> command adds a user to your cluster.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>To ensure that Elasticsearch can read the user and role information at startup, run <code class="literal">esusers useradd</code> as the
      same user you use to run Elasticsearch. Running the command as root or some other user will update the permissions
      for the <code class="literal">users</code> and <code class="literal">users_roles</code> files and prevent Elasticsearch from accessing them.</p></div></div><pre class="programlisting prettyprint lang-shell">esusers useradd &lt;username&gt;</pre><p>A username must be at least 1 character and no longer than 30 characters. The first character must be a letter
(<code class="literal">a-z</code> or <code class="literal">A-Z</code>) or an underscore (<code class="literal">_</code>). Subsequent characters can be letters, underscores (<code class="literal">_</code>), digits (<code class="literal">0-9</code>), or any
of the following symbols <code class="literal">@</code>, <code class="literal">-</code> or <code class="literal">$</code></p><p>You can specify the user’s password at the command line with the <code class="literal">-p</code> option. When this option is absent, the
<code class="literal">esusers</code> command prompts you for the password. Omit the <code class="literal">-p</code> option to keep plaintext passwords out of the terminal
session’s command history.</p><pre class="programlisting prettyprint lang-shell">esusers useradd &lt;username&gt; -p &lt;secret&gt;</pre><p>Passwords must be at least 6 characters long.</p><p>You can define a user’s roles with the <code class="literal">-r</code> parameter. This parameter accepts a comma-separated list of role names to
associate with the user.</p><pre class="programlisting prettyprint lang-shell">esusers useradd &lt;username&gt; -r &lt;comma-separated list of role names&gt;</pre><p>The following example adds a new user named <code class="literal">jacknich</code> to the <span class="emphasis"><em>esusers</em></span> realm. The password for this user is
<code class="literal">theshining</code>, and this user is associated with the <code class="literal">logstash</code> and <code class="literal">marvel</code> roles.</p><pre class="programlisting prettyprint lang-shell">esusers useradd jacknich -p theshining -r logstash,marvel</pre><p>For valid role names please see <a class="link" href="authorization.html#valid-role-name" title="Note">Role Definitions</a>.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="esusers-list"></a>Listing Users</h4></div></div></div><p>The <code class="literal">esusers list</code> command lists the users registered in the <span class="emphasis"><em>esusers</em></span> realm, as in the following example:</p><pre class="programlisting prettyprint lang-shell">esusers list
rdeniro        : admin
alpacino       : power_user
jacknich       : marvel,logstash</pre><p>Users are in the left-hand column and their corresponding roles are listed in the right-hand column.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_listing_specific_users"></a>Listing Specific Users</h4></div></div></div><p>The <code class="literal">esusers list &lt;username&gt;</code> command lists a specific user. Use this command to verify that a user has been
successfully added to the cluster.</p><pre class="programlisting prettyprint lang-shell">esusers list jacknich
jacknich       : marvel,logstash</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="esusers-pass"></a>Changing Users' Passwords</h4></div></div></div><p>The <code class="literal">esusers passwd</code> command enables you to reset a user’s password. You can specify the new password directly with the
<code class="literal">-p</code> option. When <code class="literal">-p</code> option is omitted, the tool will prompt you to enter and confirm a password in interactive mode.</p><pre class="programlisting prettyprint lang-shell">esusers passwd &lt;username&gt;</pre><pre class="programlisting prettyprint lang-shell">esusers passwd &lt;username&gt; -p &lt;password&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="esusers-roles"></a>Changing Users' Roles</h4></div></div></div><p>The <code class="literal">esusers roles</code> command manages the roles associated to a particular user. The <code class="literal">-a</code> option adds a comma-separated
list of roles to a user. The <code class="literal">-r</code> option removes a comma-separated list of roles from a user. You can combine adding and
removing roles within the same command to change a user’s roles.</p><pre class="programlisting prettyprint lang-shell">esusers roles &lt;username&gt; -a &lt;commma-separate list of roles&gt; -r &lt;commma-separate list of roles&gt;</pre><p>The following command removes the <code class="literal">logstash</code> and <code class="literal">marvel</code> roles from user <code class="literal">jacknich</code>, as well as adding the <code class="literal">user</code> role:</p><pre class="programlisting prettyprint lang-shell">esusers roles jacknich -r logstash,marvel -a user</pre><p>Listing the user displays the new role assignment:</p><pre class="programlisting prettyprint lang-shell">esusers list jacknich
jacknich       : user</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="esusers-del"></a>Deleting Users</h4></div></div></div><p>The <code class="literal">esusers userdel</code> command deletes a user.</p><pre class="programlisting prettyprint lang-shell">userdel &lt;username&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_how_literal_esusers_literal_works"></a>How <code class="literal">esusers</code> Works</h3></div></div></div><p>The <code class="literal">esusers</code> tool manipulates two files, <code class="literal">users</code> and <code class="literal">users_roles</code>, in Shield’s
<a class="link" href="getting-started.html#shield-config">config</a> directory. These two files store all user data for the <span class="emphasis"><em>esusers</em></span> realm and are read by Shield
on startup.</p><p>By default, Shield checks these files for changes every 5 seconds. You can change this default behavior by changing the
value of the <code class="literal">watcher.interval.high</code> setting in the <code class="literal">elasticsearch.yml</code> file.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>These files are managed locally by the node and are <span class="strong"><strong>not</strong></span> managed
globally by the cluster. This means that with a typical multi-node cluster,
the exact same changes need to be applied on each and every node in the
cluster.</p><p>A safer approach would be to apply the change on one of the nodes and have the
<code class="literal">users</code> and <code class="literal">users_roles</code> files distributed/copied to all other nodes in the
cluster (either manually or using a configuration management system such as
Puppet or Chef).</p></div></div><p>While it is possible to modify these files directly using any standard text
editor, we strongly recommend using the <code class="literal">esusers</code> command-line tool to apply
the required changes.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="users-file"></a>The <code class="literal">users</code> File</h4></div></div></div><p>The <code class="literal">users</code> file stores all the users and their passwords. The format of the <code class="literal">users</code> file follows the format of
an <code class="literal">htpasswd</code> file from a standard Apache webserver, where each line contains a single user entry that holds its
username and its <span class="strong"><strong>hashed</strong></span> password.</p><pre class="programlisting prettyprint lang-bash">rdeniro:$2a$10$BBJ/ILiyJ1eBTYoRKxkqbuDEdYECplvxnqQ47uiowE7yGqvCEgj9W
alpacino:$2a$10$cNwHnElYiMYZ/T3K4PvzGeJ1KbpXZp2PfoQD.gfaVdImnHOwIuBKS
jacknich:$2a$10$GYUNWyABV/Ols/.bcwxuBuuaQzV6WIauW6RdboojxcixBq3LtI3ni</pre><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The <code class="literal">esusers</code> command-line tool uses <code class="literal">bcrypt</code> to hash the password by default.  All of the <code class="literal">htpasswd</code> hash
      algorithms are available as an option.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="users_roles-file"></a>The <code class="literal">users_roles</code> File</h4></div></div></div><p>The <code class="literal">users_roles</code> file stores the roles associated with the users, as in the following example:</p><pre class="programlisting prettyprint lang-shell">admin:rdeniro
power_user:alpacino,jacknich
user:jacknich</pre><p>Each row maps a role to a comma-separated list of all the users that are associated with that role.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_user_cache"></a>User Cache</h3></div></div></div><p>The user credentials are not stored on disk in clear text. The esusers creates a <code class="literal">bcrypt</code> hashes of the passwords and
stores those. <code class="literal">bcrypt</code> is considered to be highly secured hash and by default it uses 10 rounds to generate the salts
it hashes with. While highly secured, it is also relatively slow. For this reason, Shield also introduce an in-memory
cache over the <code class="literal">esusers</code> store. This cache can use a different hashing algorithm for storing the passwords in memeory.
The default hashing algorithm that is used is <code class="literal">bcrypt4</code> - a bcrypt algorithm that uses 4 rounds for salt generation.</p><p>We’ve seen in the table <a class="link" href="esusers.html#esusers-settings" title="Table 1. esusers Realm Settings">above</a> that the cache characteristics can be configured. The following table
describes the different hash algorithm that can be set:</p><div class="table"><a id="esusers-cache-hash-algo"></a><p class="title"><strong>Table 2. Cache hash algorithms</strong></p><div class="table-contents"><table summary="Cache hash algorithms" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><tbody><tr><td align="left" valign="top"><p>Algorithm</p></td><td align="left" valign="top"><p>Description</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bcrypt</code></p></td><td align="left" valign="top"><p>Uses <code class="literal">bcrypt</code> algorithm with salt generated in 10 rounds.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bcrypt4</code></p></td><td align="left" valign="top"><p>Uses <code class="literal">bcrypt</code> algorithm with salt generated in 4 rounds (default).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bcrypt5</code></p></td><td align="left" valign="top"><p>Uses <code class="literal">bcrypt</code> algorithm with salt generated in 5 rounds.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bcrypt6</code></p></td><td align="left" valign="top"><p>Uses <code class="literal">bcrypt</code> algorithm with salt generated in 6 rounds.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bcrypt7</code></p></td><td align="left" valign="top"><p>Uses <code class="literal">bcrypt</code> algorithm with salt generated in 7 rounds.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bcrypt8</code></p></td><td align="left" valign="top"><p>Uses <code class="literal">bcrypt</code> algorithm with salt generated in 8 rounds.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bcrypt9</code></p></td><td align="left" valign="top"><p>Uses <code class="literal">bcrypt</code> algorithm with salt generated in 9 rounds.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">sha1</code></p></td><td align="left" valign="top"><p>Uses <code class="literal">SHA1</code> algorithm.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">sha2</code></p></td><td align="left" valign="top"><p>Uses <code class="literal">SHA2</code> algorithm.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">md5</code></p></td><td align="left" valign="top"><p>Uses <code class="literal">MD5</code> algorithm.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">noop</code>,<code class="literal">clear_text</code></p></td><td align="left" valign="top"><p>Doesn’t hash the credentials and keeps it in clear text in memory. CAUTION:
                                    keeping clear text is considered insecure and can be compromised at the OS
                                    level (e.g. memory dumps and <code class="literal">ptrace</code>).</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_cache_eviction_api"></a>Cache Eviction API</h4></div></div></div><p>Shield exposes an API to force cached user eviction. The following example, evicts all users from the <code class="literal">ldap1</code>
realm:</p><pre class="programlisting prettyprint lang-java">$ curl -XPOST 'http://localhost:9200/_shield/realm/esusers/_cache/clear'</pre><p>It is also possible to evict specific users:</p><pre class="programlisting prettyprint lang-java">$ curl -XPOST 'http://localhost:9200/_shield/realm/esusers/_cache/clear?usernames=rdeniro,alpacino'</pre><p>Multiple realms can also be specified using comma-delimited list:</p><pre class="programlisting prettyprint lang-java">$ curl -XPOST 'http://localhost:9200/_shield/realm/esusers,ldap1/_cache/clear'</pre></div></div></div><div class="navfooter"><span class="prev"><a href="authentication.html">
              « 
              Authentication</a>
           
        </span><span class="next">
           
          <a href="ldap.html">LDAP Authentication
               »
            </a></span></div>
<!-- end body -->

            </section>
<script type="text/javascript" >
  (function ($, $a, $title, $list) {
    $a = $('[id^="js-api-method-index"]');
    if (!$a.size()) return;
    $('#guide').addClass('js-client-docs');
    $list = $a.siblings('.itemizedlist').detach();
    $title = $(document.createElement('h2')).text('api methods')
    $a.parent().remove();
    $('.toc').first().append($(document.createElement('div')).addClass('js-api-method-index').append($title).append($list));
  }(jQuery));
</script>

            <!-- Footer -->
        
	<div id="footer-wrapper">
		<section id="footer" class="container">
			<div class="row">
				<div class="12u">
					<!-- Copyright -->
					<div id="copyright">
	<p>
		© 2015. All Rights Reserved - Elasticsearch
	</p>
	<ul class="links">
		<li>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</li>
		<li><a href="/legal/trademarks" id="footer_trademarks">Trademarks</a></li>
		<li><a href="/legal/terms-of-use" id="footer_terms">Terms</a></li>
		<li><a href="/legal/privacy-policy" id="footer_privacy">Privacy</a></li>
	</ul>
	<p>
		Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other&nbsp;countries.
	</p>
</div>
<!--<div class="row">
{replace4}
</div>-->
				</div>
			</div>					
		</section>
	</div>
			
	<!-- Social Media -->
	<div id="socialmedia-wrapper">
		<section id="socialmedia" class="container">
			<!-- social icons -->
			<div id="social">
				<ul class="links">
					
						<li class="facebook grayscale"><a href="http://www.facebook.com/elastic.co" target="_blank" id="footer_facebook"></a></li>
					
						<li class="twitter grayscale"><a href="https://www.twitter.com/elastic" target="_blank" id="footer_twitter"></a></li>
					
						<li class="linkedin grayscale"><a href="http://www.linkedin.com/company/elasticsearch" target="_blank" id="footer_linkedin"></a></li>
					
						<li class="xing grayscale"><a href="https://www.xing.com/companies/elasticsearch" target="_blank" id="footer_xing"></a></li>
					
				</ul>
			</div>
		</section>
	</div>


<style type="text/css">
	
		.facebook{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.twitter{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.linkedin{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.xing{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
</style>	

  	</div>
  	<div class="preloader">
    	<div class="status"></div>
	</div>
  	<style></style>
   	<link type="text/css" rel="stylesheet" href="/static/css/flexslider.css" >

<script src="/static/js/jquery.flexslider.min.js"></script>
<script src="/static/js/jquery.dropdown.min.js"></script>
<script src="/static/js/script.js"></script>
   	
</body>