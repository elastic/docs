<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>LDAP User Authentication
        | X-Pack for the Elastic Stack [5.3]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="X-Pack for the Elastic Stack [5.3]" /><link rel="up" href="setting-up-authentication.html" title="Setting Up User Authentication" /><link rel="prev" href="native-realm.html" title="Native User Authentication" /><link rel="next" href="active-directory-realm.html" title="Active Directory User Authentication" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/XPack/Reference/5.3" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.subject" content="X-Pack" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.identifier" content="5.3" />
    

    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
<meta name="apple-mobile-web-app-title" content="Elastic">
<meta name="application-name" content="Elastic">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- DC tags section -->
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
<link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >



	



<!-- end DC tags -->


	<meta name="description" content="" />



	<meta name="localized" content="true" />


















		
			<meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
		

		

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">

	 

    <!-- css -->
    <link href="/static/css/main.css" rel="stylesheet">
    
    

    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  <script type="text/javascript">
  // -------------------- set language based on browser language --------------------
  var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
      locales = {
        '/en':'/',
        '/de/': '/de/',
        '/fr/': '/fr/',
        '/ja/':'/jp/',
        '/ko/':'/kr/',
        '/zh/':'/cn/',
        '/pt/': '/pt/',
        '/es/': '/es/'
      },
      localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}',
      currentlocale = JSON.parse(localeUrl).relative_url_prefix;

  if($.cookie("is_lang_detected") == undefined){
    if(locales[lang] != undefined && locales[lang] != currentlocale){
      locale_lang_url = locales[lang] + window.location.pathname.slice(1,window.location.pathname.length);
      $.cookie("is_lang_detected",true ,{ path: '/'}); 
      window.location = locale_lang_url;
    } 
  }
        
  // --------------------- end of set language based on browser language -----------------
  </script>

	
	<link type="text/css" rel="stylesheet" href="/static/css/guide.css" />


  
<link rel="stylesheet" type="text/css" href="styles.css" />

</head>
  <body >
  	<!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
                              height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <script src="/static/js/elastic-apm-js-base.umd.min.1.0.0.js"></script>

    
    <script type="text/javascript">
      var active;
      
      active = Math.random() < 1
      
      elasticApm.init({
      active: active,
      serviceName: "elastic-co-frontend",
      serverUrl: "https://elastic-co-apm-server.app.elstc.co"
      })
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(window.location.href);
    </script>
    
    <!-- Elastic APM -->

    <!-- Header Section -->
    
<header class="header-wrapper">
  



  




<div class="navigation-wrapper">
  <div class="container">
    <nav class="navbar">
    <!-- Brand and toggle get grouped for better mobile display -->

    <div class="navbar-mobile-header navbar-header mr-20 mr-xs-0">
      <div class="row hidden-sm hidden-md hidden-lg">
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg">
          <div class="navbar-mobile-header-icon navbar-mobile-header-icon-out">
            <span></span>
            <span></span>
            <span></span>
          </div>
          
        </div>
        <div class="col-xs-2 text-center">
          <div class="navbar-brand" id="elastic">
            <div id="logo">
              <a class="logo-m hidden-sm hidden-md hidden-lg" href="/">
                <img src="/assets/blta09706b1c5cc1e99/elastic-logo-mobile.svg" alt="elastic-logo-mobile">
              </a>
            </div>
          </div>
        </div>
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right">
          <ul class="menu-m hidden-sm hidden-md hidden-lg">
            <li class=""><a class="icon-contact" href="/contact"></a></li>

            <li id="searchbar"><a class="button icon" href="#" alt="Search"></a></li>
            <li class="lang global-language">
                
                  
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              <ul class="language-list">
                
                  
                    
                  
                  
                  <li><a href="/de/" data-value="/de/" id="locale-select">Deutsch</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="#" data-value="/" id="locale-select">English</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="/es/" data-value="/es/" id="locale-select">Español</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="/fr/" data-value="/fr/" id="locale-select">Français</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="/jp/" data-value="/jp/" id="locale-select">日本語</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="/kr/" data-value="/kr/" id="locale-select">한국어</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="/cn/" data-value="/cn/" id="locale-select">简体中文</a></li>
                  
                
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <div class="navbar-brand hidden-xs" id="elastic">
        <div id="logo">
          <a class="hidden-xs" id="elastic-logo" href="/">
            <img src="/assets/blt244a845f141977c3/elastic-logo.svg" alt="elastic-logo">
          </a>
        </div>
      </div>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse mobile-inner-nav">
      <nav class="nav navbar-nav primary-nav-hover" id="nav">
        <ul>
        
          
            
              
            
            <li>
              <a class=" " href="/products">Products</a>
            </li>
          
        
          
            
              
            
            <li>
              <a class=" " href="/cloud">Cloud</a>
            </li>
          
        
          
            
              
            
            <li>
              <a class=" " href="/services">Services</a>
            </li>
          
        
          
            
              
            
            <li>
              <a class=" " href="/use-cases">Customers</a>
            </li>
          
        
          
            
              
            
            <li>
              <a class=" " href="/learn">Learn</a>
            </li>
          
        
          
        
        </ul>
      </nav>
      <nav class="nav navbar-nav navbar-right hidden-xs">
        <ul>
          <li class="hidden-xs hidden-sm"><a href="/downloads">downloads</a></li>
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li>
          <!-- To set parameters to contact button -->
          
           
            
          

          
            
            
          
          <li class="hidden-xs hidden-sm"><a class="btn btn-secondary btn-contact" href="/contact?storm=global-header-en">contact</a></li>
          <!-- ////////////////ends here///////////////-->          
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact?storm=global-header-en"></a></li>
          <li class="hidden-xs" id="searchbar"><a class="button icon" href="#" alt="Search"></a></li>

          <li class="hidden-xs lang global-language">
                
                  
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
               <ul class="language-list">
              
                
                  
                
              
              <li><a class="" href="/de/" data-value="/de/">Deutsch</a></li>
              
              
                
                  
                
              
              <li><a class="" href="#" data-value="/">English</a></li>
              
              
                
                  
                
              
              <li><a class="" href="/es/" data-value="/es/">Español</a></li>
              
              
                
                  
                
              
              <li><a class="" href="/fr/" data-value="/fr/">Français</a></li>
              
              
                
                  
                
              
              <li><a class="" href="/jp/" data-value="/jp/">日本語</a></li>
              
              
                
                  
                
              
              <li><a class="" href="/kr/" data-value="/kr/">한국어</a></li>
              
              
                
                  
                
              
              <li><a class="" href="/cn/" data-value="/cn/">简体中文</a></li>
              
              
            </ul>
          </li>
        </ul>
      </nav>
    </div><!-- /.navbar-collapse -->
  </nav>
  </div>
</div>

<div class="header-search-wrapper open-search"> 
  <div class="container">
    <div class="big-search">
      <i class="big-search-icon"></i>
      <form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get">
        <ul class="tags-wrapper">
          <li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li>
        </ul>
      </form>
      <a class="header-search-cancel" href="#"></a>
    </div>
    <div class="nav-auto-complete"></div>
  </div>
</div>
</header>
<link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">
<style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
    
</style>
<script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>
<script type="text/javascript">
  $(document).ready( function(){
    // if($('#scrollable-pane li').length > 3){
      $('.horizon-swiper').horizonSwiper({
        showItems: 3,
        arrows: true
      }); 
    // }
    
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
    });

    var active_url = "";

    $(".navbar-mobile-header-icon").click(function(index){
      $('.navigation-wrapper').toggleClass('menu-overlay');
      $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
      $(".mobile-inner-nav").slideToggle(500);
      $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
        $(this).css({'animation-delay': (index/25)+'0.4s'});
      });
    });

    $('.dropdown-btn').on('click', function(e){
      e.preventDefault();
      setDropdown();
    });
    
    function setDropdown() {
      $('#myDropdown').slideToggle();
    }

    $('body').on('click', function(event){
      if (!event.target.matches('.dropdown-btn')) {

        var dropdowns = $(".dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    });

    // if($(window).width() < 769){
    //   var $item = $('.scrollable-panel li'), 
    //       visible = 3, //Set the number of items that will be visible
    //       index = 0, //Starting index
    //       endIndex = ( $item.length / visible ) - 1; //End index (NOTE:: Requires visible to be a factor of $item.length... You can improve this by rounding...)

    //   $('#right-arrow').click(function(){
    //     if(index < endIndex ){
    //       index++;
    //       $item.animate({'left':'-=300px'});
    //     }
    //   });

    //   $('#left-arrow').click(function(){
    //     if(index > 0){
    //       index--;            
    //       $item.animate({'left':'+=300px'});
    //     }
    //   });
    // }
  });
  $(window).resize(function () {
    $('.horizon-swiper').horizonSwiper({
      showItems: 3,
      arrows: true
    });
  });
</script>
    
      


  





  
  
  
  
    <div class="tertiary-nav bdr-btm-e0e0e0">
      <div class="container">
        <div class="p-t-b-15 clearfix">
          <div class="breadcrum-wrapper pull-left text-left">
          
            <a href="/guide">Docs</a> 
          
          </div>
          
          
          
        </div>
      </div>
    </div>

    <div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg bdr-btm-e0e0e0 clearfix">
      <div class="container text-right">
        <div class="breadcrum-wrapper pull-left text-left">
          
              <a href="/guide">Docs</a>
          
        </div>
        
        
      </div>
    </div>
  


<style type="text/css">

  
</style>
    
    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   
          
            
        			<!-- <div class="pageheader">
	<div class="common-container">
		
			<h2 class="page-title">Guide template</h2>
		
	</div>
</div> -->


        		
          

          
	<section id="guide" lang="en">
		<div class="container">
			<div class="row">
			  <!-- start body -->
				
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">X-Pack for the Elastic Stack
      [5.3]
    </a></span> » <span class="breadcrumb-link"><a href="xpack-security.html">Securing Elasticsearch and Kibana</a></span> » <span class="breadcrumb-link"><a href="setting-up-authentication.html">Setting Up User Authentication</a></span> » <span class="breadcrumb-node">LDAP User Authentication</span></div><div class="navheader"><span class="prev"><a href="native-realm.html">
              « 
              Native User Authentication</a>
           
        </span><span class="next">
           
          <a href="active-directory-realm.html">Active Directory User Authentication
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ldap-realm"></a>LDAP User Authentication</h2></div></div></div><p>You can configure X-Pack security to communicate with a Lightweight Directory Access
Protocol (LDAP) server to authenticate users. To integrate with LDAP, you
configure an <code class="literal">ldap</code> realm and map LDAP groups to user roles in the
<a class="link" href="mapping-roles.html" title="Mapping Users and Groups to Roles">role mapping file</a>.</p><p>To protect passwords, communications between Elasticsearch and the LDAP server
should be encrypted using SSL/TLS. Clients and nodes that connect via SSL/TLS to
the LDAP server need to have the LDAP server’s certificate or the server’s root
CA certificate installed in their <span class="emphasis"><em>keystore</em></span> or <span class="emphasis"><em>truststore</em></span>. For more information
about installing certificates, see <a class="xref" href="ldap-realm.html#ldap-ssl" title="Setting up SSL Between Elasticsearch and LDAP">Setting up SSL Between Elasticsearch and LDAP</a>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_configuring_an_ldap_realm"></a>Configuring an LDAP Realm</h3></div></div></div><p>LDAP stores users and groups hierarchically, similar to the way folders are
grouped in a file system. An LDAP directory’s hierarchy is built from containers
such as the <span class="emphasis"><em>organizational unit</em></span> (<code class="literal">ou</code>), <span class="emphasis"><em>organization</em></span> (<code class="literal">o</code>), and
<span class="emphasis"><em>domain controller</em></span> (<code class="literal">dc</code>).</p><p>The path to an entry is a <span class="emphasis"><em>Distinguished Name</em></span> (DN) that uniquely identifies a
user or group. User and group names typically have attributes such as a
<span class="emphasis"><em>common name</em></span> (<code class="literal">cn</code>) or <span class="emphasis"><em>unique ID</em></span> (<code class="literal">uid</code>). A DN is specified as a string,
for example  <code class="literal">"cn=admin,dc=example,dc=com"</code> (white spaces are ignored).</p><p>The <code class="literal">ldap</code> realm supports two modes of operation, a user search mode
and a mode with specific templates for user DNs. See
<a class="link" href="ldap-realm.html#ldap-settings" title="LDAP Realm Settings">LDAP Realm Settings</a> for all of the options you can set for an
<code class="literal">ldap</code> realm.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ldap-user-search"></a>User Search Mode</h4></div></div></div><p>LDAP user search is the most common mode of operation. In this mode, a specific
user with permission to search the LDAP directory is used to search for the
authenticating user DN based on its username and an LDAP attribute. Once found,
the user will be authenticated by attempting to bind to the LDAP server using the
found DN and the provided password.</p><p>To configure an <code class="literal">ldap</code> Realm with User Search:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
Add a realm configuration of type <code class="literal">ldap</code> to <code class="literal">elasticsearch.yml</code> under the
<code class="literal">xpack.security.authc.realms</code> namespace. At a minimum, you must set the realm <code class="literal">type</code>
to <code class="literal">ldap</code>, specify the <code class="literal">url</code> of the LDAP server, and set <code class="literal">user_search.base_dn</code>
to the container DN where the users are searched for. If you are configuring
multiple realms, you should also explicitly set the <code class="literal">order</code> attribute to control
the order in which the realms are consulted during authentication. See
<a class="link" href="ldap-realm.html#ldap-settings" title="LDAP Realm Settings">LDAP Realm Settings</a> for all of the options you can set for an
<code class="literal">ldap</code> realm.
</p><p class="simpara">For example, the following snippet shows an LDAP realm configured with a user search:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: "ldaps://ldap.example.com:636"
          bind_dn: "cn=ldapuser, ou=users, o=services, dc=example, dc=com"
          bind_password: changeme
          user_search:
            base_dn: "dc=example,dc=com"
            attribute: cn
          group_search:
            base_dn: "dc=example,dc=com"
          files:
            role_mapping: "CONFIG_DIR/x-pack/role_mapping.yml"
          unmapped_groups_as_roles: false</pre></div><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>When you configure realms in <code class="literal">elasticsearch.yml</code>, only the
realms you specify are used for authentication. If you also want to use the
<code class="literal">native</code> or <code class="literal">file</code> realms, you must include them in the realm chain.</p></div></div></li><li class="listitem">
Restart Elasticsearch
</li></ol></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_user_dn_templates_mode"></a>User DN Templates Mode</h4></div></div></div><p>If your LDAP environment uses a few specific standard naming conditions for
users, you can use User DN templates to configure the realm. The advantage of
this method is that a search does not have to be performed to find the user DN.
However, multiple bind operations might be needed to find the correct user DN.</p><p>To configure an <code class="literal">ldap</code> Realm with User Search:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
Add a realm configuration of type <code class="literal">ldap</code> to <code class="literal">elasticsearch.yml</code> in the
<code class="literal">xpack.security.authc.realms</code> namespace. At a minimum, you must set the realm <code class="literal">type</code> to
<code class="literal">ldap</code>, specify the <code class="literal">url</code> of the LDAP server, and specify at least one template
with the <code class="literal">user_dn_templates</code> option. If you are configuring multiple realms, you
should also explicitly set the <code class="literal">order</code> attribute to control the order in which
the realms are consulted during authentication. See <a class="link" href="ldap-realm.html#ldap-settings" title="LDAP Realm Settings">LDAP Realm Settings</a>
for all of the options you can set for an <code class="literal">ldap</code> realm.
</p><p class="simpara">For example, the following snippet shows an LDAP realm configured with User DN templates:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: "ldaps://ldap.example.com:636"
          user_dn_templates:
            - "cn={0}, ou=users, o=marketing, dc=example, dc=com"
            - "cn={0}, ou=users, o=engineering, dc=example, dc=com"
          group_search:
            base_dn: "dc=example,dc=com"
          files:
            role_mapping: "/mnt/elasticsearch/group_to_role_mapping.yml"
          unmapped_groups_as_roles: false</pre></div></li><li class="listitem">
Restart Elasticsearch
</li></ol></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ldap-load-balancing"></a>Load Balancing and Failover</h4></div></div></div><p>The <code class="literal">load_balance.type</code> setting can be used at the realm level to configure how
X-Pack security should interact with multiple LDAP servers. X-Pack security supports both
failover and load balancing modes of operation.</p><div class="table"><a id="id-1.5.5.11.4.7.3"></a><p class="title"><strong>Table 5. Load Balancing and Failover Types</strong></p><div class="table-contents"><table summary="Load Balancing and Failover Types" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><tbody><tr><td align="left" valign="top"><p>Type</p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p>Description</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">failover</code></p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p>The URLs specified are used in the order that they are specified.
                          The first server that can be connected to will be used for all
                          subsequent connections. If a connection to that server fails then
                          the next server that a connection can be established to will be
                          used for subsequent connections.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">dns_failover</code></p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p>In this mode of operation, only a single URL may be specified.
                          This URL must contain a DNS name. The system will be queried for
                          all IP addresses that correspond to this DNS name. Connections to
                          the LDAP server will always be tried in the order in which they
                          were retrieved. This differs from <code class="literal">failover</code> in that there is no
                          reordering of the list and if a server has failed at the beginning
                          of the list, it will still be tried for each subsequent connection.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">round_robin</code></p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p>Connections will continuously iterate through the list of provided
                          URLs. If a server is unavailable, iterating through the list of
                          URLs will continue until a successful connection is made.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">dns_round_robin</code></p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p>In this mode of operation, only a single URL may be specified. This
                          URL must contain a DNS name. The system will be queried for all IP
                          addresses that correspond to this DNS name. Connections will
                          continuously iterate through the list of addresses. If a server is
                          unavailable, iterating through the list of URLs will continue until
                          a successful connection is made.</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ldap-settings"></a>LDAP Realm Settings</h4></div></div></div><div class="table"><a id="id-1.5.5.11.4.8.2"></a><p class="title"><strong>Table 6. Common LDAP Realm Settings</strong></p><div class="table-contents"><table summary="Common LDAP Realm Settings" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><tbody><tr><td align="left" valign="top"><p>Setting</p></td><td align="center" valign="top"><p>Required</p></td><td align="left" valign="top"><p>Description</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">type</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>Indicates the realm type. Must be set to <code class="literal">ldap</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">order</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Indicates the priority of this realm within the realm
                                              chain. Realms with a lower order are consulted first.
                                              Although not required, we recommend explicitly
                                              setting this value when you configure multiple realms.
                                              Defaults to <code class="literal">Integer.MAX_VALUE</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">enabled</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Indicates whether this realm is enabled or disabled.
                                              Enables you to disable a realm without removing its
                                              configuration. Defaults to <code class="literal">true</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">url</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>Specifies one or more LDAP URLs of the form of
                                              <code class="literal">ldap[s]://&lt;server&gt;:&lt;port&gt;</code>. Multiple URLs can be
                                              defined using a comma separated value or array syntax:
                                              <code class="literal">[ "ldaps://server1:636", "ldaps://server2:636" ]</code>.
                                              <code class="literal">ldaps</code> and <code class="literal">ldap</code> URL protocols cannot be mixed in
                                              the same realm.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">load_balance.type</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The behavior to use when there are multiple LDAP URLs
                                              defined. For supported values see
                                              <a class="link" href="ldap-realm.html#ldap-load-balancing" title="Load Balancing and Failover">LDAP load balancing and failover types</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">load_balance.cache_ttl</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>When using <code class="literal">dns_failover</code> or <code class="literal">dns_round_robin</code> as the
                                              load balancing type, this setting controls the amount of time
                                              to cache DNS lookups. Defaults to <code class="literal">1h</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_group_attribute</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the attribute to examine on the user for group
                                              membership. The default is <code class="literal">memberOf</code>. This setting will
                                              be ignored if any <code class="literal">group_search</code> settings are specified.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">group_search.base_dn</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies a container DN to search for groups in which
                                              the user has membership. When this element is absent,
                                              Security searches for the attribute specified by
                                              <code class="literal">user_group_attribute</code> set on the user to determine
                                              group membership.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">group_search.scope</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies whether the group search should be
                                              <code class="literal">sub_tree</code>, <code class="literal">one_level</code> or <code class="literal">base</code>.  <code class="literal">one_level</code> only
                                              searches objects directly contained within the
                                              <code class="literal">base_dn</code>. The default <code class="literal">sub_tree</code> searches all objects
                                              contained under <code class="literal">base_dn</code>. <code class="literal">base</code> specifies that the
                                              <code class="literal">base_dn</code> is a group object, and that it is the only
                                              group considered.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">group_search.filter</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies a filter to use to lookup a group. If not
                                              set, the realm searches for <code class="literal">group</code>,
                                              <code class="literal">groupOfNames</code>, <code class="literal">groupOfUniqueNames</code>, or <code class="literal">posixGroup</code> with the
                                              attributes <code class="literal">member</code>, <code class="literal">memberOf</code>, or <code class="literal">memberUid</code>. Any instance of
                                              <code class="literal">{0}</code> in the filter is replaced by the user
                                              attribute defined in <code class="literal">group_search.user_attribute</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">group_search.user_attribute</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the user attribute that is fetched and
                                              provided as a parameter to the filter.  If not set,
                                              the user DN is passed to the filter.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">unmapped_groups_as_roles</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies whether the names of any unmapped LDAP groups
                                              should be used as role names and assigned to the user.
                                              Defaults to <code class="literal">false</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">timeout.tcp_connect</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the TCP connect timeout period for establishing an
                                              LDAP connection. An <code class="literal">s</code> at the end indicates seconds, or <code class="literal">ms</code>
                                              indicates milliseconds. Defaults to <code class="literal">5s</code> (5 seconds).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">timeout.tcp_read</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the TCP read timeout period after establishing an LDAP connection.
                                              An <code class="literal">s</code> at the end indicates seconds, or <code class="literal">ms</code> indicates milliseconds.
                                              Defaults to <code class="literal">5s</code> (5 seconds).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">timeout.ldap_search</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the LDAP Server enforced timeout period for an LDAP search.
                                              An <code class="literal">s</code> at the end indicates seconds, or <code class="literal">ms</code> indicates milliseconds.
                                              Defaults to <code class="literal">5s</code> (5 seconds).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">files.role_mapping</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the path and file name for the
                                              <a class="link" href="mapping-roles.html#ldap-role-mapping">YAML role mapping configuration file</a>.
                                              Defaults to <code class="literal">ES_HOME/config/x-pack/role_mapping.yml</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">follow_referrals</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies whether X-Pack security should follow referrals
                                              returned by the LDAP server. Referrals are URLs returned by
                                              the server that are to be used to continue the LDAP operation
                                              (e.g. search). Defaults to <code class="literal">true</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.key</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the path to the PEM encoded private key to use if the LDAP
                                              server requires client authentication. <code class="literal">ssl.key</code> and <code class="literal">ssl.keystore.path</code>
                                              may not be used at the same time.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.key_passphrase</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the passphrase to decrypt the PEM encoded private key if it is encrypted.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.certificate</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the path to the PEM encoded certificate (or certificate chain) that goes with the
                                              key if the LDAP server requires client authentication.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.certificate_authorities</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the paths to the PEM encoded certificate authority certificates that
                                              should be trusted. <code class="literal">ssl.certificate_authorities</code> and <code class="literal">ssl.trustsore.path</code> may not be used
                                              at the same time.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.keystore.path</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The path to the Java Keystore file that contains a private key and certificate. <code class="literal">ssl.key</code> and
                                              <code class="literal">ssl.keystore.path</code> may not be used at the same time.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.keystore.password</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The password to the keystore.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.keystore.key_password</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The password for the key in the keystore. Defaults to the keystore password.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.truststore.path</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The path to the Java Keystore file that contains the certificates to trust.
                                              <code class="literal">ssl.certificate_authorities</code> and <code class="literal">ssl.trustsore.path</code> may not be used at the same time.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.truststore.password</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The password to the truststore.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.verification_mode</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the type of verification to be performed when
                                              connecting to a LDAP server using <code class="literal">ldaps</code>. When
                                              set to <code class="literal">full</code>, the hostname or IP address used in the <code class="literal">url</code>
                                              must match one of the names in the certificate or the
                                              connection will not be allowed. Due to their potential security impact,
                                              <code class="literal">ssl</code> settings are not exposed via the
                                              <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/5.3/cluster-nodes-info.html#cluster-nodes-info" target="_top">nodes info API</a>.
                                              Values are <code class="literal">none</code>, <code class="literal">certificate</code>, and <code class="literal">full</code>. Defaults to <code class="literal">full</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.supported_protocols</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the supported protocols for SSL/TLS.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ssl.cipher_suites</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the cipher suites that should be supported when communicating
                                              with the LDAP server.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">cache.ttl</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the time-to-live for cached user entries. A
                                              user’s credentials are cached for this period of time.
                                              Specify the time period using the standard Elasticsearch
                                              <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/5.3/common-options.html#time-units" target="_top">time units</a>.
                                              Defaults to <code class="literal">20m</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">cache.max_users</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the maximum number of user entries that can be
                                              stored in the cache at one time. Defaults to 100,000.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">cache.hash_algo</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the hashing algorithm that is used for the
                                              cached user credentials. See
                                              <a class="link" href="controlling-user-cache.html#cache-hash-algo" title="Table 10. Cache hash algorithms">Cache hash algorithms</a> for the possible
                                              values. (Expert Setting).</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.5.5.11.4.8.3"></a><p class="title"><strong>Table 7. User Search Mode Settings</strong></p><div class="table-contents"><table summary="User Search Mode Settings" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><tbody><tr><td align="left" valign="top"><p>Setting</p></td><td align="left" valign="top"><p>Required</p></td><td align="left" valign="top"><p>Description</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bind_dn</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>The DN of the user that is used to bind to the LDAP
                                                        and perform searches. If not specified, an anonymous
                                                        bind is attempted. Due to its potential security
                                                        impact, <code class="literal">bind_dn</code> is not exposed via the
                                                        <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/5.3/cluster-nodes-info.html#cluster-nodes-info" target="_top">nodes info API</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bind_password</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>The password for the user that is used to bind to the
                                                        LDAP. Due to its potential security impact,
                                                        <code class="literal">bind_password</code> is not exposed via the
                                                        <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/5.3/cluster-nodes-info.html#cluster-nodes-info" target="_top">nodes info API</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_search.base_dn</code></p></td><td align="left" valign="top"><p>yes</p></td><td align="left" valign="top"><p>Specifies a container DN to search for users.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_search.scope</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>The scope of the user search. Valid values are <code class="literal">sub_tree</code>,
                                                        <code class="literal">one_level</code> or <code class="literal">base</code>. <code class="literal">one_level</code> only searches objects
                                                        directly contained within the <code class="literal">base_dn</code>. <code class="literal">sub_tree</code> searches
                                                        all objects contained under <code class="literal">base_dn</code>. <code class="literal">base</code> specifies
                                                        that the <code class="literal">base_dn</code> is the user object, and that it is the
                                                        only user considered. Defaults to <code class="literal">sub_tree</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_search.attribute</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the attribute to match with the username presented
                                                        to. Defaults to <code class="literal">uid</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_search.pool.enabled</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>Enables or disables connection pooling for user search. When
                                                        disabled a new connection is created for every search. The
                                                        default is <code class="literal">true</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_search.pool.size</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>Specifies the maximum number of connections to the LDAP
                                                        server to allow in the connection pool. Defaults to <code class="literal">20</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_search.pool.initial_size</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>The initial number of connections to create to the LDAP
                                                        server on startup. Defaults to <code class="literal">0</code>. Values greater than <code class="literal">0</code>
                                                        could cause startup failures if the LDAP server is down.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_search.pool.health_check.enabled</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>Enables or disables a health check on LDAP connections in
                                                        the connection pool. Connections are checked in the
                                                        background at the specified interval. Defaults to <code class="literal">true</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_search.pool.health_check.dn</code></p></td><td align="left" valign="top"><p>no/yes</p></td><td align="left" valign="top"><p>Specifies the distinguished name to retrieve as part of
                                                        the health check. Defaults to the value of <code class="literal">bind_dn</code>.
                                                        This setting is required when <code class="literal">bind_dn</code> is not configured.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_search.pool.health_check.interval</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>How often to perform background checks of connections in
                                                        the pool. Defaults to <code class="literal">60s</code>.</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.5.5.11.4.8.4"></a><p class="title"><strong>Table 8. User Templates Mode Settings</strong></p><div class="table-contents"><table summary="User Templates Mode Settings" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><tbody><tr><td align="left" valign="top"><p>Setting</p></td><td align="center" valign="top"><p>Required</p></td><td align="left" valign="top"><p>Description</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">user_dn_templates</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>Specifies the DN template that replaces the
                                      user name with the string <code class="literal">{0}</code>. This element
                                      is multivalued, allowing for multiple user
                                      contexts.</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If any settings starting with <code class="literal">user_search</code> are specified, the
        <code class="literal">user_dn_templates</code> the settings are ignored.</p></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-roles-ldap"></a>Mapping LDAP Groups to Roles</h3></div></div></div><p>An integral part of a realm authentication process is to resolve the roles
associated with the authenticated user. Roles define the privileges a user has
in the cluster.</p><p>Since with the <code class="literal">ldap</code> realm the users are managed externally in the LDAP server,
the expectation is that their roles are managed there as well. If fact, LDAP
supports the notion of groups, which often represent user roles for different
systems in the organization.</p><p>The <code class="literal">ldap</code> realm enables you to map LDAP groups to roles in the role mapping
file stored on each node. When a user authenticates with LDAP, the privileges
for that user are the union of all privileges defined by the roles assigned to
the set of groups that the user belongs to.</p><p>You specify groups using their distinguished names. For example, the following
mapping configuration maps the LDAP <code class="literal">admins</code> group to both the <code class="literal">monitoring</code> and
<code class="literal">user</code> roles, and maps the <code class="literal">users</code> group to the <code class="literal">user</code> role.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">monitoring: <a id="CO5-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
  - "cn=admins,dc=example,dc=com" <a id="CO5-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
user:
  - "cn=users,dc=example,dc=com" <a id="CO5-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
  - "cn=admins,dc=example,dc=com"</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO5-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The name of the mapped role.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO5-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The LDAP distinguished name (DN) of the <code class="literal">admins</code> group.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO5-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The LDAP distinguished name (DN) of the <code class="literal">users</code> group.
</p></td></tr></table></div><p>For more information, see <a class="link" href="mapping-roles.html" title="Mapping Users and Groups to Roles">Mapping Users and Groups to Roles</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ldap-ssl"></a>Setting up SSL Between Elasticsearch and LDAP</h3></div></div></div><p>To protect the user credentials that are sent for authentication, it’s highly
recommended to encrypt communications between Elasticsearch and your LDAP server.
Connecting via SSL/TLS ensures that the identity of the LDAP server is
authenticated before X-Pack security transmits the user credentials and the contents
of the connection are encrypted.</p><p>To encrypt communications between Elasticsearch and your LDAP server:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
Configure the realm’s SSL settings on each node to trust certificates signed by the CA that signed your
LDAP server certificates. The following example demonstrates how to trust a CA certificate,
<code class="literal">cacert.pem</code>, located within the X-Pack configuration directory:
</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-shell">xpack:
  security:
    authc:
      realms:
        ldap1:
          type: ldap
          order: 0
          url: "ldaps://ldap.example.com:636"
          ssl:
            certificate_authorities: [ "CONFIG_DIR/x-pack/cacert.pem" ]</pre></div><p class="simpara">The CA cert must be a PEM encoded certificate.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>You can also specify the individual server certificates rather than the CA
certificate, but this is only recommended if you have a single LDAP server
or the certificates are self-signed.</p></div></div></li><li class="listitem">
Set the <code class="literal">url</code> attribute in the realm configuration to specify the LDAPS
protocol and the secure port number. For example, <code class="literal">url: ldaps://ldap.example.com:636</code>.
</li><li class="listitem">
Restart Elasticsearch.
</li></ol></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>By default, when you configure X-Pack security to connect to an LDAP server
      using SSL/TLS, X-Pack security attempts to verify the hostname or IP address
      specified with the <code class="literal">url</code> attribute in the realm configuration with the
      values in the certificate. If the values in the certificate and realm
      configuration do not match, X-Pack security does not allow a connection to the
      LDAP server. This is done to protect against man-in-the-middle attacks. If
      necessary, you can disable this behavior by setting the
      <code class="literal">ssl.verification_mode</code> property to <code class="literal">none</code>.</p></div></div></div></div><div class="navfooter"><span class="prev"><a href="native-realm.html">
              « 
              Native User Authentication</a>
           
        </span><span class="next">
           
          <a href="active-directory-realm.html">Active Directory User Authentication
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
					<div id="rtpcontainer" style="display: block;">
						<div class="mktg-promo">
						<h3>Getting Started Videos</h3>
						<ul class="icons">
							<li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
							<li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
							<li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
						</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

        </div>
      	


<div id="footer-subscribe" class="home-footer-subscribe">
  <div class="subscribe-wrapper">
    <div class="container">
      <div class="subscribe-form-container">
        <div class="subscribe-title col-md-12 col-lg-6">
            <h5>Be in the know with the latest and greatest from Elastic.</h5>
        </div>
        <div class="subscribe-form col-md-12 col-lg-6">
          <form class="mktoForm sb-form"></form>
        </div>
      </div>
      <div class="form_thanks hide">
        
          <p>Thanks for subscribing! We'll keep you updated with new releases.</p>
        
      </div>
    </div>
  </div>
</div>
<!--subscribe newsletter end-->

<!-- Footer Section -->
<footer class="footer-wrapper">
  <div class="container">
    <div class="row footer-content">
        
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/products">Products ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/products/elasticsearch">Elasticsearch</a></li>
                  
                
              
                
                  
                    <li><a href="/products/kibana">Kibana</a></li>
                  
                
              
                
                  
                    <li><a href="/products/beats">Beats</a></li>
                  
                
              
                
                  
                    <li><a href="/products/logstash">Logstash</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack">Stack Features (formerly X-Pack)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/security">Security</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/alerting">Alerting</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/canvas">Canvas</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/monitoring">Monitoring</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/graph">Graph</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/reporting">Reporting</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/machine-learning">Machine Learning</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/elasticsearch-sql">Elasticsearch SQL</a></li>
                  
                
              
                
                  
                    <li><a href="/products/hadoop">Elasticsearch-Hadoop</a></li>
                  
                
              
                
                  
                    <li><a href="/products/ece">Elastic Cloud Enterprise</a></li>
                  
                
              
              </ul>
              
                <h3><a href=""></a></h3>
              
              
              
              <ul class="">
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/solutions">Solutions ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/solutions/logging">Logging</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/metrics">Metrics</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/site-search">Site Search</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/security-analytics">Security Analytics</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/apm">APM</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/app-search">App Search</a></li>
                  
                
              
              </ul>
              
                <h3><a href="/cloud">Elastic Cloud ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/cloud/elasticsearch-service">Elasticsearch Service</a></li>
                  
                
              
                
                  
                    <li><a href="/aws-elasticsearch-service">AWS Elasticsearch Service Comparison</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud/app-search-service">Elastic App Search Service</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud/site-search-service">Elastic Site Search Service</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3>Resources</h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/blog">Blog</a></li>
                  
                
              
                
                  
                    <li><a href="https://cloud-status.elastic.co">Cloud Status</a></li>
                  
                
              
                
                  
                    <li><a href="/community">Community</a></li>
                  
                
              
                
                  
                    <li><a href="/use-cases">Customers & Use Cases</a></li>
                  
                
              
                
                  
                    <li><a href="/guide">Documentation</a></li>
                  
                
              
                
                  
                    <li><a href="/elasticon">Elastic{ON} Events</a></li>
                  
                
              
                
                  
                    <li><a href="https://discuss.elastic.co/">Forums</a></li>
                  
                
              
                
                  
                    <li><a href="/community/meetups">Meetups</a></li>
                  
                
              
                
                  
                    <li><a href="/subscriptions">Subscriptions</a></li>
                  
                
              
                
                  
                    <li><a href="https://support.elastic.co">Support Portal</a></li>
                  
                
              
                
                  
                    <li><a href="/videos">Videos & Webinars</a></li>
                  
                
              
                
                  
                    <li><a href="/training">Training</a></li>
                  
                
              
              </ul>
              
                <h3></h3>
              
              
              
              <ul class="">
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/about">About ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/about/careers">Careers/Jobs</a></li>
                  
                
              
                
                  
                    <li><a href="/about/our-source-code">Our Source Code</a></li>
                  
                
              
                
                  
                    <li><a href="/about/teams">Teams</a></li>
                  
                
              
                
                  
                    <li><a href="/about/teams/board">Board of Directors</a></li>
                  
                
              
                
                  
                    <li><a href="/about/teams/leadership">Leadership</a></li>
                  
                
              
                
                  
                    <li><a href="/contact">Contact</a></li>
                  
                
              
                
                  
                    <li><a href="/about/history-of-elasticsearch">Our Story</a></li>
                  
                
              
                
                  
                    <li><a href="/about/why-open-source">Why Open Source</a></li>
                  
                
              
                
                  
                    <li><a href="/about/distributed">Distributed by Intention</a></li>
                  
                
              
                
                  
                    <li><a href="/about/partners">Partners</a></li>
                  
                
              
                
                  
                    <li><a href="/about/press">Media</a></li>
                  
                
              
                
                  
                    <li><a href="https://ir.elastic.co">Investor Relations</a></li>
                  
                
              
                
                  
                    <li><a href="https://www.elastic.shop">Elastic Store</a></li>
                  
                
              
              </ul>
              
                <h3><a href=""></a></h3>
              
              
              
              <ul class="">
              
              </ul>
          </div>    
       
    </div>
     <!-- Social Media Section -->
    <div class="row social-icon">
      <div class="col-xs-12 col-sm-12 col-md-6 col-md-offset-3">
	    <div class="row">
		     <div class="follow-us col-xs-12 col-sm-12 col-md-12">
			    <div class="social-label">FOLLOW US</div>
			    <ul class="social-icon-list">
          
          		 	<li class="Facebook"><a id="footer_facebook" href="https://www.facebook.com/elastic.co">Facebook</a></li>
          
          		 	<li class="Twitter"><a id="footer_twitter" href="https://www.twitter.com/elastic">Twitter</a></li>
          
          		 	<li class="LinkedIn"><a id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co">LinkedIn</a></li>
          
          		 	<li class="Xing"><a id="footer_xing" href="https://www.xing.com/companies/elastic.co">Xing</a></li>
          
          		 	<li class="YouTube"><a id="footer_youtube" href="https://www.youtube.com/user/elasticsearch">YouTube</a></li>
          
		  		</ul>
		     </div>
	    </div>
      </div>
    </div>
    <!-- Social Media Section end-->
    <div class="row">
	<div class="col-xs-12 col-sm-12 col-md-11">
		<div class="copyright">
			<ul>
				<li><a href="/legal/trademarks">Trademarks</a></li>
				<li><a href="/legal/terms-of-use">Terms of Use</a></li>
				<li><a href="/legal/privacy-statement">Privacy</a></li>
				<li><a href="/brand">Brand</a></li>
			</ul>
			<div class="copyright-content">
				<div class="footer-text">
					<p>© 2018. Elasticsearch B.V. All Rights Reserved
					</p>
					<p>Elasticsearch is a trademark of Elasticsearch B.V., registered in the U.S. and in other countries.
					</p>
					<p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a> in the United States and/or other countries.
					</p>
				</div>
			</div>
		</div>
	</div>
	<div class="col-xs-2 col-xs-offset-5 col-sm-1 col-sm-offset-5 col-md-1 col-md-offset-0">
		<div class="footer-logo"><a href="/"><img src="/static/images/svg/logo-elastic-footer-stacked-999.svg" class="img-responsive"></a>
		</div>
	</div>
</div>
  </div>
</footer>
<!-- Footer Section end-->

<style type="text/css">
	
        
            .Facebook a {background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
            .Facebook a:before {
                content: url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Facebook a:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
        
	
        
            .Twitter a {background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
            .Twitter a:before {
                content: url("/assets/blt90b0372cc07a54d3/twitter-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Twitter a:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
        
	
        
            .LinkedIn a {background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
            .LinkedIn a:before {
                content: url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .LinkedIn a:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
        
	
        
            .Xing a {background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
            .Xing a:before {
                content: url("/assets/bltededebe5f7521a39/xing-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Xing a:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
        
	
        
            .YouTube a {background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
            .YouTube a:before {
                content: url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .YouTube a:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
        
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
$(document).ready(function(){

    var ipSuccess = function(data) {
        country = data.country_code;
        if (data.in_eu){
                        
            marketo_id = "6196";
            
        }else{ 
            marketo_id = "1398";

        }

        $('.subscribe-form form.sb-form').attr('id', 'mktoForm_' + marketo_id);
        if(window.MktoForms2){
            MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", marketo_id,function(form){
                form.onSuccess(function(form){
                    $('#mktoForm_'+marketo_id).css('display','none');
                    $('.subscribe-wrapper .subscribe-form-container').hide();
                    $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
                    dataLayer.push({'event': 'mktoFormSubmit'});
                    return false;
                });
            });  
        }
    }

    var marketo_id;

    $.ajax({
        url: "/gdpr-data"
    }).success(function(data) {
        ipSuccess(data);
    });

})
</script>

      </section>
    </div>

    
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script>
 
     
<script type="text/javascript">
$(document).ready(function(){
	if (window.location.hash.length) {
	      var target = $(window.location.hash);
	      target = target.length ? target : $(window.location.hash);
	      if (target.length) {
	        setTimeout(function(){ $(window).scrollTop(target.offset().top - 60); }, 1200);        
	      }
	}
	$('#guide').on('click','a[href*=#]:not([href=#])',function(e) {
			var flag=true;
		      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
		          var target = $(this.hash);
		          target = target.length ? target :$(this.hash);
		          if (target.length) {
		            if(flag){
		              flag=false;
		              var heightScroll=($('.tertiary-nav.navbar-fixed-top').height())?60:110;
		              $('html,body').animate({
		                  scrollTop: target.offset().top - heightScroll
		                }, 2000, function(){
		                  flag=true;
		                });
		            }                    
		          }
		      }
		    
	});

})

</script>

     <style></style>
     
  
            <script type="text/javascript" src="docs.js"></script>
<script type='text/javascript' src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=yaml'></script>

            </body>
        
</html>
