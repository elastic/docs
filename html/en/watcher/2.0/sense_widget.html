<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title>Sense console not found</title>
    <style type="text/css">
        body { padding: 1em; font-family: sans-serif; max-width: 800px; line-height: 1.3; }
        h1 { color: #31beb1;}
        #sense_url { width: 30em}
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script type="text/javascript">
    <!--
    jQuery(init);

    var snippet_url;
    function init() {
        foo = window.location;
        jQuery('#change_url').click(change_url);
        jQuery('#reset_url,#retry').click(reset_url);
        if (jQuery.cookie('sense_url')) {
            jQuery('#sense_url').val(jQuery.cookie('sense_url'));
        }
        snippet_url = window.location.search.substr(1);
        if (/^https?:\/\//.test(snippet_url) === false) {
            var href = window.location.href;
            snippet_url = href.replace(/\/[^/?]+(?:\?.*)?$/, '/' + snippet_url);
        }
        load_sense();
    }

    function load_sense() {
        var body = jQuery('body');
        body.hide();
        var sense_url = jQuery('#sense_url').val();
        var sense_snippet = sense_url + '?load_from=' + snippet_url;

        jQuery('#direct').attr('href',sense_snippet);
        jQuery.get(sense_url + '?' + new Date().getTime()).done(function() {
            window.location = sense_snippet;
        }).fail(function(e){
            body.show();
        });
    }

    function change_url() {
        sense_url = jQuery('#sense_url').val();
        jQuery.cookie('sense_url',sense_url, {path: "/", expires: 365 });
        load_sense();
    }

    function reset_url(e) {
        jQuery('#sense_url_form')[0].reset();
        if (e) { e.preventDefault()}
        change_url();
    }
    // -->
    </script>
</head>
<body>
    <h1>Sense console not found</h1>
    <p>You need to have the Sense console installed or accessible by your browser. The easiest way to
       do this is by installing the <b>latest</b>
       <a href="http://www.elastic.co/products/marvel/">Marvel management and monitoring</a> plugin
       on your local Elasticsearch node.
    </p>
    <h2>Install Sense</h2>
    You will need the latest version of Elasticsearch and the latest version of Marvel installed:
    <ol>
        <li>
        <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.7/setup.html" target="other">Download and install Elasticsearch</a>.
        </li>
        <li>
        <a href="https://www.elastic.co/guide/en/marvel/1.3/installation.html" target="other">Install Marvel</a>.
        </li>
        <li>
        Enable cross-domain requests by adding the following to the <code>config/elasticsearch.yml</code> config file:
        <pre>
http.cors.enabled:      true
http.cors.allow-origin: /https?:\/\/(www.)?elastic.co/</pre>
        </li>
        <li>Restart your Elasticsearch node.</li>
        <li><a href="#" id="retry">Click here to retry</a></li>
    </ol>
    <h2>Change the Sense URL</h2>
    <div>
        <p>If you already have Sense available via a different URL, you can supply the correct URL below:</p>
        <form id="sense_url_form" action="">
            <label for="sense_url">
                Sense URL:
            </label>
            <input type="text" id="sense_url" value="http://localhost:9200/_plugin/marvel/sense/index.html">
            <button id="change_url" type="button">Change</button>
            <button id="reset_url" type="button">Use default URL</button>
        </form>
    </div>
    <h2>Cross-domain error</h2>
    <p>
        If you are running a development version of Sense via a web-server which doesn't support cross-domain request,
        you can open Sense manually by clicking this link:
            <a id="direct" href="">Open Sense manually</a>
    </p>
</body>
</html>
