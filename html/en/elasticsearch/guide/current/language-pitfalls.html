
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Pitfalls of Mixing Languages</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide" /><link rel="up" href="language-intro.html" title="Getting Started with Languages" /><link rel="prev" href="configuring-language-analyzers.html" title="Configuring Language Analyzers" /><link rel="next" href="one-lang-docs.html" title="One Language per Document" />
  
 
 	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
 	
	<meta name="description" content="" />
	<meta name="keywords" content="" />



	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
	<link type="text/css" rel="stylesheet" href="/static/css/load.css" />
	<link type="text/css" rel="stylesheet" href="/static/css/skel.css" />		
	
	<script src="/static/js/jquery.min.js"></script>
	<script src="/static/js/loading.js"></script>
	<script src="/static/js/skel.min.js"></script>
	<script src="/static/js/skel-layers.min.js"></script>
	<script src="/static/js/classie.js"></script>	
	<script type="text/javascript">form_name = "common_layout"</script>
	<script src="/static/js/init.js"></script>
	
	<link type="text/css" rel="stylesheet" href="/static/css/prettify.css" />	
	<script type="text/javascript" src="/static/js/prettify.js"></script>



<link rel="stylesheet" type="text/css" href="/static/css/style.css" />
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript">
  jQuery(function() {
    jQuery('#guide a[id]').each(function() { this.href='#'+this.id });
    jQuery('pre.prettyprint').each(function() {
      var pre = jQuery(this);
      pre.css('position','absolute');
      pre.css('width','auto');
      var height = pre.innerHeight();
      pre.wrap('<div class="pre_wrapper" style="height:' + height + 'px"></div>');
    })
  });
</script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

</head>
<body >

	<div class="preloader">
    	<div class="status"></div>
	</div>
	<!-- Google Tag Manager -->
	<script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
													  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script>
	<!-- End Google Tag Manager -->
	
	<div class="header-cont">
		<div id="header-wrapper">
			

<div class="container">
	<div class="row">
		<div class="12u">
			<section>
				<div class="row">
					<div class="8u 6u(small) 5u(xsmall)">
						<div id="elastic">
							<h1><a href="/"></a></h1>
						</div>
						<!-- Searchbar Input box -->
						<form method="get" action="/search" name="searchForm" class="header-search-form">
						   <input type="text" id="search-header" name="q" class="form-control global-input" placeholder="elastic{search}">
						</form>
					</div>
					<div class="4u 6u(small) 7u(xsmall)">
						<!-- Mobile Menu -->
						<div class="mobile-menu-wrapper">
							<ul class="m-shortcuts">
								<li><a id="header-search" class="m-search" href="#"></a></li>
								<li><a class="m-guide" href="/guide"></a></li>
							</ul>											
							<nav class="nav-menu">
								<div class="menu-button">
									<span></span>
								</div>
								<div class="nav-menu-list-wrap">
									<div class="nav-menu-list">
										<h3><a href="/products">Products</a></h3>
										<ul>
											<li><a href="/products/elasticsearch">Elasticsearch</a></li>
											<li><a href="/products/logstash">Logstash</a></li>
											<li><a href="/products/kibana">Kibana</a></li>
											<li><a href="/products/shield">Shield</a></li>
											<li><a href="/products/marvel">Marvel</a></li>
											<li><a href="/products/hadoop">Hadoop</a></li>
											<li><a href="/subscriptions">Support</a></li>
											<li><a href="/downloads">Downloads</a></li>
										</ul>
										<h3><a href="/subscriptions">Subscriptions</a></h3>
										<h3><a href="/learn">Learn</a></h3>
										<ul>
											<li><a href="/guide">Docs</a></li>
											<li><a href="/videos">Videos</a></li>
											<li><a href="http://purchases.elasticsearch.com" target="_blank">Training</a></li>
											<li><a href="/blog">Blog</a></li>
										</ul>
										<h3><a href="/community">Community</a></h3>
										<ul>
											<li><a href="/community/meetups">Meetups</a></li>
										</ul>
										<h3><a href="/use-cases">Use Cases</a></h3>
										<h3><a href="/about">About</a></h3>
										<ul>
											<li><a href="/about/leadership">Leadership</a></li>
											<li><a href="/about/board">Board of Directors</a></li>
											<li><a href="/about/careers">Careers</a></li>
											<li><a href="/about/partners">Partners</a></li>
											<li><a href="/about/press">Press</a></li>
										</ul>
									</div>
								</div>
							</nav>
						</div>
						<!-- Shortcuts -->
						<nav id="shortcuts">
							<ul class="links">
								
									<li class="sc-downloads grayscale"><a href="/downloads" id="header_downloads">downloads</a></li>
								
									<li class="sc-docs grayscale"><a href="/guide" id="header_guide">docs</a></li>
								
									<li class="sc-support grayscale"><a href="/subscriptions" id="header_subscriptions">support</a></li>
								
									<li class="sc-contact grayscale"><a href="/contact" id="header_contact">contact</a></li>
								
							</ul>
						</nav>
					</div>
				</div>
			</section>
			

<section class="desktop-main-nav">
	<div class="row">
		<div class="9u">
			<!-- Nav -->
			<nav id="nav">
				<ul>
					
					<li>
						<a href="/products" id="nav_products" >PRODUCTS</a>
						
						<ul class="dropdown">
							
								<li><a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a></li>								
							
								<li><a href="/products/logstash" id="nav_logstash" >logstash</a></li>								
							
								<li><a href="/products/kibana" id="nav_kibana" >kibana</a></li>								
							
								<li><a href="/products/shield" id="nav_shield" >shield</a></li>								
							
								<li><a href="/products/marvel" id="nav_marvel" >marvel</a></li>								
							
								<li><a href="/products/hadoop" id="nav_hadoop" >hadoop</a></li>								
							
								<li><a href="/subscriptions" id="nav_support" >support</a></li>								
							
								<li><a href="/downloads" id="nav_downloads" >downloads</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/subscriptions" id="nav_subscriptions" >SUBSCRIPTIONS</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/learn" id="nav_learn" >LEARN</a>
						
						<ul class="dropdown">
							
								<li><a href="/guide" id="nav_guide" >docs</a></li>								
							
								<li><a href="/videos" id="nav_videos" >videos</a></li>								
							
								<li><a href="http://purchases.elasticsearch.com" id="nav_training" >training</a></li>								
							
								<li><a href="/blog" id="nav_learn_blog" >blog</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/community" id="nav_community" >COMMUNITY</a>
						
						<ul class="dropdown">
							
								<li><a href="/community/meetups" id="nav_meetups" >meetups</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/use-cases" id="nav_usecases" >USE CASES</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/blog" id="nav_blog" >BLOG</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/about" id="nav_about" >ABOUT</a>
						
						<ul class="dropdown">
							
								<li><a href="/about/leadership" id="nav_leadership" >leadership</a></li>								
							
								<li><a href="/about/board" id="nav_board" >board of directors</a></li>								
							
								<li><a href="/about/careers" id="nav_careers" >careers</a></li>								
							
								<li><a href="/about/partners" id="nav_partners" >partners</a></li>								
							
								<li><a href="/about/press" id="nav_press" >press</a></li>								
								
						</ul>							
					</li>
					
				</ul>
			</nav>
		</div>
		<!-- Search -->
		<div class="3u">
			<div id="searchbar">
				<form method="get" action="/search" name="searchForm">
					<input type="text" value="" name="q" placeholder="elastic{search}">
					<button class="button icon" onclick="searchForm.submit()">GO</button>
				</form>
			</div>
		</div>
	</div>
</section>

		</div>
	</div>
</div>

<style>	
	
		.sc-downloads{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-docs{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-support{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-contact{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
		
</style>
		</div>
	</div>
  	<div id="content">
  		
  			
            <div id="pageheader">
    <div class="container">
        <header>
            <h1>Learn |</h1>
            <h2>Docs</h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide</a></span> » <span class="breadcrumb-link"><a href="languages.html">Dealing with Human Language </a></span> » <span class="breadcrumb-link"><a href="language-intro.html">Getting Started with Languages</a></span> » <span class="breadcrumb-node">Pitfalls of Mixing Languages</span></div><div class="navheader"><span class="prev"><a href="configuring-language-analyzers.html">
              « 
              Configuring Language Analyzers</a>
           
        </span><span class="next">
           
          <a href="one-lang-docs.html">One Language per Document
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="language-pitfalls"></a>Pitfalls of Mixing Languages<a href="https://github.com/elasticsearch/elasticsearch-definitive-guide/edit/master/200_Language_intro/30_Language_pitfalls.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="using-language-analyzers.html">Using Language Analyzers</a></span></dt><dt><span class="section"><a href="configuring-language-analyzers.html">Configuring Language Analyzers</a></span></dt><dt><span class="section"><a href="language-pitfalls.html">Pitfalls of Mixing Languages</a></span></dt><dt><span class="section"><a href="one-lang-docs.html">One Language per Document</a></span></dt><dt><span class="section"><a href="one-lang-fields.html">One Language per Field</a></span></dt><dt><span class="section"><a href="mixed-lang-fields.html">Mixed-Language Fields</a></span></dt></dl></div><p>If you have to deal with only a single language,<a id="id-1.6.3.10.2.1" class="indexterm"></a>
<a id="id-1.6.3.10.2.2" class="indexterm"></a> count yourself lucky.
Finding the right strategy for handling documents written in several languages
can be challenging.<a id="id-1.6.3.10.2.3" class="indexterm"></a>
<a id="id-1.6.3.10.2.4" class="indexterm"></a></p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_at_index_time"></a>At Index Time<a href="https://github.com/elasticsearch/elasticsearch-definitive-guide/edit/master/200_Language_intro/30_Language_pitfalls.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Multilingual documents come in three main varieties:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
One predominant language per <span class="emphasis"><em>document</em></span>, which may contain snippets from
   other languages (See <a class="xref" href="one-lang-docs.html" title="One Language per Document">One Language per Document</a>.)
</li><li class="listitem">
One predominant language per <span class="emphasis"><em>field</em></span>, which may contain snippets from
   other languages (See <a class="xref" href="one-lang-fields.html" title="One Language per Field">One Language per Field</a>.)
</li><li class="listitem">
A mixture of languages per field (See <a class="xref" href="mixed-lang-fields.html" title="Mixed-Language Fields">Mixed-Language Fields</a>.)
</li></ul></div><p>The goal, although not always achievable, should be to keep languages
separate.  Mixing languages in the same inverted index can be problematic.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_incorrect_stemming"></a>Incorrect stemming<a href="https://github.com/elasticsearch/elasticsearch-definitive-guide/edit/master/200_Language_intro/30_Language_pitfalls.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>The stemming rules for German are different from those for English, French,
Swedish, and so on.<a id="id-1.6.3.10.3.5.2.1" class="indexterm"></a>
<a id="id-1.6.3.10.3.5.2.2" class="indexterm"></a> Applying the same stemming rules to different languages
will result in some words being stemmed correctly, some  incorrectly, and some
not being stemmed at all. It may even result in words from different languages with different meanings
being stemmed to the same root word, conflating their meanings and producing
confusing search results for the user.</p><p>Applying multiple stemmers in turn to the same text is likely to result in
rubbish, as the next stemmer may try to stem an already stemmed word,
compounding the problem.</p><div class="sidebar"><a id="different-scripts"></a><div class="titlepage"><div><div><p class="title"><strong>Stemmer per Script</strong></p></div></div></div><p>The one exception to the <span class="emphasis"><em>only-one-stemmer</em></span> rule occurs when each language
is written in a different script.  For instance, in Israel it is quite
possible that a single document may contain Hebrew, Arabic, Russian (Cyrillic),
and English:</p><pre class="literallayout">אזהרה - Предупреждение - تحذير - Warning</pre><p>Each language uses a different script, so the stemmer for one language will not
interfere with another, allowing multiple stemmers to be applied to the same
text.</p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_incorrect_inverse_document_frequencies"></a>Incorrect inverse document frequencies<a href="https://github.com/elasticsearch/elasticsearch-definitive-guide/edit/master/200_Language_intro/30_Language_pitfalls.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>In <a class="xref" href="relevance-intro.html" title="What Is Relevance?">What Is Relevance?</a>, we explained that the more frequently a term appears
in a collection of documents, the less weight that term has.<a id="id-1.6.3.10.3.6.2.2" class="indexterm"></a>
<a id="id-1.6.3.10.3.6.2.3" class="indexterm"></a>  For accurate
relevance calculations, you need accurate term-frequency statistics.</p><p>A short snippet of German appearing in predominantly English text would give
more weight to the German words, given that they are relatively uncommon. But
mix those with documents that are predominantly German, and the short German
snippets now have much less weight.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_at_query_time"></a>At Query Time<a href="https://github.com/elasticsearch/elasticsearch-definitive-guide/edit/master/200_Language_intro/30_Language_pitfalls.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>It is not sufficient just to think about your documents, though.<a id="id-1.6.3.10.4.2.1" class="indexterm"></a>
<a id="id-1.6.3.10.4.2.2" class="indexterm"></a>  You also need
to think about how your users will query those documents.  Often you will be able
to identify the main language of the user either from the language of that user’s chosen
interface (for example, <code class="literal">mysite.de</code> versus <code class="literal">mysite.fr</code>) or from the
<a class="ulink" href="http://bit.ly/1BwEl61" target="_top"><code class="literal">accept-language</code></a>
HTTP header from the user’s browser.</p><p>User searches also come in three main varieties:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Users search for words in their main language.
</li><li class="listitem">
Users search for words in a different language, but expect results in
  their main language.
</li><li class="listitem">
Users search for words in a different language, and expect results in
  that language (for example, a bilingual person, or a foreign visitor in a web cafe).
</li></ul></div><p>Depending on the type of data that you are searching, it may be appropriate to
return results in a single language (for example, a user searching for products on
the Spanish version of the website) or to combine results in the identified
main language of the user with results from other languages.</p><p>Usually, it makes sense to give preference to the user’s language.  An English-speaking
user searching the Web for “deja vu” would probably prefer to see
the English Wikipedia page rather than the French Wikipedia page.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="identifying-language"></a>Identifying Language<a href="https://github.com/elasticsearch/elasticsearch-definitive-guide/edit/master/200_Language_intro/30_Language_pitfalls.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You may already know the language of your documents.  Perhaps your documents
are created within your organization and translated into a list of predefined
languages.  Human pre-identification is probably the most reliable method of
classifying language correctly.</p><p>Perhaps, though, your documents come from an external source without any
language classification, or possibly with incorrect classification. In these
cases, you need to use a heuristic to identify the predominant language.
Fortunately, libraries are available in several languages to help with this problem.</p><p>Of particular note is the
<a class="ulink" href="http://bit.ly/1AUr3i2" target="_top">chromium-compact-language-detector</a>
library from
<a class="ulink" href="http://bit.ly/1AUr85k" target="_top">Mike McCandless</a>,
which uses the open source (<a class="ulink" href="http://bit.ly/1u9KKgI" target="_top">Apache License 2.0</a>)
<a class="ulink" href="https://code.google.com/p/cld2/" target="_top">Compact Language Detector</a> (CLD) from Google.  It is
small, fast, <a id="id-1.6.3.10.5.4.5" class="indexterm"></a>and accurate, and can detect 160+ languages from as little as two
sentences. It can even detect multiple languages within a single block of
text. Bindings exist for several languages including Python, Perl, JavaScript,
PHP, C#/.NET, and R.</p><p>Identifying the language of the user’s search request is not quite as simple.
The CLD is designed for text that is at least 200 characters in length.
Shorter amounts of text, such as search keywords, produce much less accurate
results. In these cases, it may be preferable to take simple heuristics into
account such as the country of origin, the user’s selected language, and the
HTTP <code class="literal">accept-language</code> headers.</p></div></div><div class="navfooter"><span class="prev"><a href="configuring-language-analyzers.html">
              « 
              Configuring Language Analyzers</a>
           
        </span><span class="next">
           
          <a href="one-lang-docs.html">One Language per Document
               »
            </a></span></div>
<!-- end body -->

            </section>
<script type="text/javascript" >
  (function ($, $a, $title, $list) {
    $a = $('[id^="js-api-method-index"]');
    if (!$a.size()) return;
    $('#guide').addClass('js-client-docs');
    $list = $a.siblings('.itemizedlist').detach();
    $title = $(document.createElement('h2')).text('api methods')
    $a.parent().remove();
    $('.toc').first().append($(document.createElement('div')).addClass('js-api-method-index').append($title).append($list));
  }(jQuery));
</script>

            <!-- Footer -->
        
	<div id="footer-wrapper">
		<section id="footer" class="container">
			<div class="row">
				<div class="12u">
					<!-- Copyright -->
					<div id="copyright">
	<p>
		© 2015. All Rights Reserved - Elasticsearch
	</p>
	<ul class="links">
		<li>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</li>
		<li><a href="/legal/trademarks" id="footer_trademarks">Trademarks</a></li>
		<li><a href="/legal/terms-of-use" id="footer_terms">Terms</a></li>
		<li><a href="/legal/privacy-policy" id="footer_privacy">Privacy</a></li>
	</ul>
	<p>
		Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other&nbsp;countries.
	</p>
</div>
<!--<div class="row">
{replace4}
</div>-->
				</div>
			</div>					
		</section>
	</div>
			
	<!-- Social Media -->
	<div id="socialmedia-wrapper">
		<section id="socialmedia" class="container">
			<!-- social icons -->
			<div id="social">
				<ul class="links">
					
						<li class="facebook grayscale"><a href="http://www.facebook.com/elastic.co" target="_blank" id="footer_facebook"></a></li>
					
						<li class="twitter grayscale"><a href="https://www.twitter.com/elastic" target="_blank" id="footer_twitter"></a></li>
					
						<li class="linkedin grayscale"><a href="http://www.linkedin.com/company/elasticsearch" target="_blank" id="footer_linkedin"></a></li>
					
						<li class="xing grayscale"><a href="https://www.xing.com/companies/elasticsearch" target="_blank" id="footer_xing"></a></li>
					
				</ul>
			</div>
		</section>
	</div>


<style type="text/css">
	
		.facebook{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.twitter{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.linkedin{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.xing{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
</style>	

  	</div>
  	<div class="preloader">
    	<div class="status"></div>
	</div>
  	<style></style>
   	<link type="text/css" rel="stylesheet" href="/static/css/flexslider.css" >

<script src="/static/js/jquery.flexslider.min.js"></script>
<script src="/static/js/jquery.dropdown.min.js"></script>
<script src="/static/js/script.js"></script>
   	
</body>