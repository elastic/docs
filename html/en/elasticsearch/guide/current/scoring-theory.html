
<!DOCTYPE HTML>
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Theory Behind Relevance Scoring
        | Elasticsearch: The Definitive Guide [2.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [2.x]" /><link rel="up" href="controlling-relevance.html" title="Controlling Relevance" /><link rel="prev" href="controlling-relevance.html" title="Controlling Relevance" /><link rel="next" href="practical-scoring-function.html" title="Lucene’s Practical Scoring Function" /><meta name="DC.type" content="Docs/Elasticsearch/Definitive Guide/2.x" />
  
 	<meta http-equiv="content-type" content="text/html; charset=utf-8" />

 	<!-- RTP tag -->
	<script type='text/javascript' async>
	(function(c,h,a,f,i,e){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
	 c[a].a=i;c[a].e=e;var g=h.createElement("script");g.async=true;g.type="text/javascript";
	 g.src=f+'?aid='+i;var b=h.getElementsByTagName("script")[0];b.parentNode.insertBefore(g,b);
	 })(window,document,"rtp","//sjrtp2-cdn.marketo.com/rtp-api/v1/rtp.js","elasticco");

	rtp('send','view');
	rtp('get', 'campaign',true);
	</script>
	<!-- End of RTP tag -->

	
 	<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
<meta name="apple-mobile-web-app-title" content="Elastic">
<meta name="application-name" content="Elastic">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">

<!-- DC tags section -->
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
<link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >


<!-- end DC tags -->

	<meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." />

	<link rel="canonical" href="" />

	<meta property="og:image" content="https://www.elastic.co/static/img/elastic-logo-200.png" />
	

		


	
	<link type="text/css" rel="stylesheet" href="https://static-www.elastic.co/static/css/skel.css?q=400" />
	<link type="text/css" rel="stylesheet" href="https://static-www.elastic.co/static/css/style.css?q=400" />
	<script src="https://static-www.elastic.co/static/js/skel.min.js?q=400"></script>
	
		<script type="text/javascript">form_name = "" ;cdn_url="https://static-www.elastic.co"; cdn_slug = "400"</script>
	
	<script src="https://static-www.elastic.co/static/js/init.js?q=400"></script>
	<script src="https://static-www.elastic.co/static/js/jquery.min.js?q=400"></script>
	<script src="https://static-www.elastic.co/static/js/jquery.cookie.js?q=400"></script>
	<script type="text/javascript">
	// set language based on browser language
	function languageMatch(locale,localpath){// match browser language with locales language and return value
		for(var index in locale){
			if(index===localpath){
				return 1;
			}
		}
		return -1
	}

	if(!$.cookie("pathCookie")){
		$.cookie("pathCookie", "languageSet",{ path: '/'});
		var locale={
				    '/de': '/de',
				    '/fr': '/fr',
				    '/ja':'/jp',
				    '/ko':'/kr'
				};
		var lang='/'+(navigator.language || navigator.userLanguage).slice(0,2);
		var localpath,subPath;
		if(languageMatch(locale,(window.location.pathname).slice(0,3)) > -1){
			localpath=(window.location.pathname).slice(0,3);
			subPath=(window.location.pathname).replace(localpath,'');
		}else{
			subPath=(window.location.pathname);
		}
		
		if(lang==='/en'){
			window.location.href = subPath;
		}else if(languageMatch(locale,lang)>-1 && (lang!=localpath)){
			window.location.href = locale[lang] + subPath;
		}
	}
</script>
	<!--<script type="text/javascript">
	    (function() {
	        var path = '//easy.myfonts.net/v2/js?sid=10336(font-family=Avenir+35+Light)&sid=10338(font-family=Avenir+55+Roman)&sid=10340(font-family=Avenir+85+Heavy)&sid=10344(font-family=Avenir+65+Medium)&key=nAD6PCOPrX',
	            protocol = ('https:' == document.location.protocol ? 'https:' : 'http:'),
	            trial = document.createElement('script');
	        trial.type = 'text/javascript';
	        trial.async = true;
	        trial.src = protocol + path;
	        var head = document.getElementsByTagName("head")[0];
	        head.appendChild(trial);
	    })();
	</script>-->
	
	<link type="text/css" rel="stylesheet" href="/static/css/prettify.css" />
	<script type="text/javascript" src="/static/js/prettify.js"></script>



<link rel="stylesheet" type="text/css" href="styles.css" />

</head>
<body >
	<!-- Google Tag Manager -->
	<script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
													  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script>
	<!-- End Google Tag Manager -->
	<!-- begin olark code -->
	<script data-cfasync="false" type='text/javascript'>/*<![CDATA[*/window.olark||(function(c){var f=window,d=document,l=f.location.protocol=="https:"?"https:":"http:",z=c.name,r="load";var nt=function(){
	f[z]=function(){
	(a.s=a.s||[]).push(arguments)};var a=f[z]._={
	},q=c.methods.length;while(q--){(function(n){f[z][n]=function(){
	f[z]("call",n,arguments)}})(c.methods[q])}a.l=c.loader;a.i=nt;a.p={
	0:+new Date};a.P=function(u){
	a.p[u]=new Date-a.p[0]};function s(){
	a.P(r);f[z](r)}f.addEventListener?f.addEventListener(r,s,false):f.attachEvent("on"+r,s);var ld=function(){function p(hd){
	hd="head";return["<",hd,"></",hd,"><",i,' onl' + 'oad="var d=',g,";d.getElementsByTagName('head')[0].",j,"(d.",h,"('script')).",k,"='",l,"//",a.l,"'",'"',"></",i,">"].join("")}var i="body",m=d[i];if(!m){
	return setTimeout(ld,100)}a.P(1);var j="appendChild",h="createElement",k="src",n=d[h]("div"),v=n[j](d[h](z)),b=d[h]("iframe"),g="document",e="domain",o;n.style.display="none";m.insertBefore(n,m.firstChild).id=z;b.frameBorder="0";b.id=z+"-loader";if(/MSIE[ ]+6/.test(navigator.userAgent)){
	b.src="javascript:false"}b.allowTransparency="true";v[j](b);try{
	b.contentWindow[g].open()}catch(w){
	c[e]=d[e];o="javascript:var d="+g+".open();d.domain='"+d.domain+"';";b[k]=o+"void(0);"}try{
	var t=b.contentWindow[g];t.write(p());t.close()}catch(x){
	b[k]=o+'d.write("'+p().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}a.P(2)};ld()};nt()})({
	loader: "static.olark.com/jsclient/loader0.js",name:"olark",methods:["configure","extend","declare","identify"]});
	/* custom configuration goes here (www.olark.com/documentation) */
	olark.identify('1356-750-10-5709');/*]]>*/</script><noscript><a href="https://www.olark.com/site/1356-750-10-5709/contact" title="Contact us" target="_blank">Questions? Feedback?</a> powered by <a href="http://www.olark.com?welcome" title="Olark live chat software">Olark live chat software</a></noscript>
	<!-- end olark code -->


	<div class="header-cont">
		<div id="header-wrapper">
			


	<script src="/static/js/jquery.tokeninput.js?change=123"></script>
	<link rel="stylesheet" type="text/css" href="/static/css/token-input.css">

<div class="shortcuts-wrapper">
	<div class="container">
		<!-- Shortcuts -->
		<nav id="shortcuts">
			<ul class="links">
				
					
					
						
						
					
					
					
						
					
					
					<li class="shortcut-1">
					

					
						<a href="/downloads" id="header_downloads">
							<span class="txt">downloads</span>
						</a>
					
					</li>
				
					
					
						
						
					
					
					
						
					
					
					<li class="shortcut-2">
					

					
						<a href="/guide" id="header_guide">
							<span class="txt">docs</span>
						</a>
					
					</li>
				
					
					
						
						
					
					
					
						
					
					
					<li class="shortcut-3">
					

					
						<a href="/subscriptions" id="header_subscriptions">
							<span class="txt">support</span>
						</a>
					
					</li>
				
					
					
						
						
					
					
					
						
					
					
					<li class="shortcut-4">
					

					
						<a href="https://discuss.elastic.co" id="header_forums" target="_blank">
							<span class="txt">forums</span>
						</a>
					
					</li>
				
					
					
						
						
					
					
					
						
						
					
					
					<li class="shortcut-5">
					

					
						<a href="/contact?storm=global-header-en" id="header_contact">
							<span class="txt">contact</span>
						</a>
					
					</li>
				
			</ul>
		</nav>
		<div class="languages-wrapper">
			<div class="global-language">
				<ul class="language">
					
						<li><a href="#">EN</a></li>
					
				</ul>
				<ul class="all-languages">
					
						
							
						
						<li><a href="/">English</a></li>
					
						
							
						
						<li><a href="/fr/">French</a></li>
					
						
							
						
						<li><a href="/de/">German</a></li>
					
						
							
						
						<li><a href="/jp/">Japanese</a></li>
					
						
							
						
						<li><a href="/kr/">Korean</a></li>
					
				</ul>
			</div>
		</div>
	</div>
</div>
<div class="container w100">
	<div class="row 0%">
		<div class="12u">
			

<section class="first-container desktop-main-nav">
	<div class="row 0%">
		<div class="11u 6u(small) 6u(xsmall)">
			<div id="elastic">
				<h1>
					<a href="/">
						<div id="elastic-logo">
						<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0" y="0" viewBox="-155 383.3 687.5 235.7" xml:space="preserve" enable-background="new -155 383.3 687.5 235.7"><path fill="#FFFFFF" d="M81.6 506.8c0-19.8-12.3-37.2-30.8-43.9 0.8-4.2 1.2-8.4 1.2-12.7 0-36.9-30-66.9-66.8-66.9 -21.6 0-41.6 10.3-54.2 27.7 -6.2-4.8-13.8-7.4-21.7-7.4 -19.6 0-35.5 15.9-35.5 35.5 0 4.3 0.8 8.5 2.2 12.4 -18.4 6.6-31 24.3-31 44 0 19.9 12.4 37.3 30.9 44 -0.8 4.1-1.2 8.4-1.2 12.7 0 36.8 29.9 66.7 66.7 66.7 21.6 0 41.6-10.4 54.1-27.8 6.2 4.9 13.8 7.6 21.7 7.6 19.6 0 35.5-15.9 35.5-35.5 0-4.3-0.8-8.5-2.2-12.4C68.9 544.2 81.6 526.5 81.6 506.8"/><path fill="#FED10A" d="M-62 484.8l51.8 23.6L42 462.6c0.8-3.8 1.1-7.5 1.1-11.5 0-32.2-26.2-58.4-58.4-58.4 -19.3 0-37.2 9.5-48.1 25.4l-8.7 45.1L-62 484.8z"/><path fill="#24BBB1" d="M-115.6 539.6c-0.8 3.8-1.1 7.7-1.1 11.7 0 32.3 26.3 58.5 58.6 58.5 19.4 0 37.5-9.6 48.4-25.6l8.6-44.9 -11.5-22 -52-23.7L-115.6 539.6z"/><path fill="#EF5098" d="M-115.9 450l35.5 8.4 7.8-40.3c-4.8-3.7-10.8-5.7-17-5.7 -15.4 0-28 12.5-28 28C-117.6 443.7-117 447-115.9 450"/><path fill="#17A8E0" d="M-119 458.5c-15.8 5.2-26.9 20.4-26.9 37.1 0 16.3 10.1 30.8 25.2 36.6l49.8-45 -9.1-19.5L-119 458.5z"/><path fill="#93C83E" d="M-0.7 584.2c4.9 3.7 10.8 5.8 16.9 5.8 15.4 0 28-12.5 28-28 0-3.4-0.6-6.7-1.7-9.7L7.1 544 -0.7 584.2z"/><path fill="#0779A1" d="M6.5 534.7l39 9.1c15.9-5.2 26.9-20.4 26.9-37.2 0-16.2-10.1-30.8-25.2-36.5l-51 44.7L6.5 534.7z"/><path d="M175.8 548.8l4.7-0.5 0.3 9.6c-12.4 1.7-23 2.6-31.8 2.6 -11.7 0-20-3.4-24.9-10.2s-7.3-17.4-7.3-31.7c0-28.6 11.4-42.9 34.1-42.9 11 0 19.2 3.1 24.6 9.2s8.1 15.8 8.1 28.9l-0.7 9.3h-53.8c0 9 1.6 15.7 4.9 20 3.3 4.3 8.9 6.5 17 6.5C159.2 549.8 167.4 549.5 175.8 548.8zM171.4 513.5c0-10-1.6-17.1-4.8-21.2 -3.2-4.1-8.4-6.2-15.6-6.2s-12.7 2.2-16.3 6.5c-3.6 4.3-5.5 11.3-5.6 20.9H171.4z"/><path d="M200.6 559V442h12.2v117H200.6z"/><path d="M289.9 502.1v40.1c0 4.1 10.1 4.9 10.1 4.9l-0.6 10.8c-8.6 0-15.7 0.7-20-3.4 -9.8 4.3-19.5 6.1-29.3 6.1 -7.5 0-13.2-2.1-17.1-6.4 -3.9-4.2-5.9-10.3-5.9-18.3 0-7.9 2-13.8 6-17.5 4-3.7 10.3-6.1 18.9-6.9l25.6-2.4v-7c0-5.5-1.2-9.5-3.6-11.9 -2.4-2.4-5.7-3.6-9.8-3.6h-32.1v-10.8h31.3c9.2 0 15.9 2.1 20.1 6.4C287.8 486.4 289.9 493.1 289.9 502.1zM239.7 535.3c0 10 4.1 15 12.4 15 7.4 0 14.7-1.2 21.8-3.7l3.7-1.3v-26.9l-24.1 2.3c-4.9 0.4-8.4 1.8-10.6 4.2C240.7 527.3 239.7 530.8 239.7 535.3z"/><path d="M337.6 486.7c-11.8 0-17.8 4.1-17.8 12.4 0 3.8 1.4 6.5 4.1 8.1s8.9 3.2 18.6 4.9c9.7 1.7 16.5 4 20.5 7.1 4 3 6 8.7 6 17.1 0 8.4-2.7 14.5-8.1 18.4 -5.4 3.9-13.2 5.9-23.6 5.9 -6.7 0-29.2-2.5-29.2-2.5l0.7-10.6c12.9 1.2 22.3 2.2 28.6 2.2 6.3 0 11.1-1 14.4-3s5-5.4 5-10.1 -1.4-7.9-4.2-9.6c-2.8-1.7-9-3.3-18.6-4.8s-16.4-3.7-20.4-6.7c-4-2.9-6-8.4-6-16.3 0-7.9 2.8-13.8 8.4-17.6 5.6-3.8 12.6-5.7 20.9-5.7 6.6 0 29.6 1.7 29.6 1.7v10.7C354.4 487.6 344.5 486.7 337.6 486.7z"/><path d="M428 488.1h-25.9v39c0 9.3 0.7 15.5 2 18.4 1.4 2.9 4.6 4.4 9.7 4.4l14.5-1 0.8 10.1c-7.3 1.2-12.8 1.8-16.6 1.8 -8.5 0-14.3-2.1-17.6-6.2s-4.9-12-4.9-23.6v-42.9h-11.6v-10.6H390v-25h12.1v24.9H428V488.1z"/><path d="M445 459v-14.1h12.2v14.2L445 459 445 459zM445 559v-81.5h12.2V559H445z"/><path d="M510.2 475.8c3.6 0 9.7 0.7 18.3 2l3.9 0.5 -0.5 9.9c-8.7-1-15.1-1.5-19.2-1.5 -9.2 0-15.5 2.2-18.8 6.6s-5 12.6-5 24.5c0 11.9 1.5 20.2 4.6 24.9 3.1 4.7 9.5 7 19.3 7l19.2-1.5 0.5 10.1c-10.1 1.5-17.7 2.3-22.7 2.3 -12.7 0-21.5-3.3-26.3-9.8s-7.3-17.5-7.3-33 2.6-26.4 7.8-32.6C489.3 479 498 475.8 510.2 475.8z"/></svg>
						</div>
					</a>
				</h1>
			</div>
			<nav id="nav">
				<ul>
					
					<li>
						
							
						
						<a href="/products" id="nav_products"   >Products</a>
						
						<ul class="dropdown">
							
								<li>
									

									
										<a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a>
									
								</li>								
							
								<li>
									

									
										<a href="/cloud" id="nav_elasticsearch_as_a_service" >elasticsearch as a service</a>
									
								</li>								
							
								<li>
									

									
										<a href="/products/logstash" id="nav_logstash" >logstash</a>
									
								</li>								
							
								<li>
									

									
										<a href="/products/kibana" id="nav_kibana" >kibana</a>
									
								</li>								
							
								<li>
									

									
										<a href="/products/beats" id="nav_beats" >beats</a>
									
								</li>								
							
								<li>
									

									
										<a href="/products/watcher" id="nav_watcher" >watcher</a>
									
								</li>								
							
								<li>
									

									
										<a href="/products/shield" id="nav_shield" >shield</a>
									
								</li>								
							
								<li>
									

									
										<a href="/products/marvel" id="nav_marvel" >marvel</a>
									
								</li>								
							
								<li>
									

									
										<a href="/products/graph" id="nav_graph" >graph</a>
									
								</li>								
							
								<li>
									

									
										<a href="/products/hadoop" id="nav_hadoop" >hadoop</a>
									
								</li>								
							
								<li>
									

									
										<a href="/downloads" id="nav_downloads" >downloads</a>
									
								</li>								
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/cloud" id="nav_cloud"   >Cloud</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/subscriptions" id="nav_subscriptions"   >Subscriptions</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/learn" id="nav_learn"   >Learn</a>
						
						<ul class="dropdown">
							
								<li>
									

									
										<a href="/guide" id="nav_guide" >docs</a>
									
								</li>								
							
								<li>
									

									
										<a href="/videos" id="nav_videos" >videos</a>
									
								</li>								
							
								<li>
									

									
										<a href="/training" id="nav_training" >training</a>
									
								</li>								
							
								<li>
									

									
										<a href="/services" id="nav_services" >services</a>
									
								</li>								
							
								<li>
									

									
										<a href="/blog" id="nav_learn_blog" >blog</a>
									
								</li>								
							
								<li>
									

									
										<a href="/elasticon" id="nav_learn_elasticon" >elastic{ON}</a>
									
								</li>								
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/community" id="nav_community"   >Community</a>
						
						<ul class="dropdown">
							
								<li>
									

									
										<a href="/community/meetups" id="nav_meetups" >meetups</a>
									
								</li>								
							
								<li>
									

									
										<a href="https://discuss.elastic.co" id="nav_forums" target="_blank">forums</a>
									
								</li>								
							
								<li>
									

									
										<a href="/community/codeofconduct" id="nav_codeofconduct" >code of conduct</a>
									
								</li>								
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/use-cases" id="nav_usecases"   >Use Cases</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/blog" id="nav_blog"   >Blog</a>
						
						<ul class="dropdown">
							
								<li>
									

									
										<a href="/blog/category/news" id="blog_news" >News</a>
									
								</li>								
							
								<li>
									

									
										<a href="/blog/category/engineering" id="blog_engineering" >Engineering</a>
									
								</li>								
							
								<li>
									

									
										<a href="/blog/category/user-stories" id="blog_user-stories" >User Stories</a>
									
								</li>								
							
								<li>
									

									
										<a href="/blog/category/releases" id="blog_releases" >Releases</a>
									
								</li>								
							
								<li>
									

									
										<a href="/blog/category/culture" id="blog_culture" >Culture</a>
									
								</li>								
							
								<li>
									

									
										<a href="/blog/archive" id="blog_archive" >Archive</a>
									
								</li>								
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/about" id="nav_about"   >About</a>
						
						<ul class="dropdown">
							
								<li>
									

									
										<a href="/about/leadership" id="nav_leadership" >leadership</a>
									
								</li>								
							
								<li>
									

									
										<a href="/about/board" id="nav_board" >board of directors</a>
									
								</li>								
							
								<li>
									

									
										<a href="/about/careers" id="nav_careers" >careers</a>
									
								</li>								
							
								<li>
									

									
										<a href="/about/partners" id="nav_partners" >partners</a>
									
								</li>								
							
								<li>
									

									
										<a href="/about/press" id="nav_press" >press</a>
									
								</li>								
								
						</ul>							
					</li>
					
				</ul>
			</nav>			
		</div>
		<div class="1u 6u(small) 6u(xsmall)">
			<div id="searchbar">
				<a href="#" class="button icon"></a>
			</div>
		</div>
	</div>
</section>
<div class="mobile-menu-wrapper">
	<div class="row 0%">
		<div class="8u 6u(small) 6u(xsmall)">
			<div id="elastic">
				<h1>
					<a href="/">
						<div id="elastic-logo">
						<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0" y="0" viewBox="-155 383.3 687.5 235.7" xml:space="preserve" enable-background="new -155 383.3 687.5 235.7"><path fill="#FFFFFF" d="M81.6 506.8c0-19.8-12.3-37.2-30.8-43.9 0.8-4.2 1.2-8.4 1.2-12.7 0-36.9-30-66.9-66.8-66.9 -21.6 0-41.6 10.3-54.2 27.7 -6.2-4.8-13.8-7.4-21.7-7.4 -19.6 0-35.5 15.9-35.5 35.5 0 4.3 0.8 8.5 2.2 12.4 -18.4 6.6-31 24.3-31 44 0 19.9 12.4 37.3 30.9 44 -0.8 4.1-1.2 8.4-1.2 12.7 0 36.8 29.9 66.7 66.7 66.7 21.6 0 41.6-10.4 54.1-27.8 6.2 4.9 13.8 7.6 21.7 7.6 19.6 0 35.5-15.9 35.5-35.5 0-4.3-0.8-8.5-2.2-12.4C68.9 544.2 81.6 526.5 81.6 506.8"/><path fill="#FED10A" d="M-62 484.8l51.8 23.6L42 462.6c0.8-3.8 1.1-7.5 1.1-11.5 0-32.2-26.2-58.4-58.4-58.4 -19.3 0-37.2 9.5-48.1 25.4l-8.7 45.1L-62 484.8z"/><path fill="#24BBB1" d="M-115.6 539.6c-0.8 3.8-1.1 7.7-1.1 11.7 0 32.3 26.3 58.5 58.6 58.5 19.4 0 37.5-9.6 48.4-25.6l8.6-44.9 -11.5-22 -52-23.7L-115.6 539.6z"/><path fill="#EF5098" d="M-115.9 450l35.5 8.4 7.8-40.3c-4.8-3.7-10.8-5.7-17-5.7 -15.4 0-28 12.5-28 28C-117.6 443.7-117 447-115.9 450"/><path fill="#17A8E0" d="M-119 458.5c-15.8 5.2-26.9 20.4-26.9 37.1 0 16.3 10.1 30.8 25.2 36.6l49.8-45 -9.1-19.5L-119 458.5z"/><path fill="#93C83E" d="M-0.7 584.2c4.9 3.7 10.8 5.8 16.9 5.8 15.4 0 28-12.5 28-28 0-3.4-0.6-6.7-1.7-9.7L7.1 544 -0.7 584.2z"/><path fill="#0779A1" d="M6.5 534.7l39 9.1c15.9-5.2 26.9-20.4 26.9-37.2 0-16.2-10.1-30.8-25.2-36.5l-51 44.7L6.5 534.7z"/><path d="M175.8 548.8l4.7-0.5 0.3 9.6c-12.4 1.7-23 2.6-31.8 2.6 -11.7 0-20-3.4-24.9-10.2s-7.3-17.4-7.3-31.7c0-28.6 11.4-42.9 34.1-42.9 11 0 19.2 3.1 24.6 9.2s8.1 15.8 8.1 28.9l-0.7 9.3h-53.8c0 9 1.6 15.7 4.9 20 3.3 4.3 8.9 6.5 17 6.5C159.2 549.8 167.4 549.5 175.8 548.8zM171.4 513.5c0-10-1.6-17.1-4.8-21.2 -3.2-4.1-8.4-6.2-15.6-6.2s-12.7 2.2-16.3 6.5c-3.6 4.3-5.5 11.3-5.6 20.9H171.4z"/><path d="M200.6 559V442h12.2v117H200.6z"/><path d="M289.9 502.1v40.1c0 4.1 10.1 4.9 10.1 4.9l-0.6 10.8c-8.6 0-15.7 0.7-20-3.4 -9.8 4.3-19.5 6.1-29.3 6.1 -7.5 0-13.2-2.1-17.1-6.4 -3.9-4.2-5.9-10.3-5.9-18.3 0-7.9 2-13.8 6-17.5 4-3.7 10.3-6.1 18.9-6.9l25.6-2.4v-7c0-5.5-1.2-9.5-3.6-11.9 -2.4-2.4-5.7-3.6-9.8-3.6h-32.1v-10.8h31.3c9.2 0 15.9 2.1 20.1 6.4C287.8 486.4 289.9 493.1 289.9 502.1zM239.7 535.3c0 10 4.1 15 12.4 15 7.4 0 14.7-1.2 21.8-3.7l3.7-1.3v-26.9l-24.1 2.3c-4.9 0.4-8.4 1.8-10.6 4.2C240.7 527.3 239.7 530.8 239.7 535.3z"/><path d="M337.6 486.7c-11.8 0-17.8 4.1-17.8 12.4 0 3.8 1.4 6.5 4.1 8.1s8.9 3.2 18.6 4.9c9.7 1.7 16.5 4 20.5 7.1 4 3 6 8.7 6 17.1 0 8.4-2.7 14.5-8.1 18.4 -5.4 3.9-13.2 5.9-23.6 5.9 -6.7 0-29.2-2.5-29.2-2.5l0.7-10.6c12.9 1.2 22.3 2.2 28.6 2.2 6.3 0 11.1-1 14.4-3s5-5.4 5-10.1 -1.4-7.9-4.2-9.6c-2.8-1.7-9-3.3-18.6-4.8s-16.4-3.7-20.4-6.7c-4-2.9-6-8.4-6-16.3 0-7.9 2.8-13.8 8.4-17.6 5.6-3.8 12.6-5.7 20.9-5.7 6.6 0 29.6 1.7 29.6 1.7v10.7C354.4 487.6 344.5 486.7 337.6 486.7z"/><path d="M428 488.1h-25.9v39c0 9.3 0.7 15.5 2 18.4 1.4 2.9 4.6 4.4 9.7 4.4l14.5-1 0.8 10.1c-7.3 1.2-12.8 1.8-16.6 1.8 -8.5 0-14.3-2.1-17.6-6.2s-4.9-12-4.9-23.6v-42.9h-11.6v-10.6H390v-25h12.1v24.9H428V488.1z"/><path d="M445 459v-14.1h12.2v14.2L445 459 445 459zM445 559v-81.5h12.2V559H445z"/><path d="M510.2 475.8c3.6 0 9.7 0.7 18.3 2l3.9 0.5 -0.5 9.9c-8.7-1-15.1-1.5-19.2-1.5 -9.2 0-15.5 2.2-18.8 6.6s-5 12.6-5 24.5c0 11.9 1.5 20.2 4.6 24.9 3.1 4.7 9.5 7 19.3 7l19.2-1.5 0.5 10.1c-10.1 1.5-17.7 2.3-22.7 2.3 -12.7 0-21.5-3.3-26.3-9.8s-7.3-17.5-7.3-33 2.6-26.4 7.8-32.6C489.3 479 498 475.8 510.2 475.8z"/></svg>
						</div>
					</a>
				</h1>
			</div>
		</div>
		<div class="4u 6u(small) 6u(xsmall) text-right">
			<!-- <div class="mobile-menu-wrapper"> -->
				<ul class="m-shortcuts">
					
						

						
							<li><a href="#" class="m-search" id="header-search"></a></li>
						
					
						

						
							<li><a href="/guide" class="m-docs" id="mobile-docs"></a></li>
						
					
						

						
							<li><a href="/contact" class="m-contact" id="mobile-contact"></a></li>
						
					
				</ul>	
				<nav class="nav-menu">
					<div class="menu-button">
						<span></span>
					</div>
					<div class="nav-menu-list-wrap">
						<div class="nav-menu-list">
							
								<h3><a href="/products" id="nav_products" >Products</a></h3>
								
								<ul>
									
									
									
									
										<li><a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a></li>
									
									
									
									
									
									
										<li><a href="/cloud" id="nav_elasticsearch_as_a_service" >elasticsearch as a service</a></li>
									
									
									
									
									
									
										<li><a href="/products/logstash" id="nav_logstash" >logstash</a></li>
									
									
									
									
									
									
										<li><a href="/products/kibana" id="nav_kibana" >kibana</a></li>
									
									
									
									
									
									
										<li><a href="/products/beats" id="nav_beats" >beats</a></li>
									
									
									
									
									
									
										<li><a href="/products/watcher" id="nav_watcher" >watcher</a></li>
									
									
									
									
									
									
										<li><a href="/products/shield" id="nav_shield" >shield</a></li>
									
									
									
									
									
									
										<li><a href="/products/marvel" id="nav_marvel" >marvel</a></li>
									
									
									
									
									
									
										<li><a href="/products/graph" id="nav_graph" >graph</a></li>
									
									
									
									
									
									
										<li><a href="/products/hadoop" id="nav_hadoop" >hadoop</a></li>
									
									
									
									
									
									
										<li><a href="/downloads" id="nav_downloads" >downloads</a></li>
									
									
									
								</ul>
								
							
								<h3><a href="/cloud" id="nav_cloud" >Cloud</a></h3>
								
							
								<h3><a href="/subscriptions" id="nav_subscriptions" >Subscriptions</a></h3>
								
							
								<h3><a href="/learn" id="nav_learn" >Learn</a></h3>
								
								<ul>
									
									
									
									
										<li><a href="/guide" id="nav_guide" >docs</a></li>
									
									
									
									
									
									
										<li><a href="/videos" id="nav_videos" >videos</a></li>
									
									
									
									
									
									
										<li><a href="/training" id="nav_training" >training</a></li>
									
									
									
									
									
									
										<li><a href="/services" id="nav_services" >services</a></li>
									
									
									
									
									
									
										<li><a href="/blog" id="nav_learn_blog" >blog</a></li>
									
									
									
									
									
									
										<li><a href="/elasticon" id="nav_learn_elasticon" >elastic{ON}</a></li>
									
									
									
								</ul>
								
							
								<h3><a href="/community" id="nav_community" >Community</a></h3>
								
								<ul>
									
									
									
									
										<li><a href="/community/meetups" id="nav_meetups" >meetups</a></li>
									
									
									
									
									
									
										<li><a href="https://discuss.elastic.co" id="nav_forums" target="_blank">forums</a></li>
									
									
									
									
									
									
										<li><a href="/community/codeofconduct" id="nav_codeofconduct" >code of conduct</a></li>
									
									
									
								</ul>
								
							
								<h3><a href="/use-cases" id="nav_usecases" >Use Cases</a></h3>
								
							
								<h3><a href="/blog" id="nav_blog" >Blog</a></h3>
								
								<ul>
									
									
									
									
										<li><a href="/blog/category/news" id="blog_news" >News</a></li>
									
									
									
									
									
									
										<li><a href="/blog/category/engineering" id="blog_engineering" >Engineering</a></li>
									
									
									
									
									
									
										<li><a href="/blog/category/user-stories" id="blog_user-stories" >User Stories</a></li>
									
									
									
									
									
									
										<li><a href="/blog/category/releases" id="blog_releases" >Releases</a></li>
									
									
									
									
									
									
										<li><a href="/blog/category/culture" id="blog_culture" >Culture</a></li>
									
									
									
									
									
									
										<li><a href="/blog/archive" id="blog_archive" >Archive</a></li>
									
									
									
								</ul>
								
							
								<h3><a href="/about" id="nav_about" >About</a></h3>
								
								<ul>
									
									
									
									
										<li><a href="/about/leadership" id="nav_leadership" >leadership</a></li>
									
									
									
									
									
									
										<li><a href="/about/board" id="nav_board" >board of directors</a></li>
									
									
									
									
									
									
										<li><a href="/about/careers" id="nav_careers" >careers</a></li>
									
									
									
									
									
									
										<li><a href="/about/partners" id="nav_partners" >partners</a></li>
									
									
									
									
									
									
										<li><a href="/about/press" id="nav_press" >press</a></li>
									
									
									
								</ul>
								
							
						</div>
					</div>
				</nav>
			<!-- </div> -->
		</div>
	</div>
</div>
<!-- Mobile Menu -->


		</div>
	</div>
</div>
<div class="header-search-wrapper">	
	<div class="container">
		<div class="big-search">
			<i class="big-search-icon"></i>
			<form method="get" action="/search" autocomplete="on" name="searchForm" id="searchfrm">
				<ul class="tags-wrapper">
					<li class="search-field"><input type="text" class="form-control global-input" id="autocomplete" name="q"></li>
				</ul>
			</form>
			<a href="#" class="header-search-cancel"></a>
		</div>
		<div class="nav-auto-complete"></div>
	</div>
</div>
<style>	
	
	
		.m-shortcuts li a.m-search {
			background: url("https://static-www.elastic.co/assets/blt174b13be89ff803c/m-search-icon.png?q=400") no-repeat scroll center center rgba(0, 0, 0, 0);
			background-size: contain;}
	
		.m-shortcuts li a.m-docs {
			background: url("https://static-www.elastic.co/assets/blt5ba03f594a7d610a/m-guide-icon.png?q=400") no-repeat scroll center center rgba(0, 0, 0, 0);
			background-size: contain;}
	
		.m-shortcuts li a.m-contact {
			background: url("https://static-www.elastic.co/assets/blt38c3e853c4b1174d/m-contact-icon.png?q=400") no-repeat scroll center center rgba(0, 0, 0, 0);
			background-size: contain;}
		
</style>
		</div>
	</div>
  	<div id="content">
  		
	  			
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [2.x]
    </a></span> » <span class="breadcrumb-link"><a href="search-in-depth.html">Search in Depth </a></span> » <span class="breadcrumb-link"><a href="controlling-relevance.html">Controlling Relevance</a></span> » <span class="breadcrumb-node">Theory Behind Relevance Scoring</span></div><div class="navheader"><span class="prev"><a href="controlling-relevance.html">
              « 
              Controlling Relevance</a>
           
        </span><span class="next">
           
          <a href="practical-scoring-function.html">Lucene’s Practical Scoring Function
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="scoring-theory"></a>Theory Behind Relevance Scoring<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/10_Scoring_theory.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Lucene (and thus Elasticsearch) uses the
<a class="ulink" href="http://en.wikipedia.org/wiki/Standard_Boolean_model" target="_top"><span class="emphasis"><em>Boolean model</em></span></a>
to find matching documents,<a id="id-1.5.8.8.2.2" class="indexterm"></a>
<a id="id-1.5.8.8.2.3" class="indexterm"></a><a id="id-1.5.8.8.2.4" class="indexterm"></a> and a formula called the
<a class="link" href="practical-scoring-function.html" title="Lucene’s Practical Scoring Function"><span class="emphasis"><em>practical scoring function</em></span></a>
to calculate relevance.  This formula borrows concepts from
<a class="ulink" href="http://en.wikipedia.org/wiki/Tfidf" target="_top"><span class="emphasis"><em>term frequency/inverse document frequency</em></span></a> and the
<a class="ulink" href="http://en.wikipedia.org/wiki/Vector_space_model" target="_top"><span class="emphasis"><em>vector space model</em></span></a>
but adds more-modern features like a coordination factor, field length
normalization, and term or query clause boosting.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Don’t be alarmed!  These concepts are not as complicated as the names make
them appear. While this section mentions algorithms, formulae, and mathematical
models, it is intended for consumption by mere humans.  Understanding the
algorithms themselves is not as important as understanding the factors that
influence the outcome.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="boolean-model"></a>Boolean Model<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/10_Scoring_theory.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <span class="emphasis"><em>Boolean model</em></span> simply applies the <code class="literal">AND</code>, <code class="literal">OR</code>, and <code class="literal">NOT</code> conditions
expressed in the query to find all the documents that match.<a id="id-1.5.8.8.4.2.5" class="indexterm"></a><a id="id-1.5.8.8.4.2.6" class="indexterm"></a><a id="id-1.5.8.8.4.2.7" class="indexterm"></a> A query for</p><pre class="literallayout">full AND text AND search AND (elasticsearch OR lucene)</pre><p>will include only documents that contain all of the terms <code class="literal">full</code>, <code class="literal">text</code>, and
<code class="literal">search</code>, and either <code class="literal">elasticsearch</code> or <code class="literal">lucene</code>.</p><p>This process is simple and fast.  It is used to exclude any documents that
cannot possibly match the query.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="tfidf"></a>Term Frequency/Inverse Document Frequency (TF/IDF)<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/10_Scoring_theory.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Once we have a list of matching documents, they need to be ranked by
relevance.<a id="id-1.5.8.8.5.2.1" class="indexterm"></a> Not all documents will contain all the terms, and some terms are
more important than others. The relevance score of the whole document
depends (in part) on the <span class="emphasis"><em>weight</em></span> of each query term that appears in
that document.</p><p>The weight of a term is determined by three factors, which we already
introduced in <a class="xref" href="relevance-intro.html" title="What Is Relevance?">What Is Relevance?</a>. The formulae are included for interest’s
sake, but you are not required to remember them.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="tf"></a>Term frequency<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/10_Scoring_theory.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>How often does the term appear in this document?<a id="id-1.5.8.8.5.4.2.1" class="indexterm"></a>
<a id="id-1.5.8.8.5.4.2.2" class="indexterm"></a> The more often, the
<span class="emphasis"><em>higher</em></span> the weight.  A field containing five mentions of the same term is
more likely to be relevant than a field containing just one mention.
The term frequency is calculated as follows:</p><pre class="literallayout">tf(t in d) = √frequency <a id="CO101-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO101-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The term frequency (<code class="literal">tf</code>) for term <code class="literal">t</code> in document <code class="literal">d</code> is the square root
    of the number of times the term appears in the document.
</p></td></tr></table></div><p>If you don’t care about how often a term appears in a field, and all you care
about is that the term is present, then you can disable term frequencies in
the field mapping:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">PUT /my_index
{
  "mappings": {
    "doc": {
      "properties": {
        "text": {
          "type":          "string",
          "index_options": "docs" <a id="CO102-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO102-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Setting <code class="literal">index_options</code> to <code class="literal">docs</code> will disable term frequencies and term
    positions. A field with this mapping will not count how many times a term
    appears, and will not be usable for phrase or proximity queries.
    Exact-value <code class="literal">not_analyzed</code> string fields use this setting by default.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idf"></a>Inverse document frequency<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/10_Scoring_theory.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>How often does the term appear in all documents in the collection?  The more
often, the <span class="emphasis"><em>lower</em></span> the weight.<a id="id-1.5.8.8.5.5.2.2" class="indexterm"></a><a id="id-1.5.8.8.5.5.2.3" class="indexterm"></a>
<a id="id-1.5.8.8.5.5.2.4" class="indexterm"></a> Common terms like <code class="literal">and</code> or <code class="literal">the</code> contribute
little to relevance, as they appear in most documents, while uncommon terms
like <code class="literal">elastic</code> or <code class="literal">hippopotamus</code> help us zoom in on the most interesting
documents. The inverse document frequency is calculated as follows:</p><pre class="literallayout">idf(t) = 1 + log ( numDocs / (docFreq + 1)) <a id="CO103-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO103-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The inverse document frequency (<code class="literal">idf</code>) of term <code class="literal">t</code> is the
    logarithm of the number of documents in the index, divided by
    the number of documents that contain the term.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="field-norm"></a>Field-length norm<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/10_Scoring_theory.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>How long is the field?  <a id="id-1.5.8.8.5.6.2.1" class="indexterm"></a>
<a id="id-1.5.8.8.5.6.2.2" class="indexterm"></a><a id="id-1.5.8.8.5.6.2.3" class="indexterm"></a>The shorter the field, the <span class="emphasis"><em>higher</em></span> the weight. If a
term appears in a short field, such as a <code class="literal">title</code> field, it is more likely that
the content of that field is <span class="emphasis"><em>about</em></span> the term than if the same term appears
in a much bigger <code class="literal">body</code> field. The field length norm is calculated as follows:</p><pre class="literallayout">norm(d) = 1 / √numTerms <a id="CO104-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO104-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The field-length norm (<code class="literal">norm</code>) is the inverse square root of the number of terms
    in the field.
</p></td></tr></table></div><p>While the field-length <a id="id-1.5.8.8.5.6.5.1" class="indexterm"></a>
<a id="id-1.5.8.8.5.6.5.2" class="indexterm"></a>norm is important for full-text search, many other
fields don’t need norms. Norms consume approximately 1 byte per <code class="literal">string</code> field
per document in the index, whether or not a document contains the field.  Exact-value <code class="literal">not_analyzed</code> string fields have norms disabled by default,
but you can use the field mapping to disable norms on <code class="literal">analyzed</code> fields as
well:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">PUT /my_index
{
  "mappings": {
    "doc": {
      "properties": {
        "text": {
          "type": "string",
          "norms": { "enabled": false } <a id="CO105-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO105-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
This field will not take the field-length norm into account.  A long field
    and a short field will be scored as if they were the same length.
</p></td></tr></table></div><p>For use cases such as logging, norms are not useful.  All you care about is
whether a field contains a particular error code or a particular browser
identifier. The length of the field does not affect the outcome.  Disabling
norms can save a significant amount of memory.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_putting_it_together"></a>Putting it together<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/10_Scoring_theory.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>These three factors—term frequency, inverse document frequency, and field-length norm—are calculated and stored at index time.<a id="id-1.5.8.8.5.7.2.1" class="indexterm"></a>
<a id="id-1.5.8.8.5.7.2.2" class="indexterm"></a>  Together, they are
used to calculate the <span class="emphasis"><em>weight</em></span> of a single term in a particular document.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>When we refer to <span class="emphasis"><em>documents</em></span> in the preceding formulae, we are actually talking about
a field within a document.  Each field has its own inverted index and thus,
for TF/IDF purposes, the value of the field is the value of the document.</p></div></div><p>When we run a simple <code class="literal">term</code> query with <code class="literal">explain</code> set to <code class="literal">true</code> (see
<a class="xref" href="relevance-intro.html#explain" title="Understanding the Score">Understanding the Score</a>), you will see that the only factors involved in calculating the
score are the ones explained in the preceding sections:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-json">PUT /my_index/doc/1
{ "text" : "quick brown fox" }

GET /my_index/doc/_search?explain
{
  "query": {
    "term": {
      "text": "fox"
    }
  }
}</pre></div><p>The (abbreviated) <code class="literal">explanation</code> from the preceding request is as follows:</p><pre class="literallayout">weight(text:fox in 0) [PerFieldSimilarity]:  0.15342641 <a id="CO106-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
result of:
    fieldWeight in 0                         0.15342641
    product of:
        tf(freq=1.0), with freq of 1:        1.0 <a id="CO106-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
        idf(docFreq=1, maxDocs=1):           0.30685282 <a id="CO106-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
        fieldNorm(doc=0):                    0.5 <a id="CO106-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO106-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The final <code class="literal">score</code> for term <code class="literal">fox</code> in field <code class="literal">text</code> in the document with internal
    Lucene doc ID <code class="literal">0</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO106-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The term <code class="literal">fox</code> appears once in the <code class="literal">text</code> field in this document.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO106-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The inverse document frequency of <code class="literal">fox</code> in the <code class="literal">text</code> field in all
    documents in this index.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO106-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The field-length normalization factor for this field.
</p></td></tr></table></div><p>Of course, queries usually consist of more than one term, so we need a
way of combining the weights of multiple terms.  For this, we turn to the
vector space model.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="vector-space-model"></a>Vector Space Model<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/170_Relevance/10_Scoring_theory.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <span class="emphasis"><em>vector space model</em></span> provides a way of <a id="id-1.5.8.8.6.2.2" class="indexterm"></a>comparing a multiterm query
against a document. The output is a single score that represents how well the
document matches the query.  In order to do this, the model represents both the document
and the query as <span class="emphasis"><em>vectors</em></span>.</p><p>A vector is really just a one-dimensional array containing numbers, for example:</p><pre class="literallayout">[1,2,5,22,3,8]</pre><p>In the vector space<a id="id-1.5.8.8.6.5.1" class="indexterm"></a>
<a id="id-1.5.8.8.6.5.2" class="indexterm"></a> model, each number in the vector is<a id="id-1.5.8.8.6.5.3" class="indexterm"></a>
<a id="id-1.5.8.8.6.5.4" class="indexterm"></a>
<a id="id-1.5.8.8.6.5.5" class="indexterm"></a> the <span class="emphasis"><em>weight</em></span> of a term,
as calculated with <a class="link" href="scoring-theory.html#tfidf" title="Term Frequency/Inverse Document Frequency (TF/IDF)">term frequency/inverse document frequency</a>.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>While TF/IDF is the default way of calculating term weights for the vector
space model, it is not the only way.  Other models like Okapi-BM25 exist and
are available in Elasticsearch.  TF/IDF is the default because it is a
simple, efficient algorithm that produces high-quality search results and
has stood the test of time.</p></div></div><p>Imagine that we have a query for “happy hippopotamus.”  A common word like
<code class="literal">happy</code> will have a low weight, while an uncommon term like <code class="literal">hippopotamus</code>
will have a high weight. Let’s assume that <code class="literal">happy</code> has a weight of 2 and
<code class="literal">hippopotamus</code> has a weight of 5.  We can plot this simple two-dimensional
vector—<code class="literal">[2,5]</code>—as a line on a graph starting at point (0,0) and
ending at point (2,5), as shown in <a class="xref" href="scoring-theory.html#img-vector-query" title="Figure 27. A two-dimensional query vector for “happy hippopotamus” represented">Figure 27, “A two-dimensional query vector for “happy hippopotamus” represented”</a>.</p><div class="figure"><a id="img-vector-query"></a><p class="title"><strong>Figure 27. A two-dimensional query vector for “happy hippopotamus” represented</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/elas_17in01.png" alt="The query vector plotted on a graph" /></div></div></div><br class="figure-break" /><p>Now, imagine we have three documents:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
I am <span class="emphasis"><em>happy</em></span> in summer.
</li><li class="listitem">
After Christmas I’m a <span class="emphasis"><em>hippopotamus</em></span>.
</li><li class="listitem">
The <span class="emphasis"><em>happy hippopotamus</em></span> helped Harry.
</li></ol></div><p>We can create a similar vector for each document, consisting of the weight of
each query term—<code class="literal">happy</code> and <code class="literal">hippopotamus</code>—that appears in the
document, and plot these vectors on the same graph, as shown in <a class="xref" href="scoring-theory.html#img-vector-docs" title="Figure 28. Query and document vectors for “happy hippopotamus”">Figure 28, “Query and document vectors for “happy hippopotamus””</a>:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Document 1: <code class="literal">(happy,____________)</code>—<code class="literal">[2,0]</code>
</li><li class="listitem">
Document 2: <code class="literal">( ___ ,hippopotamus)</code>—<code class="literal">[0,5]</code>
</li><li class="listitem">
Document 3: <code class="literal">(happy,hippopotamus)</code>—<code class="literal">[2,5]</code>
</li></ul></div><div class="figure"><a id="img-vector-docs"></a><p class="title"><strong>Figure 28. Query and document vectors for “happy hippopotamus”</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/elas_17in02.png" alt="The query and document vectors plotted on a graph" /></div></div></div><br class="figure-break" /><p>The nice thing about vectors is that they can be compared. By measuring the
angle between the query vector and the document vector, it is possible to
assign a relevance score to each document. The angle between document 1 and
the query is large, so it is of low relevance.  Document 2 is closer to the
query, meaning that it is reasonably relevant, and document 3 is a perfect
match.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>In practice, only two-dimensional vectors (queries with two terms) can  be
plotted easily on a graph. Fortunately, <span class="emphasis"><em>linear algebra</em></span>—the branch of
mathematics that deals with vectors—provides tools to compare the
angle between multidimensional vectors, which means that we can apply the
same principles explained above to queries that consist of many terms.</p><p>You can read more about how to compare two vectors by using <a class="ulink" href="http://en.wikipedia.org/wiki/Cosine_similarity" target="_top"><span class="emphasis"><em>cosine similarity</em></span></a>.</p></div></div><p>Now that we have talked about the theoretical basis of scoring, we can move on
to see how scoring is implemented in Lucene.<a id="id-1.5.8.8.6.16.1" class="indexterm"></a>
<a id="id-1.5.8.8.6.16.2" class="indexterm"></a></p></div></div><div class="navfooter"><span class="prev"><a href="controlling-relevance.html">
              « 
              Controlling Relevance</a>
           
        </span><span class="next">
           
          <a href="practical-scoring-function.html">Lucene’s Practical Scoring Function
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
        >
	<h3>Top Videos</h3>
	<ul class="lists">
		<li><a href="https://www.elastic.co/webinars/elasticsearch-2-0-overview?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li>
		<li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li>
		<li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li>
	</ul>
</div>


	  	



<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
	<!-- subscribe-newsletter -->
	<div id="subscribe-newsletter">
		<div class="container">
			<div class="row">
				<div class="12u">
					<div class="subscribe-wrapper" id="rtp-newsletter">
						<header>
							<h3>Subscribe to our newsletter</h3>
						</header>
						<div class="subscribe-form">
							<form id="mktoForm_1398" class="container sb-form"></form>
							<div class="form_thanks hide">
								
									<p>Thanks for subscribing! We'll keep you updated with new releases.</p>
								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

  	<!-- Footer -->
	<div id="footer-wrapper">
		<section id="footer" class="container">
			<div class="row">
				<div class="12u">
					<!-- Copyright -->
					<div id="copyright">
	<p>
		© 2016. All Rights Reserved - Elasticsearch
	</p>
	<ul class="links">
		<li>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</li>
		<li><a href="/legal/trademarks" id="footer_trademarks">Trademarks</a></li>
		<li><a href="/legal/terms-of-use" id="footer_terms">Terms</a></li>
		<li><a href="/legal/privacy-policy" id="footer_privacy">Privacy</a></li>
<li><a href="/brand" id="footer_brand">Brand</a></li>
	</ul>
	<p>
		Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other&nbsp;countries.
	</p>
</div>
<!--<div class="row">
{replace4}
</div>-->
				</div>
			</div>
		</section>
	</div>

	<!-- Social Media -->
	<div id="socialmedia-wrapper">
		<section id="socialmedia" class="container">
			<!-- social icons -->
			<div id="social">
				<ul class="links">
					
						<li class="facebook grayscale"><a href="http://www.facebook.com/elastic.co" target="_blank" id="footer_facebook"></a></li>
					
						<li class="twitter grayscale"><a href="https://www.twitter.com/elastic" target="_blank" id="footer_twitter"></a></li>
					
						<li class="linkedin grayscale"><a href="https://www.linkedin.com/company/elastic-co" target="_blank" id="footer_linkedin"></a></li>
					
						<li class="xing grayscale"><a href="https://www.xing.com/companies/elastic.co" target="_blank" id="footer_xing"></a></li>
					
						<li class="youtube grayscale"><a href="https://www.youtube.com/user/elasticsearch" target="_blank" id="footer_youtube"></a></li>
					
				</ul>
			</div>
		</section>
	</div>

<style type="text/css">
	
		.facebook{background:url("https://static-www.elastic.co/assets/bltda40eebd7c7cae9a/facebook.svg?q=400") no-repeat;}
	
		.twitter{background:url("https://static-www.elastic.co/assets/bltfd3b1511512f4632/twitter.svg?q=400") no-repeat;}
	
		.linkedin{background:url("https://static-www.elastic.co/assets/blt6b4f6f8d6b96f814/linkedin.svg?q=400") no-repeat;}
	
		.xing{background:url("https://static-www.elastic.co/assets/blta76b2ae2b2f10a98/xing.svg?q=400") no-repeat;}
	
		.youtube{background:url("https://static-www.elastic.co/assets/blt5761648c9581fb53/youtube.svg?q=400") no-repeat;}
	
</style>

<script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
	form.onSuccess(function(form){
		$('#mktoForm_1398').css('display','none');
		$('#subscribe-newsletter header').hide();
		$('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
		dataLayer.push({'event': 'mktoFormSubmit'});
	    return false;
  	});
});
</script>


  	</div>
  	<!-- <div class="preloader">
    	<div class="status"></div>
	</div> -->
  	<style></style>
   	<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script>
<script src="https://static-www.elastic.co/static/js/jquery.autocomplete.js?q=400"></script>
<script src="https://static-www.elastic.co/static/js/script.js?q=400"></script>


   	

   	

            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        
