<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Reindex API
        | Elasticsearch Reference [6.0]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [6.0]" /><link rel="up" href="docs.html" title="Document APIs" /><link rel="prev" href="docs-bulk.html" title="Bulk API" /><link rel="next" href="docs-termvectors.html" title="Term Vectors" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.0" />
    <!-- RTP tag -->
    <script type='text/javascript' async>
    (function(c,h,a,f,i,e){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};c[a].a=i;c[a].e=e;var g=h.createElement("script");g.async=true;g.type="text/javascript";g.src=f+'?aid='+i;var b=h.getElementsByTagName("script")[0];b.parentNode.insertBefore(g,b);})(window,document,"rtp","//sjrtp2-cdn.marketo.com/rtp-api/v1/rtp.js","elasticco");

    rtp('send','view');
    rtp('get', 'campaign',true);
    </script> 
    <!-- End of RTP tag -->
    

    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
<meta name="apple-mobile-web-app-title" content="Elastic">
<meta name="application-name" content="Elastic">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- DC tags section -->
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
<link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >



	



<!-- end DC tags -->


	<meta name="description" content="" />



	<meta name="localized" content="true" />

	<meta name="published_date" content="2017-04-06T11:42:52.148Z" />




		
			<meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
		

		

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">

	   

    <!-- css -->
    <link href="https://static-www.elastic.co/static/css/main.css?q=350" rel="stylesheet">
    
    

    <script src="https://static-www.elastic.co/static/js/jquery.min.js?q=350"></script>
    <script src="https://static-www.elastic.co/static/js/bootstrap.min.js?q=350"></script>
    <script src="https://static-www.elastic.co/static/js/jquery.cookie.js?q=350"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // ---------------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
        locales = {
          '/en/': '/',
          '/de/': '/de/',
          '/fr/': '/fr/',
          '/ja/':'/jp/',
          '/ko/':'/kr/',
          '/zh/':'/cn/'
        }
        localepages = ['/','/de/','/fr/','/jp/','/kr/','/cn/','/products','/de/products','/fr/products','/jp/products','/kr/products','/cn/products'],
        locationpath = window.location.pathname,
        localeUrl = '{"relative_url_prefix":"/","code":"en-us","url":"/guide_template"}',
        currentlocale = JSON.parse(localeUrl);
    
      if(localepages.indexOf(locationpath) != -1){
        if($.cookie("c_lang")){
          if($.cookie("c_lang") != currentlocale.relative_url_prefix){
            var cookieurl = $.cookie("c_lang") + currentlocale.url.slice(1,currentlocale.url.length);
            window.location = cookieurl;
          }
        }
        else{
          var locale_lang = "/";
          if(locales[lang] != undefined){
            locale_lang = locales[lang];
          }
          $.cookie("c_lang",locale_lang ,{ expires: 365, path: '/'}); 
          window.location = localepages[localepages.indexOf(locationpath)];
        }
      }
      
      // --------------------- end of set language based on browser language -----------------
      </script>


	
	<link type="text/css" rel="stylesheet" href="https://static-www.elastic.co/static/css/guide.css?q=350" />


  
<link rel="stylesheet" type="text/css" href="styles.css" />

</head>
  <body >
  	<!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
                              height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- begin olark code -->
    <script data-cfasync="false" type='text/javascript'>/*<![CDATA[*/window.olark||(function(c){var f=window,d=document,l=f.location.protocol=="https:"?"https:":"http:",z=c.name,r="load";var nt=function(){
    f[z]=function(){
    (a.s=a.s||[]).push(arguments)};var a=f[z]._={
    },q=c.methods.length;while(q--){(function(n){f[z][n]=function(){
    f[z]("call",n,arguments)}})(c.methods[q])}a.l=c.loader;a.i=nt;a.p={
    0:+new Date};a.P=function(u){
    a.p[u]=new Date-a.p[0]};function s(){
    a.P(r);f[z](r)}f.addEventListener?f.addEventListener(r,s,false):f.attachEvent("on"+r,s);var ld=function(){function p(hd){
    hd="head";return["<",hd,"></",hd,"><",i,' onl' + 'oad="var d=',g,";d.getElementsByTagName('head')[0].",j,"(d.",h,"('script')).",k,"='",l,"//",a.l,"'",'"',"></",i,">"].join("")}var i="body",m=d[i];if(!m){
    return setTimeout(ld,100)}a.P(1);var j="appendChild",h="createElement",k="src",n=d[h]("div"),v=n[j](d[h](z)),b=d[h]("iframe"),g="document",e="domain",o;n.style.display="none";m.insertBefore(n,m.firstChild).id=z;b.frameBorder="0";b.id=z+"-loader";if(/MSIE[ ]+6/.test(navigator.userAgent)){
    b.src="javascript:false"}b.allowTransparency="true";v[j](b);try{
    b.contentWindow[g].open()}catch(w){
    c[e]=d[e];o="javascript:var d="+g+".open();d.domain='"+d.domain+"';";b[k]=o+"void(0);"}try{
    var t=b.contentWindow[g];t.write(p());t.close()}catch(x){
    b[k]=o+'d.write("'+p().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}a.P(2)};ld()};nt()})({
    loader: "static.olark.com/jsclient/loader0.js",name:"olark",methods:["configure","extend","declare","identify"]});
    /* custom configuration goes here (www.olark.com/documentation) */
    olark.identify('1356-750-10-5709');/*]]>*/</script><noscript><a href="https://www.olark.com/site/1356-750-10-5709/contact" title="Contact us">Questions? Feedback?</a> powered by <a href="http://www.olark.com?welcome" title="Olark live chat software">Olark live chat software</a></noscript>
    <!-- end olark code -->

    <script> 
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ 
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), 
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) 
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); 
      ga('create', 'UA-12395217-16', 'auto'); 
      ga('send', 'pageview'); 
    </script>

    <!-- Header Section -->
    
<header class="header-wrapper">
  


  




<div class="navigation-wrapper">
  <div class="container">
    <nav class="navbar">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-mobile-header navbar-header mr-20 mr-xs-0">
      <div class="row hidden-sm hidden-md hidden-lg">
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg">
          <div class="navbar-mobile-header-icon navbar-mobile-header-icon-out">
            <span></span>
            <span></span>
            <span></span>
          </div>
          
        </div>
        <div class="col-xs-2 text-center">
          <div class="navbar-brand" id="elastic">
            <h1>
              <a class="logo-m hidden-sm hidden-md hidden-lg" href="/">
                <img src="https://static-www.elastic.co/assets/bltd5ac38b4549d53de/elastic-logo-mobile (1).svg?q=350" alt="elastic-logo-mobile">
              </a>
            </h1>
          </div>
        </div>
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right">
          <ul class="menu-m hidden-sm hidden-md hidden-lg">
            <li class=""><a class="icon-contact" href="/contact"></a></li>
            <li id="searchbar"><a class="button icon" href="#"></a></li>
            <li class="lang global-language">
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              <ul class="language-list">
                
                  
                    
                  
                <li><a href="/" data-value="/" id="locale-select">English</a></li>
                
                  
                    
                  
                <li><a href="/fr/" data-value="/fr/" id="locale-select">Français</a></li>
                
                  
                    
                  
                <li><a href="/de/" data-value="/de/" id="locale-select">Deutsch</a></li>
                
                  
                    
                  
                <li><a href="/jp/" data-value="/jp/" id="locale-select">日本語</a></li>
                
                  
                    
                  
                <li><a href="/kr/" data-value="/kr/" id="locale-select">한국어</a></li>
                
                  
                    
                  
                <li><a href="/cn/" data-value="/cn/" id="locale-select">简体中文</a></li>
                
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <div class="navbar-brand hidden-xs" id="elastic">
        <h1>
          <a class="hidden-xs" id="elastic-logo" href="/">
            <img src="https://static-www.elastic.co/assets/blt6050efb80ceabd47/elastic-logo (2).svg?q=350" alt="elastic-logo">
          </a>
        </h1>
      </div>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse mobile-inner-nav">
      <nav class="nav navbar-nav primary-nav-hover" id="nav">
        <ul>
        
          
            
              
            
            <li>
              <a id="nav_products" class=" " href="/products">Products</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_cloud" class=" " href="/cloud">Cloud</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_services" class=" " href="/services">Services</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_customers" class=" " href="/use-cases">Customers</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_learn" class=" " href="/learn">Learn</a>
            </li>
          
        
          
        
        </ul>
      </nav>
      <nav class="nav navbar-nav navbar-right hidden-xs">
        <ul>
          <li class="hidden-xs hidden-sm"><a href="/downloads">downloads</a></li>
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li>
          <!-- To set parameters to contact button -->
          
           
            
          

          
            
            
          
          <li class="hidden-xs hidden-sm"><a class="btn btn-secondary btn-contact" href="/contact?storm=global-header-en">contact</a></li>
          <!-- ////////////////ends here///////////////-->          
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact?storm=global-header-en"></a></li>
          <li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li>
          <li class="hidden-xs lang global-language">
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
               <ul class="language-list">
              
                
                  
                
              <li><a class="" href="/" data-value="/">English</a></li>
              
                
                  
                
              <li><a class="" href="/fr/" data-value="/fr/">Français</a></li>
              
                
                  
                
              <li><a class="" href="/de/" data-value="/de/">Deutsch</a></li>
              
                
                  
                
              <li><a class="" href="/jp/" data-value="/jp/">日本語</a></li>
              
                
                  
                
              <li><a class="" href="/kr/" data-value="/kr/">한국어</a></li>
              
                
                  
                
              <li><a class="" href="/cn/" data-value="/cn/">简体中文</a></li>
              
            </ul>
          </li>
        </ul>
      </nav>
    </div><!-- /.navbar-collapse -->
  </nav>
  </div>
</div>

<div class="header-search-wrapper open-search"> 
  <div class="container">
    <div class="big-search">
      <i class="big-search-icon"></i>
      <form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get">
        <ul class="tags-wrapper">
          <li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li>
        </ul>
      </form>
      <a class="header-search-cancel" href="#"></a>
    </div>
    <div class="nav-auto-complete"></div>
  </div>
</div>
</header>
<link rel="stylesheet" type="text/css" href="https://static-www.elastic.co/static/css/horizon-swiper.min.css?q=350">
<style> 
    
      .m-shortcuts li a.m-search {
        background: url("https://static-www.elastic.co/assets/blt7b9c4fe6528dc4ef/m-search-icon.png?q=350") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("https://static-www.elastic.co/assets/blt44d8b7530a76d01c/m-guide-icon.png?q=350") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("https://static-www.elastic.co/assets/blt878040795c9d083b/m-contact-icon.png?q=350") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
    
</style>
<script type="text/javascript" src="https://static-www.elastic.co/static/js/horizon-swiper.min.js?q=350"></script>
<script type="text/javascript">
  $(document).ready( function(){
    // if($('#scrollable-pane li').length > 3){
      $('.horizon-swiper').horizonSwiper({
        showItems: 3,
        arrows: true
      }); 
    // }
    
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
    });

    var active_url = "";

    $(".navbar-mobile-header-icon").click(function(index){
      $('.navigation-wrapper').toggleClass('menu-overlay');
      $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
      $(".mobile-inner-nav").slideToggle(500);
      $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
        $(this).css({'animation-delay': (index/25)+'0.4s'});
      });
    });

    $('.dropdown-btn').on('click', function(e){
      e.preventDefault();
      setDropdown();
    });
    
    function setDropdown() {
      $('#myDropdown').slideToggle();
    }

    $('body').on('click', function(event){
      if (!event.target.matches('.dropdown-btn')) {

        var dropdowns = $(".dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    });

    // if($(window).width() < 769){
    //   var $item = $('.scrollable-panel li'), 
    //       visible = 3, //Set the number of items that will be visible
    //       index = 0, //Starting index
    //       endIndex = ( $item.length / visible ) - 1; //End index (NOTE:: Requires visible to be a factor of $item.length... You can improve this by rounding...)

    //   $('#right-arrow').click(function(){
    //     if(index < endIndex ){
    //       index++;
    //       $item.animate({'left':'-=300px'});
    //     }
    //   });

    //   $('#left-arrow').click(function(){
    //     if(index > 0){
    //       index--;            
    //       $item.animate({'left':'+=300px'});
    //     }
    //   });
    // }
  });
  $(window).resize(function () {
    $('.horizon-swiper').horizonSwiper({
      showItems: 3,
      arrows: true
    });
  });
</script>
    
      


  





  
  
  
  
    <div class="tertiary-nav">
      <div class="container">
        <div class="p-t-b-15 bdr-btm-e0e0e0 clearfix">
          <div class="breadcrum-wrapper pull-left text-left">
          
            <a href="/guide">Docs</a> 
          
          </div>
          
          
          
        </div>
      </div>
    </div>

    <div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg bdr-btm-e0e0e0 clearfix">
      <div class="container text-right">
        <div class="breadcrum-wrapper pull-left text-left">
          
              <a href="/guide">Docs</a>
          
        </div>
        
        
      </div>
    </div>
  


<style type="text/css">

  
</style>
    
    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   
          
            
        			<!-- <div class="pageheader">
	<div class="common-container">
		
			<h2 class="page-title">Guide template</h2>
		
	</div>
</div> -->


        		
          

          
	<section id="guide" lang="en">
		<div class="container">
			<div class="row">
			  <!-- start body -->
				
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [6.0]
    </a></span> » <span class="breadcrumb-link"><a href="docs.html">Document APIs</a></span> » <span class="breadcrumb-node">Reindex API</span></div><div class="navheader"><span class="prev"><a href="docs-bulk.html">
              « 
              Bulk API</a>
           
        </span><span class="next">
           
          <a href="docs-termvectors.html">Term Vectors
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="docs-reindex"></a>Reindex API<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Reindex does not attempt to set up the destination index.  It does
not copy the settings of the source index.  You should set up the destination
index prior to running a <code class="literal">_reindex</code> action, including setting up mappings, shard
counts, replicas, etc.</p></div></div><p>The most basic form of <code class="literal">_reindex</code> just copies documents from one index to another.
This will copy documents from the <code class="literal">twitter</code> index into the <code class="literal">new_twitter</code> index:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/1.json"></div><p>That will return something like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "took" : 147,
  "timed_out": false,
  "created": 120,
  "updated": 0,
  "deleted": 0,
  "batches": 1,
  "version_conflicts": 0,
  "noops": 0,
  "retries": {
    "bulk": 0,
    "search": 0
  },
  "throttled_millis": 0,
  "requests_per_second": -1.0,
  "throttled_until_millis": 0,
  "total": 120,
  "failures" : [ ]
}</pre></div><p>Just like <a class="link" href="docs-update-by-query.html" title="Update By Query API"><code class="literal">_update_by_query</code></a>, <code class="literal">_reindex</code> gets a
snapshot of the source index but its target must be a <span class="strong strong"><strong>different</strong></span> index so
version conflicts are unlikely. The <code class="literal">dest</code> element can be configured like the
index API to control optimistic concurrency control. Just leaving out
<code class="literal">version_type</code> (as above) or setting it to <code class="literal">internal</code> will cause Elasticsearch
to blindly dump documents into the target, overwriting any that happen to have
the same type and id:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
    "version_type": "internal"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/2.json"></div><p>Setting <code class="literal">version_type</code> to <code class="literal">external</code> will cause Elasticsearch to preserve the
<code class="literal">version</code> from the source, create any documents that are missing, and update
any documents that have an older version in the destination index than they do
in the source index:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
    "version_type": "external"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/3.json"></div><p>Settings <code class="literal">op_type</code> to <code class="literal">create</code> will cause <code class="literal">_reindex</code> to only create missing
documents in the target index. All existing documents will cause a version
conflict:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
    "op_type": "create"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/4.json"></div><p>By default version conflicts abort the <code class="literal">_reindex</code> process but you can just
count them by settings <code class="literal">"conflicts": "proceed"</code> in the request body:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "conflicts": "proceed",
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
    "op_type": "create"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/5.json"></div><p>You can limit the documents by adding a type to the <code class="literal">source</code> or by adding a
query. This will only copy <code class="literal">tweet</code>'s made by <code class="literal">kimchy</code> into <code class="literal">new_twitter</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "twitter",
    "type": "tweet",
    "query": {
      "term": {
        "user": "kimchy"
      }
    }
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/6.json"></div><p><code class="literal">index</code> and <code class="literal">type</code> in <code class="literal">source</code> can both be lists, allowing you to copy from
lots of sources in one request. This will copy documents from the <code class="literal">tweet</code> and
<code class="literal">post</code> types in the <code class="literal">twitter</code> and <code class="literal">blog</code> index. It’d include the <code class="literal">post</code> type in
the <code class="literal">twitter</code> index and the <code class="literal">tweet</code> type in the <code class="literal">blog</code> index. If you want to be
more specific you’ll need to use the <code class="literal">query</code>. It also makes no effort to handle
ID collisions. The target index will remain valid but it’s not easy to predict
which document will survive because the iteration order isn’t well defined.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": ["twitter", "blog"],
    "type": ["tweet", "post"]
  },
  "dest": {
    "index": "all_together"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/7.json"></div><p>It’s also possible to limit the number of processed documents by setting
<code class="literal">size</code>. This will only copy a single document from <code class="literal">twitter</code> to
<code class="literal">new_twitter</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "size": 1,
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/8.json"></div><p>If you want a particular set of documents from the twitter index you’ll
need to sort. Sorting makes the scroll less efficient but in some contexts
it’s worth it. If possible, prefer a more selective query to <code class="literal">size</code> and <code class="literal">sort</code>.
This will copy 10000 documents from <code class="literal">twitter</code> into <code class="literal">new_twitter</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "size": 10000,
  "source": {
    "index": "twitter",
    "sort": { "date": "desc" }
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/9.json"></div><p>The <code class="literal">source</code> section supports all the elements that are supported in a
<a class="link" href="search-request-body.html" title="Request Body Search">search request</a>. For instance only a subset of the
fields from the original documents can be reindexed using source filtering
as follows:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "twitter",
    "_source": ["user", "tweet"]
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/10.json"></div><p>Like <code class="literal">_update_by_query</code>, <code class="literal">_reindex</code> supports a script that modifies the
document. Unlike <code class="literal">_update_by_query</code>, the script is allowed to modify the
document’s metadata. This example bumps the version of the source document:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
    "version_type": "external"
  },
  "script": {
    "source": "if (ctx._source.foo == 'bar') {ctx._version++; ctx._source.remove('foo')}",
    "lang": "painless"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/11.json"></div><p>Just as in <code class="literal">_update_by_query</code>, you can set <code class="literal">ctx.op</code> to change the
operation that is executed on the destination index:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">noop</code>
</span></dt><dd>
Set <code class="literal">ctx.op = "noop"</code> if your script decides that the document doesn’t have
to be indexed in the destination index. This no operation will be reported
in the <code class="literal">noop</code> counter in the <a class="link" href="docs-reindex.html#docs-reindex-response-body" title="Response bodyedit">response body</a>.
</dd><dt><span class="term">
<code class="literal">delete</code>
</span></dt><dd>
Set <code class="literal">ctx.op = "delete"</code> if your script decides that the document must be
 deleted from the destination index. The deletion will be reported in the
 <code class="literal">deleted</code> counter in the <a class="link" href="docs-reindex.html#docs-reindex-response-body" title="Response bodyedit">response body</a>.
</dd></dl></div><p>Setting <code class="literal">ctx.op</code> to anything else is an error. Setting any
other field in <code class="literal">ctx</code> is an error.</p><p>Think of the possibilities! Just be careful! With great power…. You can
change:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">_id</code>
</li><li class="listitem">
<code class="literal">_type</code>
</li><li class="listitem">
<code class="literal">_index</code>
</li><li class="listitem">
<code class="literal">_version</code>
</li><li class="listitem">
<code class="literal">_routing</code>
</li></ul></div><p>Setting <code class="literal">_version</code> to <code class="literal">null</code> or clearing it from the <code class="literal">ctx</code> map is just like not
sending the version in an indexing request. It will cause that document to be
overwritten in the target index regardless of the version on the target or the
version type you use in the <code class="literal">_reindex</code> request.</p><p>By default if <code class="literal">_reindex</code> sees a document with routing then the routing is
preserved unless it’s changed by the script. You can set <code class="literal">routing</code> on the
<code class="literal">dest</code> request to change this:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">keep</code>
</span></dt><dd>
Sets the routing on the bulk request sent for each match to the routing on
the match. The default.
</dd><dt><span class="term">
<code class="literal">discard</code>
</span></dt><dd>
Sets the routing on the bulk request sent for each match to null.
</dd><dt><span class="term">
<code class="literal">=&lt;some text&gt;</code>
</span></dt><dd>
Sets the routing on the bulk request sent for each match to all text after
the <code class="literal">=</code>.
</dd></dl></div><p>For example, you can use the following request to copy all documents from
the <code class="literal">source</code> index with the company name <code class="literal">cat</code> into the <code class="literal">dest</code> index with
routing set to <code class="literal">cat</code>.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "source",
    "query": {
      "match": {
        "company": "cat"
      }
    }
  },
  "dest": {
    "index": "dest",
    "routing": "=cat"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/12.json"></div><p>By default <code class="literal">_reindex</code> uses scroll batches of 1000. You can change the
batch size with the <code class="literal">size</code> field in the <code class="literal">source</code> element:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "source",
    "size": 100
  },
  "dest": {
    "index": "dest",
    "routing": "=cat"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/13.json"></div><p>Reindex can also use the <a class="xref" href="ingest.html" title="Ingest Node">Ingest Node</a> feature by specifying a
<code class="literal">pipeline</code> like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "source"
  },
  "dest": {
    "index": "dest",
    "pipeline": "some_ingest_pipeline"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/14.json"></div><h3><a id="reindex-from-remote"></a>Reindex from Remote<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Reindex supports reindexing from a remote Elasticsearch cluster:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "remote": {
      "host": "http://otherhost:9200",
      "username": "user",
      "password": "pass"
    },
    "index": "source",
    "query": {
      "match": {
        "test": "data"
      }
    }
  },
  "dest": {
    "index": "dest"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/15.json"></div><p>The <code class="literal">host</code> parameter must contain a scheme, host, and port (e.g.
<code class="literal">https://otherhost:9200</code>). The <code class="literal">username</code> and <code class="literal">password</code> parameters are
optional and when they are present reindex will connect to the remote
Elasticsearch node using basic auth. Be sure to use <code class="literal">https</code> when using
basic auth or the password will be sent in plain text.</p><p>Remote hosts have to be explicitly whitelisted in elasticsearch.yaml using the
<code class="literal">reindex.remote.whitelist</code> property. It can be set to a comma delimited list
of allowed remote <code class="literal">host</code> and <code class="literal">port</code> combinations (e.g.
<code class="literal">otherhost:9200, another:9200, 127.0.10.*:9200, localhost:*</code>). Scheme is
ignored by the whitelist - only host and port are used.</p><p>This feature should work with remote clusters of any version of Elasticsearch
you are likely to find. This should allow you to upgrade from any version of
Elasticsearch to the current version by reindexing from a cluster of the old
version.</p><p>To enable queries sent to older versions of Elasticsearch the <code class="literal">query</code> parameter
is sent directly to the remote host without validation or modification.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Reindexing from remote clusters does not support
<a class="link" href="docs-reindex.html#docs-reindex-manual-slice" title="Manual slicingedit">manual</a> or
<a class="link" href="docs-reindex.html#docs-reindex-automatic-slice" title="Automatic slicingedit">automatic slicing</a>.</p></div></div><p>Reindexing from a remote server uses an on-heap buffer that defaults to a
maximum size of 100mb. If the remote index includes very large documents you’ll
need to use a smaller batch size. The example below sets the batch size <code class="literal">10</code>
which is very, very small.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "remote": {
      "host": "http://otherhost:9200"
    },
    "index": "source",
    "size": 10,
    "query": {
      "match": {
        "test": "data"
      }
    }
  },
  "dest": {
    "index": "dest"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/16.json"></div><p>It is also possible to set the socket read timeout on the remote connection
with the <code class="literal">socket_timeout</code> field and the connection timeout with the
<code class="literal">connect_timeout</code> field. Both default to thirty seconds. This example
sets the socket read timeout to one minute and the connection timeout to ten
seconds:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "remote": {
      "host": "http://otherhost:9200",
      "socket_timeout": "1m",
      "connect_timeout": "10s"
    },
    "index": "source",
    "query": {
      "match": {
        "test": "data"
      }
    }
  },
  "dest": {
    "index": "dest"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/17.json"></div><h3><a id="_url_parameters_3"></a>URL Parameters<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>In addition to the standard parameters like <code class="literal">pretty</code>, the Reindex API also
supports <code class="literal">refresh</code>, <code class="literal">wait_for_completion</code>, <code class="literal">wait_for_active_shards</code>, <code class="literal">timeout</code>, and
<code class="literal">requests_per_second</code>.</p><p>Sending the <code class="literal">refresh</code> url parameter will cause all indexes to which the request
wrote to be refreshed. This is different than the Index API’s <code class="literal">refresh</code>
parameter which causes just the shard that received the new data to be refreshed.</p><p>If the request contains <code class="literal">wait_for_completion=false</code> then Elasticsearch will
perform some preflight checks, launch the request, and then return a <code class="literal">task</code>
which can be used with <a class="link" href="docs-reindex.html#docs-reindex-task-api" title="Works with the Task APIedit">Tasks APIs</a>
to cancel or get the status of the task. Elasticsearch will also create a
record of this task as a document at <code class="literal">.tasks/task/${taskId}</code>. This is yours
to keep or remove as you see fit. When you are done with it, delete it so
Elasticsearch can reclaim the space it uses.</p><p><code class="literal">wait_for_active_shards</code> controls how many copies of a shard must be active
before proceeding with the reindexing. See <a class="link" href="docs-index_.html#index-wait-for-active-shards" title="Wait For Active Shardsedit">here</a>
for details. <code class="literal">timeout</code> controls how long each write request waits for unavailable
shards to become available. Both work exactly how they work in the
<a class="link" href="docs-bulk.html" title="Bulk API">Bulk API</a>.</p><p><code class="literal">requests_per_second</code> can be set to any positive decimal number (<code class="literal">1.4</code>, <code class="literal">6</code>,
<code class="literal">1000</code>, etc) and throttles rate at which reindex issues batches of index
operations by padding each batch with a wait time. The throttling can be
disabled by setting <code class="literal">requests_per_second</code> to <code class="literal">-1</code>.</p><p>The throttling is done by waiting between batches so that scroll that reindex
uses internally can be given a timeout that takes into account the padding.
The padding time is the difference between the batch size divided by the
<code class="literal">requests_per_second</code> and the time spent writing. By default the batch size is
<code class="literal">1000</code>, so if the <code class="literal">requests_per_second</code> is set to <code class="literal">500</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-txt">target_time = 1000 / 500 per second = 2 seconds
wait_time = target_time - write_time = 2 seconds - .5 seconds = 1.5 seconds</pre></div><p>Since the batch is issued as a single <code class="literal">_bulk</code> request large batch sizes will
cause Elasticsearch to create many requests and then wait for a while before
starting the next set. This is "bursty" instead of "smooth". The default is <code class="literal">-1</code>.</p><h3><a id="docs-reindex-response-body"></a>Response body<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The JSON response looks like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "took": 639,
  "timed_out": false,
  "total": 5,
  "updated": 0,
  "created": 5,
  "deleted": 0,
  "batches": 1,
  "noops": 0,
  "version_conflicts": 2,
  "retries": {
    "bulk": 0,
    "search": 0
  },
  "throttled_millis": 0,
  "requests_per_second": 1,
  "throttled_until_millis": 0,
  "failures": [ ]
}</pre></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">took</code>
</span></dt><dd>
The number of milliseconds from start to end of the whole operation.
</dd><dt><span class="term">
<code class="literal">timed_out</code>
</span></dt><dd>
This flag is set to <code class="literal">true</code> if any of the requests executed during the
reindex has timed out.
</dd><dt><span class="term">
<code class="literal">total</code>
</span></dt><dd>
The number of documents that were successfully processed.
</dd><dt><span class="term">
<code class="literal">updated</code>
</span></dt><dd>
The number of documents that were successfully updated.
</dd><dt><span class="term">
<code class="literal">created</code>
</span></dt><dd>
The number of documents that were successfully created.
</dd><dt><span class="term">
<code class="literal">deleted</code>
</span></dt><dd>
The number of documents that were successfully deleted.
</dd><dt><span class="term">
<code class="literal">batches</code>
</span></dt><dd>
The number of scroll responses pulled back by the reindex.
</dd><dt><span class="term">
<code class="literal">noops</code>
</span></dt><dd>
The number of documents that were ignored because the script used for
the reindex returned a <code class="literal">noop</code> value for <code class="literal">ctx.op</code>.
</dd><dt><span class="term">
<code class="literal">version_conflicts</code>
</span></dt><dd>
The number of version conflicts that reindex hit.
</dd><dt><span class="term">
<code class="literal">retries</code>
</span></dt><dd>
The number of retries attempted by reindex. <code class="literal">bulk</code> is the number of bulk
actions retried and <code class="literal">search</code> is the number of search actions retried.
</dd><dt><span class="term">
<code class="literal">throttled_millis</code>
</span></dt><dd>
Number of milliseconds the request slept to conform to <code class="literal">requests_per_second</code>.
</dd><dt><span class="term">
<code class="literal">requests_per_second</code>
</span></dt><dd>
The number of requests per second effectively executed during the reindex.
</dd><dt><span class="term">
<code class="literal">throttled_until_millis</code>
</span></dt><dd>
This field should always be equal to zero in a delete by query response. It only
has meaning when using the <a class="link" href="docs-reindex.html#docs-reindex-task-api" title="Works with the Task APIedit">Task API</a>, where it
indicates the next time (in milliseconds since epoch) a throttled request will be
executed again in order to conform to <code class="literal">requests_per_second</code>.
</dd><dt><span class="term">
<code class="literal">failures</code>
</span></dt><dd>
Array of all indexing failures. If this is non-empty then the request aborted
because of those failures. See <code class="literal">conflicts</code> for how to prevent version conflicts
from aborting the operation.
</dd></dl></div><h3><a id="docs-reindex-task-api"></a>Works with the Task API<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can fetch the status of all running reindex requests with the
<a class="link" href="tasks.html" title="Task Management API">Task API</a>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET _tasks?detailed=true&amp;actions=*reindex</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/18.json"></div><p>The responses looks like:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "nodes" : {
    "r1A2WoRbTwKZ516z6NEs5A" : {
      "name" : "r1A2WoR",
      "transport_address" : "127.0.0.1:9300",
      "host" : "127.0.0.1",
      "ip" : "127.0.0.1:9300",
      "attributes" : {
        "testattr" : "test",
        "portsfile" : "true"
      },
      "tasks" : {
        "r1A2WoRbTwKZ516z6NEs5A:36619" : {
          "node" : "r1A2WoRbTwKZ516z6NEs5A",
          "id" : 36619,
          "type" : "transport",
          "action" : "indices:data/write/reindex",
          "status" : {    <a id="CO23-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
            "total" : 6154,
            "updated" : 3500,
            "created" : 0,
            "deleted" : 0,
            "batches" : 4,
            "version_conflicts" : 0,
            "noops" : 0,
            "retries": {
              "bulk": 0,
              "search": 0
            },
            "throttled_millis": 0
          },
          "description" : ""
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO23-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
this object contains the actual status. It is just like the response json
with the important addition of the <code class="literal">total</code> field. <code class="literal">total</code> is the total number
of operations that the reindex expects to perform. You can estimate the
progress by adding the <code class="literal">updated</code>, <code class="literal">created</code>, and <code class="literal">deleted</code> fields. The request
will finish when their sum is equal to the <code class="literal">total</code> field.
</p></td></tr></table></div><p>With the task id you can look up the task directly:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_tasks/taskId:1</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/19.json"></div><p>The advantage of this API is that it integrates with <code class="literal">wait_for_completion=false</code>
to transparently return the status of completed tasks. If the task is completed
and <code class="literal">wait_for_completion=false</code> was set on it them it’ll come back with a
<code class="literal">results</code> or an <code class="literal">error</code> field. The cost of this feature is the document that
<code class="literal">wait_for_completion=false</code> creates at <code class="literal">.tasks/task/${taskId}</code>. It is up to
you to delete that document.</p><h3><a id="docs-reindex-cancel-task-api"></a>Works with the Cancel Task API<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Any Reindex can be canceled using the <a class="link" href="tasks.html" title="Task Management API">Task Cancel API</a>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _tasks/task_id:1/_cancel</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/20.json"></div><p>The <code class="literal">task_id</code> can be found using the tasks API above.</p><p>Cancelation should happen quickly but might take a few seconds. The task status
API above will continue to list the task until it is wakes to cancel itself.</p><h3><a id="docs-reindex-rethrottle"></a>Rethrottling<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The value of <code class="literal">requests_per_second</code> can be changed on a running reindex using
the <code class="literal">_rethrottle</code> API:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex/task_id:1/_rethrottle?requests_per_second=-1</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/21.json"></div><p>The <code class="literal">task_id</code> can be found using the tasks API above.</p><p>Just like when setting it on the <code class="literal">_reindex</code> API <code class="literal">requests_per_second</code>
can be either <code class="literal">-1</code> to disable throttling or any decimal number
like <code class="literal">1.7</code> or <code class="literal">12</code> to throttle to that level. Rethrottling that speeds up the
query takes effect immediately but rethrotting that slows down the query will
take effect on after completing the current batch. This prevents scroll
timeouts.</p><h3><a id="docs-reindex-change-name"></a>Reindex to change the name of a field<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p><code class="literal">_reindex</code> can be used to build a copy of an index with renamed fields. Say you
create an index containing documents that look like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST test/test/1?refresh
{
  "text": "words words",
  "flag": "foo"
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/22.json"></div><p>But you don’t like the name <code class="literal">flag</code> and want to replace it with <code class="literal">tag</code>.
<code class="literal">_reindex</code> can create the other index for you:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "test"
  },
  "dest": {
    "index": "test2"
  },
  "script": {
    "source": "ctx._source.tag = ctx._source.remove(\"flag\")"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/23.json"></div><p>Now you can get the new document:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET test2/test/1</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/24.json"></div><p>and it’ll look like:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "found": true,
  "_id": "1",
  "_index": "test2",
  "_type": "test",
  "_version": 1,
  "_source": {
    "text": "words words",
    "tag": "foo"
  }
}</pre></div><p>Or you can search by <code class="literal">tag</code> or whatever you want.</p><h4><a id="docs-reindex-manual-slice"></a>Manual slicing<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Reindex supports <a class="xref" href="search-request-scroll.html#sliced-scroll" title="Sliced Scroll">Sliced Scroll</a>, allowing you to manually parallelize the
process relatively easily:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "twitter",
    "slice": {
      "id": 0,
      "max": 2
    }
  },
  "dest": {
    "index": "new_twitter"
  }
}
POST _reindex
{
  "source": {
    "index": "twitter",
    "slice": {
      "id": 1,
      "max": 2
    }
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/25.json"></div><p>Which you can verify works with:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET _refresh
POST new_twitter/_search?size=0&amp;filter_path=hits.total</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/26.json"></div><p>Which results in a sensible <code class="literal">total</code> like this one:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "hits": {
    "total": 120
  }
}</pre></div><h3><a id="docs-reindex-automatic-slice"></a>Automatic slicing<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can also let reindex automatically parallelize using <a class="xref" href="search-request-scroll.html#sliced-scroll" title="Sliced Scroll">Sliced Scroll</a> to
slice on <code class="literal">_uid</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex?slices=5&amp;refresh
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/27.json"></div><p>Which you also can verify works with:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST new_twitter/_search?size=0&amp;filter_path=hits.total</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/28.json"></div><p>Which results in a sensible <code class="literal">total</code> like this one:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
  "hits": {
    "total": 120
  }
}</pre></div><p>Adding <code class="literal">slices</code> to <code class="literal">_reindex</code> just automates the manual process used in the
section above, creating sub-requests which means it has some quirks:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
You can see these requests in the <a class="link" href="docs-reindex.html#docs-reindex-task-api" title="Works with the Task APIedit">Tasks APIs</a>. These
sub-requests are "child" tasks of the task for the request with <code class="literal">slices</code>.
</li><li class="listitem">
Fetching the status of the task for the request with <code class="literal">slices</code> only contains
the status of completed slices.
</li><li class="listitem">
These sub-requests are individually addressable for things like cancellation
and rethrottling.
</li><li class="listitem">
Rethrottling the request with <code class="literal">slices</code> will rethrottle the unfinished
sub-request proportionally.
</li><li class="listitem">
Canceling the request with <code class="literal">slices</code> will cancel each sub-request.
</li><li class="listitem">
Due to the nature of <code class="literal">slices</code> each sub-request won’t get a perfectly even
portion of the documents. All documents will be addressed, but some slices may
be larger than others. Expect larger slices to have a more even distribution.
</li><li class="listitem">
Parameters like <code class="literal">requests_per_second</code> and <code class="literal">size</code> on a request with <code class="literal">slices</code>
are distributed proportionally to each sub-request. Combine that with the point
above about distribution being uneven and you should conclude that the using
<code class="literal">size</code> with <code class="literal">slices</code> might not result in exactly <code class="literal">size</code> documents being
`_reindex`ed.
</li><li class="listitem">
Each sub-requests gets a slightly different snapshot of the source index
though these are all taken at approximately the same time.
</li></ul></div><h3><a id="docs-reindex-picking-slices"></a>Picking the number of slices<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>At this point we have a few recommendations around the number of <code class="literal">slices</code> to
use (the <code class="literal">max</code> parameter in the slice API if manually parallelizing):</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Don’t use large numbers. <code class="literal">500</code> creates fairly massive CPU thrash.
</li><li class="listitem">
It is more efficient from a query performance standpoint to use some multiple
of the number of shards in the source index.
</li><li class="listitem">
Using exactly as many shards as are in the source index is the most efficient
from a query performance standpoint.
</li><li class="listitem">
Indexing performance should scale linearly across available resources with
the number of <code class="literal">slices</code>.
</li><li class="listitem">
Whether indexing or query performance dominates that process depends on lots
of factors like the documents being reindexed and the cluster doing the
reindexing.
</li></ul></div><h3><a id="_reindex_daily_indices"></a>Reindex daily indices<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can use <code class="literal">_reindex</code> in combination with <a class="link" href="modules-scripting-painless.html" title="Painless Scripting Language">Painless</a>
 to reindex daily indices to apply a new template to the existing documents.</p><p>Assuming you have indices consisting of documents as following:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT metricbeat-2016.05.30/beat/1?refresh
{"system.cpu.idle.pct": 0.908}
PUT metricbeat-2016.05.31/beat/1?refresh
{"system.cpu.idle.pct": 0.105}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/29.json"></div><p>The new template for the <code class="literal">metricbeat-*</code> indices is already loaded into elasticsearch
but it applies only to the newly created indices. Painless can be used to reindex
the existing documents and apply the new template.</p><p>The script below extracts the date from the index name and creates a new index
with <code class="literal">-1</code> appended. All data from <code class="literal">metricbeat-2016.05.31</code> will be reindex
into <code class="literal">metricbeat-2016.05.31-1</code>.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "source": {
    "index": "metricbeat-*"
  },
  "dest": {
    "index": "metricbeat"
  },
  "script": {
    "lang": "painless",
    "source": "ctx._index = 'metricbeat-' + (ctx._index.substring('metricbeat-'.length(), ctx._index.length())) + '-1'"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/30.json"></div><p>All documents from the previous metricbeat indices now can be found in the <code class="literal">*-1</code> indices.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET metricbeat-2016.05.30-1/beat/1
GET metricbeat-2016.05.31-1/beat/1</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/31.json"></div><p>The previous method can also be used in combination with <a class="link" href="docs-reindex.html#docs-reindex-change-name" title="Reindex to change the name of a fieldedit">change the name of a field</a>
to only load the existing data into the new index, but also rename fields if needed.</p><h3><a id="_extracting_a_random_subset_of_an_index"></a>Extracting a random subset of an index<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/docs/reindex.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Reindex can be used to extract a random subset of an index for testing:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _reindex
{
  "size": 10,
  "source": {
    "index": "twitter",
    "query": {
      "function_score" : {
        "query" : { "match_all": {} },
        "random_score" : {}
      }
    },
    "sort": "_score"    <a id="CO24-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
  },
  "dest": {
    "index": "random_twitter"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/docs-reindex/32.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO24-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Reindex defaults to sorting by <code class="literal">_doc</code> so <code class="literal">random_score</code> won’t have any
effect unless you override the sort to <code class="literal">_score</code>.
</p></td></tr></table></div></div><div class="navfooter"><span class="prev"><a href="docs-bulk.html">
              « 
              Bulk API</a>
           
        </span><span class="next">
           
          <a href="docs-termvectors.html">Term Vectors
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
					<div id="rtpcontainer" style="display: block;">
						<div class="mktg-promo">
						<h3>Getting Started Videos</h3>
						<ul class="icons">
							<li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Elasticsearch Demo</a></li>
							<li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Kibana 101</a></li>
							<li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Primer</a></li>
						</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

        </div>
      	


<div id="footer-subscribe" class="home-footer-subscribe">
  <div class="subscribe-wrapper">
    <div class="container">
      <div class="subscribe-form-container">
        <div class="subscribe-title col-md-12 col-lg-6">
            <h5>Be in the know with the latest and greatest from Elastic.</h5>
        </div>
        <div class="subscribe-form col-md-12 col-lg-6">
          <form id="mktoForm_1398" class="mktoForm sb-form"></form>
        </div>
      </div>
      <div class="form_thanks hide">
        
          <p>Thanks for subscribing! We'll keep you updated with new releases.</p>
        
      </div>
    </div>
  </div>
</div>
<!--subscribe newsletter end-->

<!-- Footer Section -->
<footer class="footer-wrapper">
  <div class="container">
    <div class="row footer-content">
        
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/products">Products ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/products/elasticsearch">Elasticsearch</a></li>
                  
                
              
                
                  
                    <li><a href="/products/kibana">Kibana</a></li>
                  
                
              
                
                  
                    <li><a href="/products/beats">Beats</a></li>
                  
                
              
                
                  
                    <li><a href="/products/logstash">Logstash</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack">X-Pack</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud/as-a-service">Elastic Cloud</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud/enterprise">Elastic Cloud Enterprise</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/security">Security (formerly Shield)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/alerting">Alerting (via Watcher)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/monitoring">Monitoring (formerly Marvel)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/graph">Graph</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/reporting">Reporting</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/machine-learning">Machine Learning</a></li>
                  
                
              
                
                  
                    <li><a href="/products/hadoop">ES-Hadoop</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/solutions">Solutions ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/solutions/app-search">App Search</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/site-search">Site Search</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/logging">Logging</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/metrics">Metrics</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/security-analytics">Security Analytics</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3>Resources</h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/blog">Blog</a></li>
                  
                
              
                
                  
                    <li><a href="https://cloud-status.elastic.co">Cloud Status</a></li>
                  
                
              
                
                  
                    <li><a href="/community">Community</a></li>
                  
                
              
                
                  
                    <li><a href="/use-cases">Customers & Use Cases</a></li>
                  
                
              
                
                  
                    <li><a href="/guide">Documentation</a></li>
                  
                
              
                
                  
                    <li><a href="/elasticon">Elastic{ON} Events</a></li>
                  
                
              
                
                  
                    <li><a href="https://discuss.elastic.co/">Forums</a></li>
                  
                
              
                
                  
                    <li><a href="/community/meetups">Meetups</a></li>
                  
                
              
                
                  
                    <li><a href="/subscriptions">Subscriptions</a></li>
                  
                
              
                
                  
                    <li><a href="https://support.elastic.co">Support Portal</a></li>
                  
                
              
                
                  
                    <li><a href="/videos">Videos & Webinars</a></li>
                  
                
              
                
                  
                    <li><a href="/training">Training</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/about">About ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/about/careers">Careers/Jobs</a></li>
                  
                
              
                
                  
                    <li><a href="/contact">Contact</a></li>
                  
                
              
                
                  
                    <li><a href="/about/leadership">Leadership</a></li>
                  
                
              
                
                  
                    <li><a href="/about/partners">Partners</a></li>
                  
                
              
                
                  
                    <li><a href="/about/press">Press</a></li>
                  
                
              
                
                  
                    <li><a href="https://www.elastic.shop">Elastic Store</a></li>
                  
                
              
              </ul>
          </div>    
       
    </div>
     <!-- Social Media Section -->
    <div class="row social-icon">
      <div class="col-xs-12 col-sm-12 col-md-12">
        <p class="text-center font-size-10 m-0">FOLLOW US</p>
        <ul>
          
          <li class="facebook"><a id="footer_facebook" href="http://www.facebook.com/elastic.co"></a></li>
          
          <li class="twitter"><a id="footer_twitter" href="https://www.twitter.com/elastic"></a></li>
          
          <li class="linkedin"><a id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co"></a></li>
          
          <li class="xing"><a id="footer_xing" href="https://www.xing.com/companies/elastic.co"></a></li>
          
          <li class="youtube"><a id="footer_youtube" href="https://www.youtube.com/user/elasticsearch"></a></li>
          
        </ul>
      </div>
    </div>
    <!-- Social Media Section end-->
    <div class="row">
	<div class="col-xs-12 col-sm-12 col-md-12">
		<div class="copyright">
			<ul>
				<li><a href="/legal/trademarks">Trademarks</a></li>
				<li><a href="/legal/terms-of-use">Terms of Use</a></li>
				<li><a href="/legal/privacy-policy">Privacy</a></li>
				<li><a href="/legal/privacy-and-cookie-policy">Cookie Policy</a></li>
				<li><a href="/brand">Brand</a></li>
			</ul>
			<div class="copyright-content">
				<div class="footer-logo"><a href="/"><img src="/static/images/svg/logo-elastic-footer.svg" class="img-responsive"></a>
				</div>
				<div class="footer-text">
					<p>© 2017. All Rights Reserved - Elasticsearch
					</p>
					<p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries.
					</p>
					<p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.
					</p>
				</div>
			</div>
		</div>
	</div>
</div>
  </div>
</footer>
<!-- Footer Section end-->

<style type="text/css">
	
    
		.facebook{background:url("https://static-www.elastic.co/assets/bltf546ff2e0a8f2de5/facebook.svg?q=350") no-repeat;}
    
    
      .facebook:hover {background:url("https://static-www.elastic.co/assets/bltc24cf11c714ecfc4/facebook-hover.svg?q=350")}		
    
	
    
		.twitter{background:url("https://static-www.elastic.co/assets/bltdd9556d6b24e2b85/twitter.svg?q=350") no-repeat;}
    
    
      .twitter:hover {background:url("https://static-www.elastic.co/assets/blt90b0372cc07a54d3/twitter-hover.svg?q=350")}		
    
	
    
		.linkedin{background:url("https://static-www.elastic.co/assets/bltc4a77e0f52ce07f1/linkedin.svg?q=350") no-repeat;}
    
    
      .linkedin:hover {background:url("https://static-www.elastic.co/assets/blt01ce654380e4ea6c/linkedin-hover.svg?q=350")}		
    
	
    
		.xing{background:url("https://static-www.elastic.co/assets/bltc6347078dcc9ec76/xing.svg?q=350") no-repeat;}
    
    
      .xing:hover {background:url("https://static-www.elastic.co/assets/bltededebe5f7521a39/xing-hover.svg?q=350")}		
    
	
    
		.youtube{background:url("https://static-www.elastic.co/assets/blt4982061ce1aebc7f/youtube.svg?q=350") no-repeat;}
    
    
      .youtube:hover {background:url("https://static-www.elastic.co/assets/bltddeb6c6404ae81a5/youtube-hover.svg?q=350")}		
    
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
  MktoForms2.whenReady(function (form) {
  //    // Put your code that uses the form object here
  //   $('#Email').attr("placeholder","Email Address");
  //   $('#FirstName').attr("placeholder","First Name");
  //   $('#LastName').attr("placeholder","Last Name");
  //   $('#Form_Message').attr("placeholder","Tell us in your words");
  // // ========================End Mktoform placeholder==================
  });
  MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
    console.log("inside footer form", form);
    form.onSuccess(function(form){
      $('#mktoForm_1398').css('display','none');
      $('.subscribe-wrapper .subscribe-form-container').hide();
      $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
      dataLayer.push({'event': 'mktoFormSubmit'});
        return false;
      });
  });
</script>
      </section>
    </div>
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","url":"/guide_template"}';
</script>
<script src="https://static-www.elastic.co/static/js/jquery.autocomplete.js?q=350"></script>
<script type="text/javascript" src="https://static-www.elastic.co/static/js/slick.min.js?q=350"></script>
<script src="https://static-www.elastic.co/static/js/nav-v5.js?q=350"></script>
<script src="https://static-www.elastic.co/static/js/script.js?q=350"></script> 
     
<script type="text/javascript">
$(document).ready(function(){
	if (window.location.hash.length) {
	      var target = $(window.location.hash);
	      target = target.length ? target : $(window.location.hash);
	      if (target.length) {
	        setTimeout(function(){ $(window).scrollTop(target.offset().top - 60); }, 1200);        
	      }
	}
	$('#guide').on('click','a[href*=#]:not([href=#])',function(e) {
			var flag=true;
		      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
		          var target = $(this.hash);
		          target = target.length ? target :$(this.hash);
		          if (target.length) {
		            if(flag){
		              flag=false;
		              var heightScroll=($('.tertiary-nav.navbar-fixed-top').height())?60:110;
		              $('html,body').animate({
		                  scrollTop: target.offset().top - heightScroll
		                }, 2000, function(){
		                  flag=true;
		                });
		            }                    
		          }
		      }
		    
	});

})

</script>

     <style></style>
     
  
            <script type="text/javascript" src="docs.js"></script>
<script type='text/javascript' src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=yaml'></script>

            </body>
        
</html>