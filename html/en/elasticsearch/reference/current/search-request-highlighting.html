<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Highlighting
        | Elasticsearch Reference [6.0]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [6.0]" /><link rel="up" href="search-request-body.html" title="Request Body Search" /><link rel="prev" href="search-request-post-filter.html" title="Post filter" /><link rel="next" href="search-request-rescore.html" title="Rescoring" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.0" />
    <!-- RTP tag -->
    <script type='text/javascript' async>
    (function(c,h,a,f,i,e){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};c[a].a=i;c[a].e=e;var g=h.createElement("script");g.async=true;g.type="text/javascript";g.src=f+'?aid='+i;var b=h.getElementsByTagName("script")[0];b.parentNode.insertBefore(g,b);})(window,document,"rtp","//sjrtp2-cdn.marketo.com/rtp-api/v1/rtp.js","elasticco");

    rtp('send','view');
    rtp('get', 'campaign',true);
    </script> 
    <!-- End of RTP tag -->
    

    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
<meta name="apple-mobile-web-app-title" content="Elastic">
<meta name="application-name" content="Elastic">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- DC tags section -->
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
<link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >



	



<!-- end DC tags -->


	<meta name="description" content="" />



	<meta name="localized" content="true" />

	<meta name="published_date" content="2017-04-06T11:42:52.019Z" />




		
			<meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
		

		

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">

	   

    <!-- css -->
    <link href="/static/css/main.css" rel="stylesheet">
    
    

    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // ---------------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
        locales = {
          '/en/': '/',
          '/de/': '/de/',
          '/fr/': '/fr/',
          '/ja/':'/jp/',
          '/ko/':'/kr/',
          '/zh/':'/cn/'
        }
        localepages = ['/','/de/','/fr/','/jp/','/kr/','/cn/','/products','/de/products','/fr/products','/jp/products','/kr/products','/cn/products'],
        locationpath = window.location.pathname,
        localeUrl = '{"relative_url_prefix":"/","code":"en-us","url":"/guide_template"}',
        currentlocale = JSON.parse(localeUrl);
    
      if(localepages.indexOf(locationpath) != -1){
        if($.cookie("c_lang")){
          if($.cookie("c_lang") != currentlocale.relative_url_prefix){
            var cookieurl = $.cookie("c_lang") + currentlocale.url.slice(1,currentlocale.url.length);
            window.location = cookieurl;
          }
        }
        else{
          var locale_lang = "/";
          if(locales[lang] != undefined){
            locale_lang = locales[lang];
          }
          $.cookie("c_lang",locale_lang ,{ expires: 365, path: '/'}); 
          window.location = localepages[localepages.indexOf(locationpath)];
        }
      }
      
      // --------------------- end of set language based on browser language -----------------
      </script>


	
	<link type="text/css" rel="stylesheet" href="/static/css/guide.css" />


  
<link rel="stylesheet" type="text/css" href="styles.css" />

</head>
  <body >
  	<!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
                              height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- begin olark code -->
    <script data-cfasync="false" type='text/javascript'>/*<![CDATA[*/window.olark||(function(c){var f=window,d=document,l=f.location.protocol=="https:"?"https:":"http:",z=c.name,r="load";var nt=function(){
    f[z]=function(){
    (a.s=a.s||[]).push(arguments)};var a=f[z]._={
    },q=c.methods.length;while(q--){(function(n){f[z][n]=function(){
    f[z]("call",n,arguments)}})(c.methods[q])}a.l=c.loader;a.i=nt;a.p={
    0:+new Date};a.P=function(u){
    a.p[u]=new Date-a.p[0]};function s(){
    a.P(r);f[z](r)}f.addEventListener?f.addEventListener(r,s,false):f.attachEvent("on"+r,s);var ld=function(){function p(hd){
    hd="head";return["<",hd,"></",hd,"><",i,' onl' + 'oad="var d=',g,";d.getElementsByTagName('head')[0].",j,"(d.",h,"('script')).",k,"='",l,"//",a.l,"'",'"',"></",i,">"].join("")}var i="body",m=d[i];if(!m){
    return setTimeout(ld,100)}a.P(1);var j="appendChild",h="createElement",k="src",n=d[h]("div"),v=n[j](d[h](z)),b=d[h]("iframe"),g="document",e="domain",o;n.style.display="none";m.insertBefore(n,m.firstChild).id=z;b.frameBorder="0";b.id=z+"-loader";if(/MSIE[ ]+6/.test(navigator.userAgent)){
    b.src="javascript:false"}b.allowTransparency="true";v[j](b);try{
    b.contentWindow[g].open()}catch(w){
    c[e]=d[e];o="javascript:var d="+g+".open();d.domain='"+d.domain+"';";b[k]=o+"void(0);"}try{
    var t=b.contentWindow[g];t.write(p());t.close()}catch(x){
    b[k]=o+'d.write("'+p().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}a.P(2)};ld()};nt()})({
    loader: "static.olark.com/jsclient/loader0.js",name:"olark",methods:["configure","extend","declare","identify"]});
    /* custom configuration goes here (www.olark.com/documentation) */
    olark.identify('1356-750-10-5709');/*]]>*/</script><noscript><a href="https://www.olark.com/site/1356-750-10-5709/contact" title="Contact us">Questions? Feedback?</a> powered by <a href="http://www.olark.com?welcome" title="Olark live chat software">Olark live chat software</a></noscript>
    <!-- end olark code -->

    <script> 
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ 
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), 
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) 
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); 
      ga('create', 'UA-12395217-16', 'auto'); 
      ga('send', 'pageview'); 
    </script>

    <!-- Header Section -->
    
<header class="header-wrapper">
  


  




<div class="navigation-wrapper">
  <div class="container">
    <nav class="navbar">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-mobile-header navbar-header mr-20 mr-xs-0">
      <div class="row hidden-sm hidden-md hidden-lg">
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg">
          <div class="navbar-mobile-header-icon navbar-mobile-header-icon-out">
            <span></span>
            <span></span>
            <span></span>
          </div>
          
        </div>
        <div class="col-xs-2 text-center">
          <div class="navbar-brand" id="elastic">
            <h1>
              <a class="logo-m hidden-sm hidden-md hidden-lg" href="/">
                <img src="/assets/bltd5ac38b4549d53de/elastic-logo-mobile%20(1).svg" alt="elastic-logo-mobile">
              </a>
            </h1>
          </div>
        </div>
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right">
          <ul class="menu-m hidden-sm hidden-md hidden-lg">
            <li class=""><a class="icon-contact" href="/contact"></a></li>
            <li id="searchbar"><a class="button icon" href="#"></a></li>
            <li class="lang global-language">
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              <ul class="language-list">
                
                  
                    
                  
                <li><a href="/" data-value="/" id="locale-select">English</a></li>
                
                  
                    
                  
                <li><a href="/fr/" data-value="/fr/" id="locale-select">Français</a></li>
                
                  
                    
                  
                <li><a href="/de/" data-value="/de/" id="locale-select">Deutsch</a></li>
                
                  
                    
                  
                <li><a href="/jp/" data-value="/jp/" id="locale-select">日本語</a></li>
                
                  
                    
                  
                <li><a href="/kr/" data-value="/kr/" id="locale-select">한국어</a></li>
                
                  
                    
                  
                <li><a href="/cn/" data-value="/cn/" id="locale-select">简体中文</a></li>
                
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <div class="navbar-brand hidden-xs" id="elastic">
        <h1>
          <a class="hidden-xs" id="elastic-logo" href="/">
            <img src="/assets/blt6050efb80ceabd47/elastic-logo%20(2).svg" alt="elastic-logo">
          </a>
        </h1>
      </div>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse mobile-inner-nav">
      <nav class="nav navbar-nav primary-nav-hover" id="nav">
        <ul>
        
          
            
              
            
            <li>
              <a id="nav_products" class=" " href="/products">Products</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_cloud" class=" " href="/cloud">Cloud</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_services" class=" " href="/services">Services</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_customers" class=" " href="/use-cases">Customers</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_learn" class=" " href="/learn">Learn</a>
            </li>
          
        
          
        
        </ul>
      </nav>
      <nav class="nav navbar-nav navbar-right hidden-xs">
        <ul>
          <li class="hidden-xs hidden-sm"><a href="/downloads">downloads</a></li>
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li>
          <!-- To set parameters to contact button -->
          
           
            
          

          
            
            
          
          <li class="hidden-xs hidden-sm"><a class="btn btn-secondary btn-contact" href="/contact?storm=global-header-en">contact</a></li>
          <!-- ////////////////ends here///////////////-->          
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact?storm=global-header-en"></a></li>
          <li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li>
          <li class="hidden-xs lang global-language">
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
               <ul class="language-list">
              
                
                  
                
              <li><a class="" href="/" data-value="/">English</a></li>
              
                
                  
                
              <li><a class="" href="/fr/" data-value="/fr/">Français</a></li>
              
                
                  
                
              <li><a class="" href="/de/" data-value="/de/">Deutsch</a></li>
              
                
                  
                
              <li><a class="" href="/jp/" data-value="/jp/">日本語</a></li>
              
                
                  
                
              <li><a class="" href="/kr/" data-value="/kr/">한국어</a></li>
              
                
                  
                
              <li><a class="" href="/cn/" data-value="/cn/">简体中文</a></li>
              
            </ul>
          </li>
        </ul>
      </nav>
    </div><!-- /.navbar-collapse -->
  </nav>
  </div>
</div>

<div class="header-search-wrapper open-search"> 
  <div class="container">
    <div class="big-search">
      <i class="big-search-icon"></i>
      <form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get">
        <ul class="tags-wrapper">
          <li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li>
        </ul>
      </form>
      <a class="header-search-cancel" href="#"></a>
    </div>
    <div class="nav-auto-complete"></div>
  </div>
</div>
</header>
<link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">
<style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
    
</style>
<script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>
<script type="text/javascript">
  $(document).ready( function(){
    // if($('#scrollable-pane li').length > 3){
      $('.horizon-swiper').horizonSwiper({
        showItems: 3,
        arrows: true
      }); 
    // }
    
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
    });

    var active_url = "";

    $(".navbar-mobile-header-icon").click(function(index){
      $('.navigation-wrapper').toggleClass('menu-overlay');
      $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
      $(".mobile-inner-nav").slideToggle(500);
      $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
        $(this).css({'animation-delay': (index/25)+'0.4s'});
      });
    });

    $('.dropdown-btn').on('click', function(e){
      e.preventDefault();
      setDropdown();
    });
    
    function setDropdown() {
      $('#myDropdown').slideToggle();
    }

    $('body').on('click', function(event){
      if (!event.target.matches('.dropdown-btn')) {

        var dropdowns = $(".dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    });

    // if($(window).width() < 769){
    //   var $item = $('.scrollable-panel li'), 
    //       visible = 3, //Set the number of items that will be visible
    //       index = 0, //Starting index
    //       endIndex = ( $item.length / visible ) - 1; //End index (NOTE:: Requires visible to be a factor of $item.length... You can improve this by rounding...)

    //   $('#right-arrow').click(function(){
    //     if(index < endIndex ){
    //       index++;
    //       $item.animate({'left':'-=300px'});
    //     }
    //   });

    //   $('#left-arrow').click(function(){
    //     if(index > 0){
    //       index--;            
    //       $item.animate({'left':'+=300px'});
    //     }
    //   });
    // }
  });
  $(window).resize(function () {
    $('.horizon-swiper').horizonSwiper({
      showItems: 3,
      arrows: true
    });
  });
</script>
    
      


  





  
  
  
  
    <div class="tertiary-nav">
      <div class="container">
        <div class="p-t-b-15 bdr-btm-e0e0e0 clearfix">
          <div class="breadcrum-wrapper pull-left text-left">
          
            <a href="/guide">Docs</a> 
          
          </div>
          
          
          
        </div>
      </div>
    </div>

    <div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg bdr-btm-e0e0e0 clearfix">
      <div class="container text-right">
        <div class="breadcrum-wrapper pull-left text-left">
          
              <a href="/guide">Docs</a>
          
        </div>
        
        
      </div>
    </div>
  


<style type="text/css">

  
</style>
    
    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   
          
            
        			<!-- <div class="pageheader">
	<div class="common-container">
		
			<h2 class="page-title">Guide template</h2>
		
	</div>
</div> -->


        		
          

          
	<section id="guide" lang="en">
		<div class="container">
			<div class="row">
			  <!-- start body -->
				
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [6.0]
    </a></span> » <span class="breadcrumb-link"><a href="search.html">Search APIs</a></span> » <span class="breadcrumb-link"><a href="search-request-body.html">Request Body Search</a></span> » <span class="breadcrumb-node">Highlighting</span></div><div class="navheader"><span class="prev"><a href="search-request-post-filter.html">
              « 
              Post filter</a>
           
        </span><span class="next">
           
          <a href="search-request-rescore.html">Rescoring
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="search-request-highlighting"></a>Highlighting<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Highlighters enable you to get highlighted snippets from one or more fields
in your search results so you can show users where the query matches are.
When you request highlights, the response contains an additional <code class="literal">highlight</code>
element for each search hit that includes the highlighted fields and the
highlighted fragments.</p><p>Highlighting requires the actual content of a field. If the field is not
stored (the mapping does not set <code class="literal">store</code> to <code class="literal">true</code>), the actual <code class="literal">_source</code> is
loaded and the relevant field is extracted from <code class="literal">_source</code>.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The <code class="literal">_all</code> field cannot be extracted from <code class="literal">_source</code>, so it can only
be used for highlighting if it is explicitly stored.</p></div></div><p>For example, to get highlights for the <code class="literal">content</code> field in each search hit
using the default highlighter, include a <code class="literal">highlight</code> object in
the request body that specifies the <code class="literal">content</code> field:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "content": "kimchy" }
    },
    "highlight" : {
        "fields" : {
            "comment" : {}
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/1.json"></div><p>Elasticsearch supports three highlighters: <code class="literal">unified</code>, <code class="literal">plain</code>, and <code class="literal">fvh</code> (fast vector
highlighter). You can specify the highlighter <code class="literal">type</code> you want to use
for each field.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="unified-highlighter"></a>Unified highlighter<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">unified</code> highlighter uses the Lucene Unified Highlighter. This
highlighter breaks the text into sentences and uses the BM25 algorithm to score
individual sentences as if they were documents in the corpus. It also supports
accurate phrase and multi-term (fuzzy, prefix, regex) highlighting. This is the
default highlighter.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="plain-highlighter"></a>Plain highlighter<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">plain</code> highlighter uses the standard Lucene highlighter. It attempts to
reflect the query matching logic in terms of understanding word importance and
any word positioning criteria in phrase queries.</p><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>The <code class="literal">plain</code> highlighter works best for highlighting simple query matches in a
single field. To accurately reflect query logic, it creates a tiny in-memory
index and re-runs the original query criteria through Lucene’s query execution
planner to get access to low-level match information for the current document.
This is repeated for every field and every document that needs to be highlighted.
If you want to highlight a lot of fields in a lot of documents with complex
queries, we recommend using the <code class="literal">unified</code> highlighter on <code class="literal">postings</code> or <code class="literal">term_vector</code> fields.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="fast-vector-highlighter"></a>Fast vector highlighter<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">fvh</code> highlighter uses the Lucene Fast Vector highlighter.
This highlighter can be used on fields with <code class="literal">term_vector</code> set to
<code class="literal">with_positions_offsets</code> in the mapping. The fast vector highlighter:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Can be customized with  a <a class="link" href="search-request-highlighting.html#boundary-scanners"><code class="literal">boundary_scanner</code></a>.
</li><li class="listitem">
Requires setting <code class="literal">term_vector</code> to <code class="literal">with_positions_offsets</code> which
  increases the size of the index
</li><li class="listitem">
Can combine matches from multiple fields into one result.  See
  <code class="literal">matched_fields</code>
</li><li class="listitem">
Can assign different weights to matches at different positions allowing
  for things like phrase matches being sorted above term matches when
  highlighting a Boosting Query that boosts phrase matches over term matches
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="offsets-strategy"></a>Offsets Strategy<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>To create meaningful search snippets from the terms being queried,
the highlighter needs to know the start and end character offsets of each word
in the original text. These offsets can be obtained from:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
The postings list. If <code class="literal">index_options</code> is set to <code class="literal">offsets</code> in the mapping,
the <code class="literal">unified</code> highlighter uses this information to highlight documents without
re-analyzing the text. It re-runs the original query directly on the postings
and extracts the matching offsets from the index, limiting the collection to
the highlighted documents. This is important if you have large fields because
it doesn’t require reanalyzing the text to be highlighted. It also requires less
disk space than using <code class="literal">term_vectors</code>.
</li><li class="listitem">
Term vectors. If <code class="literal">term_vector</code> information is provided by setting
<code class="literal">term_vector</code> to <code class="literal">with_positions_offsets</code> in the mapping, the <code class="literal">unified</code>
highlighter automatically uses the <code class="literal">term_vector</code> to highlight the field.
It’s fast especially for large fields (&gt; <code class="literal">1MB</code>) and for highlighting multi-term queries like
<code class="literal">prefix</code> or <code class="literal">wildcard</code> because it can access the dictionary of terms for each document.
The <code class="literal">fvh</code> highlighter always uses term vectors.
</li><li class="listitem">
Plain highlighting. This mode is used by the <code class="literal">unified</code> when there is no other alternative.
It creates a tiny in-memory index and re-runs the original query criteria through
Lucene’s query execution planner to get access to low-level match information on
the current document. This is repeated for every field and every document that
needs highlighting. The <code class="literal">plain</code> highlighter always uses plain highlighting.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="highlighting-settings"></a>Highlighting Settings<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Highlighting settings can be set on a global level and overridden at
the field level.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
boundary_chars
</span></dt><dd>
A string that contains each boundary character.
Defaults to <code class="literal">.,!? \t\n</code>.
</dd><dt><span class="term">
boundary_max_scan
</span></dt><dd>
How far to scan for boundary characters. Defaults to <code class="literal">20</code>.
</dd><dt><span class="term">
boundary_scanner
</span></dt><dd><p class="simpara">
Specifies how to break the highlighted fragments: <code class="literal">chars</code>,
<code class="literal">sentence</code>, or <code class="literal">word</code>. Only valid for the <code class="literal">unified</code> and <code class="literal">fvh</code> highlighters.
Defaults to <code class="literal">sentence</code> for the <code class="literal">unified</code> highlighter. Defaults to <code class="literal">chars</code> for
the <code class="literal">fvh</code> highlighter.
</p><div class="variablelist"><a id="boundary-scanners"></a><dl class="variablelist"><dt><span class="term">
<code class="literal">chars</code>
</span></dt><dd>
Use the characters specified by <code class="literal">boundary_chars</code> as highlighting
boundaries.  The <code class="literal">boundary_max_scan</code> setting controls how far to scan for
boundary characters. Only valid for the <code class="literal">fvh</code> highlighter.
</dd><dt><span class="term">
<code class="literal">sentence</code>
</span></dt><dd><p class="simpara">
Break highlighted fragments at the next sentence boundary, as
determined by Java’s
<a class="ulink" href="https://docs.oracle.com/javase/8/docs/api/java/text/BreakIterator.html" target="_top">BreakIterator</a>.
You can specify the locale to use with <code class="literal">boundary_scanner_locale</code>.
</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>When used with the <code class="literal">unified</code> highlighter, the <code class="literal">sentence</code> scanner splits
sentences bigger than <code class="literal">fragment_size</code> at the first word boundary next to
<code class="literal">fragment_size</code>. You can set <code class="literal">fragment_size</code> to 0 to never split any sentence.</p></div></div></dd><dt><span class="term">
<code class="literal">word</code>
</span></dt><dd>
Break highlighted fragments at the next word boundary, as determined
by Java’s <a class="ulink" href="https://docs.oracle.com/javase/8/docs/api/java/text/BreakIterator.html" target="_top">BreakIterator</a>.
You can specify the locale to use with <code class="literal">boundary_scanner_locale</code>.
</dd></dl></div></dd><dt><span class="term">
boundary_scanner_locale
</span></dt><dd>
Controls which locale is used to search for sentence
and word boundaries.
</dd><dt><span class="term">
encoder
</span></dt><dd>
Indicates if the highlighted text should be HTML encoded:
<code class="literal">default</code> (no encoding) or <code class="literal">html</code> (escapes HTML highlighting tags).
</dd><dt><span class="term">
fields
</span></dt><dd><p class="simpara">
Specifies the fields to retrieve highlights for. You can use wildcards
to specify fields. For example, you could specify <code class="literal">comment_*</code> to
get highlights for all <a class="link" href="text.html" title="Text datatype">text</a> and <a class="link" href="keyword.html" title="Keyword datatype">keyword</a> fields
that start with <code class="literal">comment_</code>.
</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Only text and keyword fields are highlighted when you use wildcards.
If you use a custom mapper and want to highlight on a field anyway, you
must explicitly specify that field name.</p></div></div></dd><dt><span class="term">
force_source
</span></dt><dd>
Highlight based on the source even if the field is
stored separately. Defaults to <code class="literal">false</code>.
</dd><dt><span class="term">
fragmenter
</span></dt><dd><p class="simpara">
Specifies how text should be broken up in highlight
snippets: <code class="literal">simple</code> or <code class="literal">span</code>. Only valid for the <code class="literal">plain</code> highlighter.
Defaults to <code class="literal">span</code>.
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">simple</code>
</span></dt><dd>
Breaks up text into same-sized fragments.
</dd><dt><span class="term">
<code class="literal">span</code>
</span></dt><dd>
Breaks up text into same-sized fragments, but tried to avoid
breaking up text between highlighted terms. This is helpful when you’re
querying for phrases. Default.
</dd></dl></div></dd><dt><span class="term">
fragment_offset
</span></dt><dd>
Controls the margin from which you want to start
highlighting. Only valid when using the <code class="literal">fvh</code> highlighter.
</dd><dt><span class="term">
fragment_size
</span></dt><dd>
The size of the highlighted fragment in characters. Defaults
to 100.
</dd><dt><span class="term">
highlight_query
</span></dt><dd><p class="simpara">
Highlight matches for a query other than the search
query. This is especially useful if you use a rescore query because
those are not taken into account by highlighting by default.
</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Elasticsearch does not validate that <code class="literal">highlight_query</code> contains
the search query in any way so it is possible to define it so
legitimate query results are not highlighted. Generally, you should
include the search query as part of the <code class="literal">highlight_query</code>.</p></div></div></dd><dt><span class="term">
matched_fields
</span></dt><dd>
Combine matches on multiple fields to highlight a single field.
This is most intuitive for multifields that analyze the same string in different
ways.  All <code class="literal">matched_fields</code> must have <code class="literal">term_vector</code> set to
<code class="literal">with_positions_offsets</code>, but only the field to which
the matches are combined is loaded so only that field benefits from having
<code class="literal">store</code> set to <code class="literal">yes</code>. Only valid for the <code class="literal">fvh</code> highlighter.
</dd><dt><span class="term">
no_match_size
</span></dt><dd>
The amount of text you want to return from the beginning
of the field if there are no matching fragments to highlight. Defaults
to 0 (nothing is returned).
</dd><dt><span class="term">
number_of_fragments
</span></dt><dd>
The maximum number of fragments to return. If the
number of fragments is set to 0, no fragments are returned. Instead,
the entire field contents are highlighted and returned. This can be
handy when you need to highlight short texts such as a title or
address, but fragmentation is not required. If <code class="literal">number_of_fragments</code>
is 0, <code class="literal">fragment_size</code> is ignored. Defaults to 5.
</dd><dt><span class="term">
order
</span></dt><dd>
Sorts highlighted fragments by score when set to <code class="literal">score</code>. Only valid for
the <code class="literal">unified</code> highlighter.
</dd><dt><span class="term">
phrase_limit
</span></dt><dd>
Controls the number of matching phrases in a document that are
considered. Prevents the <code class="literal">fvh</code> highlighter from analyzing too many phrases
and consuming too much memory. When using <code class="literal">matched_fields, `phrase_limit</code>
phrases per matched field are considered. Raising the limit increases query
time and consumes more memory. Only supported by the <code class="literal">fvh</code> highlighter.
Defaults to 256.
</dd><dt><span class="term">
pre_tags
</span></dt><dd>
Use in conjunction with <code class="literal">post_tags</code> to define the HTML tags
to use for the highlighted text. By default, highlighted text is wrapped
in <code class="literal">&lt;em&gt;</code> and <code class="literal">&lt;/em&gt;</code> tags. Specify as an array of strings.
</dd><dt><span class="term">
post_tags
</span></dt><dd>
Use in conjunction with <code class="literal">pre_tags</code> to define the HTML tags
to use for the highlighted text. By default, highlighted text is wrapped
in <code class="literal">&lt;em&gt;</code> and <code class="literal">&lt;/em&gt;</code> tags. Specify as an array of strings.
</dd><dt><span class="term">
require_field_match
</span></dt><dd>
By default, only fields that contains a query match are
highlighted. Set <code class="literal">require_field_match</code> to <code class="literal">false</code> to highlight all fields.
Defaults to <code class="literal">true</code>.
</dd><dt><span class="term">
tags_schema
</span></dt><dd><p class="simpara">
Set to <code class="literal">styled</code> to use the built-in tag schema. The <code class="literal">styled</code>
schema defines the following <code class="literal">pre_tags</code> and defines <code class="literal">post_tags</code> as
<code class="literal">&lt;/em&gt;</code>.
</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-html">&lt;em class="hlt1"&gt;, &lt;em class="hlt2"&gt;, &lt;em class="hlt3"&gt;,
&lt;em class="hlt4"&gt;, &lt;em class="hlt5"&gt;, &lt;em class="hlt6"&gt;,
&lt;em class="hlt7"&gt;, &lt;em class="hlt8"&gt;, &lt;em class="hlt9"&gt;,
&lt;em class="hlt10"&gt;</pre></div></dd><dt><span class="term">
type
</span></dt><dd>
The highlighter to use: <code class="literal">unified</code>, <code class="literal">plain</code>, or <code class="literal">fvh</code>. Defaults to
<code class="literal">unified</code>.
</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="highlighting-examples"></a>Highlighting Examples<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="link" href="search-request-highlighting.html#override-global-settings" title="Override global settingsedit">Override global settings</a>
</li><li class="listitem">
<a class="link" href="search-request-highlighting.html#specify-highlight-query" title="Specify a highlight queryedit">Specify a highlight query</a>
</li><li class="listitem">
<a class="link" href="search-request-highlighting.html#set-highlighter-type" title="Set highlighter typeedit">Set highlighter type</a>
</li><li class="listitem">
<a class="link" href="search-request-highlighting.html#configure-tags" title="Configure highlighting tagsedit">Configure highlighting tags</a>
</li><li class="listitem">
<a class="link" href="search-request-highlighting.html#highlight-source" title="Highlight on sourceedit">Highlight source</a>
</li><li class="listitem">
<a class="link" href="search-request-highlighting.html#highlight-all" title="Highlight in all fieldsedit">Highlight all fields</a>
</li><li class="listitem">
<a class="link" href="search-request-highlighting.html#matched-fields" title="Combine matches on multiple fieldsedit">Combine matches on multiple fields</a>
</li><li class="listitem">
<a class="link" href="search-request-highlighting.html#explicit-field-order" title="Explicitly order highlighted fieldsedit">Explicitly order highlighted fields</a>
</li><li class="listitem">
<a class="link" href="search-request-highlighting.html#control-highlighted-frags" title="Control highlighted fragmentsedit">Control highlighted fragments</a>
</li><li class="listitem">
<a class="link" href="search-request-highlighting.html#highlight-postings-list" title="Highlight using the postings listedit">Highlight using the postings list</a>
</li><li class="listitem">
<a class="link" href="search-request-highlighting.html#specify-fragmenter" title="Specify a fragmenter for the plain highlighteredit">Specify a fragmenter for the plain highlighter</a>
</li></ul></div><h3><a id="override-global-settings"></a>Override global settings<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can specify highlighter settings globally and selectively override them for
individual fields.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "number_of_fragments" : 3,
        "fragment_size" : 150,
        "fields" : {
            "_all" : { "pre_tags" : ["&lt;em&gt;"], "post_tags" : ["&lt;/em&gt;"] },
            "blog.title" : { "number_of_fragments" : 0 },
            "blog.author" : { "number_of_fragments" : 0 },
            "blog.comment" : { "number_of_fragments" : 5, "order" : "score" }
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/2.json"></div><h3><a id="specify-highlight-query"></a>Specify a highlight query<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can specify a <code class="literal">highlight_query</code> to take additional information into account
when highlighting. For example, the following query includes both the search
query and rescore query in the <code class="literal">highlight_query</code>. Without the <code class="literal">highlight_query</code>,
highlighting would only take the search query into account.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "stored_fields": [ "_id" ],
    "query" : {
        "match": {
            "comment": {
                "query": "foo bar"
            }
        }
    },
    "rescore": {
        "window_size": 50,
        "query": {
            "rescore_query" : {
                "match_phrase": {
                    "comment": {
                        "query": "foo bar",
                        "slop": 1
                    }
                }
            },
            "rescore_query_weight" : 10
        }
    },
    "highlight" : {
        "order" : "score",
        "fields" : {
            "comment" : {
                "fragment_size" : 150,
                "number_of_fragments" : 3,
                "highlight_query": {
                    "bool": {
                        "must": {
                            "match": {
                                "comment": {
                                    "query": "foo bar"
                                }
                            }
                        },
                        "should": {
                            "match_phrase": {
                                "comment": {
                                    "query": "foo bar",
                                    "slop": 1,
                                    "boost": 10.0
                                }
                            }
                        },
                        "minimum_should_match": 0
                    }
                }
            }
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/3.json"></div><h3><a id="set-highlighter-type"></a>Set highlighter type<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The <code class="literal">type</code> field allows to force a specific highlighter type.
The allowed values are: <code class="literal">unified</code>, <code class="literal">plain</code> and <code class="literal">fvh</code>.
The following is an example that forces the use of the plain highlighter:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "fields" : {
            "comment" : {"type" : "plain"}
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/4.json"></div><h3><a id="configure-tags"></a>Configure highlighting tags<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>By default, the highlighting will wrap highlighted text in <code class="literal">&lt;em&gt;</code> and
<code class="literal">&lt;/em&gt;</code>. This can be controlled by setting <code class="literal">pre_tags</code> and <code class="literal">post_tags</code>,
for example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "pre_tags" : ["&lt;tag1&gt;"],
        "post_tags" : ["&lt;/tag1&gt;"],
        "fields" : {
            "_all" : {}
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/5.json"></div><p>When using the fast vector highlighter, you can specify additional tags and the
"importance" is ordered.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "pre_tags" : ["&lt;tag1&gt;", "&lt;tag2&gt;"],
        "post_tags" : ["&lt;/tag1&gt;", "&lt;/tag2&gt;"],
        "fields" : {
            "_all" : {}
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/6.json"></div><p>You can also use the built-in <code class="literal">styled</code> tag schema:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "tags_schema" : "styled",
        "fields" : {
            "comment" : {}
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/7.json"></div><h3><a id="highlight-source"></a>Highlight on source<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Forces the highlighting to highlight fields based on the source even if fields
are stored separately. Defaults to <code class="literal">false</code>.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "fields" : {
            "comment" : {"force_source" : true}
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/8.json"></div><h3><a id="highlight-all"></a>Highlight in all fields<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>By default, only fields that contains a query match are highlighted. Set
<code class="literal">require_field_match</code> to <code class="literal">false</code> to highlight all fields.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "require_field_match": false,
        "fields": {
                "_all" : { "pre_tags" : ["&lt;em&gt;"], "post_tags" : ["&lt;/em&gt;"] }
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/9.json"></div><h3><a id="matched-fields"></a>Combine matches on multiple fields<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>This is only supported by the <code class="literal">fvh</code> highlighter</p></div></div><p>The Fast Vector Highlighter can combine matches on multiple fields to
highlight a single field.  This is most intuitive for multifields that
analyze the same string in different ways.  All <code class="literal">matched_fields</code> must have
<code class="literal">term_vector</code> set to <code class="literal">with_positions_offsets</code> but only the field to which
the matches are combined is loaded so only that field would benefit from having
<code class="literal">store</code> set to <code class="literal">yes</code>.</p><p>In the following examples, <code class="literal">comment</code> is analyzed by the <code class="literal">english</code>
analyzer and <code class="literal">comment.plain</code> is analyzed by the <code class="literal">standard</code> analyzer.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query": {
        "query_string": {
            "query": "comment.plain:running scissors",
            "fields": ["comment"]
        }
    },
    "highlight": {
        "order": "score",
        "fields": {
            "comment": {
                "matched_fields": ["comment", "comment.plain"],
                "type" : "fvh"
            }
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/10.json"></div><p>The above matches both "run with scissors" and "running with scissors"
and would highlight "running" and "scissors" but not "run". If both
phrases appear in a large document then "running with scissors" is
sorted above "run with scissors" in the fragments list because there
are more matches in that fragment.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query": {
        "query_string": {
            "query": "running scissors",
            "fields": ["comment", "comment.plain^10"]
        }
    },
    "highlight": {
        "order": "score",
        "fields": {
            "comment": {
                "matched_fields": ["comment", "comment.plain"],
                "type" : "fvh"
            }
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/11.json"></div><p>The above highlights "run" as well as "running" and "scissors" but
still sorts "running with scissors" above "run with scissors" because
the plain match ("running") is boosted.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query": {
        "query_string": {
            "query": "running scissors",
            "fields": ["comment", "comment.plain^10"]
        }
    },
    "highlight": {
        "order": "score",
        "fields": {
            "comment": {
                "matched_fields": ["comment.plain"],
                "type" : "fvh"
            }
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/12.json"></div><p>The above query wouldn’t highlight "run" or "scissor" but shows that
it is just fine not to list the field to which the matches are combined
(<code class="literal">comment</code>) in the matched fields.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Technically it is also fine to add fields to <code class="literal">matched_fields</code> that
don’t share the same underlying string as the field to which the matches
are combined.  The results might not make much sense and if one of the
matches is off the end of the text then the whole query will fail.</p></div></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>There is a small amount of overhead involved with setting
<code class="literal">matched_fields</code> to a non-empty array so always prefer</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">    "highlight": {
        "fields": {
            "comment": {}
        }
    }</pre></div><p>to</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">    "highlight": {
        "fields": {
            "comment": {
                "matched_fields": ["comment"],
                "type" : "fvh"
            }
        }
    }</pre></div></div></div><h3><a id="explicit-field-order"></a>Explicitly order highlighted fields<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Elasticsearch highlights the fields in the order that they are sent, but per the
JSON spec, objects are unordered.  If you need to be explicit about the order
in which fields are highlighted specify the <code class="literal">fields</code> as an array:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "highlight": {
        "fields": [
            { "title": {} },
            { "text": {} }
        ]
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/13.json"></div><p>None of the highlighters built into Elasticsearch care about the order that the
fields are highlighted but a plugin might.</p><h3><a id="control-highlighted-frags"></a>Control highlighted fragments<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Each field highlighted can control the size of the highlighted fragment
in characters (defaults to <code class="literal">100</code>), and the maximum number of fragments
to return (defaults to <code class="literal">5</code>).
For example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "fields" : {
            "comment" : {"fragment_size" : 150, "number_of_fragments" : 3}
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/14.json"></div><p>On top of this it is possible to specify that highlighted fragments need
to be sorted by score:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "order" : "score",
        "fields" : {
            "comment" : {"fragment_size" : 150, "number_of_fragments" : 3}
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/15.json"></div><p>If the <code class="literal">number_of_fragments</code> value is set to <code class="literal">0</code> then no fragments are
produced, instead the whole content of the field is returned, and of
course it is highlighted. This can be very handy if short texts (like
document title or address) need to be highlighted but no fragmentation
is required. Note that <code class="literal">fragment_size</code> is ignored in this case.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "fields" : {
            "_all" : {},
            "blog.title" : {"number_of_fragments" : 0}
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/16.json"></div><p>When using <code class="literal">fvh</code> one can use <code class="literal">fragment_offset</code>
parameter to control the margin to start highlighting from.</p><p>In the case where there is no matching fragment to highlight, the default is
to not return anything. Instead, we can return a snippet of text from the
beginning of the field by setting <code class="literal">no_match_size</code> (default <code class="literal">0</code>) to the length
of the text that you want returned. The actual length may be shorter or longer than
specified as it tries to break on a word boundary.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /_search
{
    "query" : {
        "match": { "user": "kimchy" }
    },
    "highlight" : {
        "fields" : {
            "comment" : {
                "fragment_size" : 150,
                "number_of_fragments" : 3,
                "no_match_size": 150
            }
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/17.json"></div><h3><a id="highlight-postings-list"></a>Highlight using the postings list<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Here is an example of setting the <code class="literal">comment</code> field in the index mapping to
allow for highlighting using the postings:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT /example
{
  "mappings": {
    "doc" : {
      "properties": {
        "comment" : {
          "type": "text",
          "index_options" : "offsets"
        }
      }
    }
  }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/18.json"></div><p>Here is an example of setting the <code class="literal">comment</code> field to allow for
highlighting using the <code class="literal">term_vectors</code> (this will cause the index to be bigger):</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT /example
{
  "mappings": {
    "doc" : {
      "properties": {
        "comment" : {
          "type": "text",
          "term_vector" : "with_positions_offsets"
        }
      }
    }
  }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/19.json"></div><h3><a id="specify-fragmenter"></a>Specify a fragmenter for the plain highlighter<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/reference/search/request/highlighting.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>When using the <code class="literal">plain</code> highlighter, you can choose between the <code class="literal">simple</code> and
<code class="literal">span</code> fragmenters:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET twitter/tweet/_search
{
    "query" : {
        "match_phrase": { "message": "number 1" }
    },
    "highlight" : {
        "fields" : {
            "message" : {
                "type": "plain",
                "fragment_size" : 15,
                "number_of_fragments" : 3,
                "fragmenter": "simple"
            }
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/20.json"></div><p>Response:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
    ...
    "hits": {
        "total": 1,
        "max_score": 1.601195,
        "hits": [
            {
                "_index": "twitter",
                "_type": "tweet",
                "_id": "1",
                "_score": 1.601195,
                "_source": {
                    "user": "test",
                    "message": "some message with the number 1",
                    "date": "2009-11-15T14:12:12",
                    "likes": 1
                },
                "highlight": {
                    "message": [
                        " with the &lt;em&gt;number&lt;/em&gt;",
                        " &lt;em&gt;1&lt;/em&gt;"
                    ]
                }
            }
        ]
    }
}</pre></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET twitter/tweet/_search
{
    "query" : {
        "match_phrase": { "message": "number 1" }
    },
    "highlight" : {
        "fields" : {
            "message" : {
                "type": "plain",
                "fragment_size" : 15,
                "number_of_fragments" : 3,
                "fragmenter": "span"
            }
        }
    }
}</pre></div><div class="console_widget" data-snippet="snippets/search-request-highlighting/21.json"></div><p>Response:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
    ...
    "hits": {
        "total": 1,
        "max_score": 1.601195,
        "hits": [
            {
                "_index": "twitter",
                "_type": "tweet",
                "_id": "1",
                "_score": 1.601195,
                "_source": {
                    "user": "test",
                    "message": "some message with the number 1",
                    "date": "2009-11-15T14:12:12",
                    "likes": 1
                },
                "highlight": {
                    "message": [
                        " with the &lt;em&gt;number&lt;/em&gt; &lt;em&gt;1&lt;/em&gt;"
                    ]
                }
            }
        ]
    }
}</pre></div><p>If the <code class="literal">number_of_fragments</code> option is set to <code class="literal">0</code>,
<code class="literal">NullFragmenter</code> is used which does not fragment the text at all.
This is useful for highlighting the entire contents of a document or field.</p></div></div><div class="navfooter"><span class="prev"><a href="search-request-post-filter.html">
              « 
              Post filter</a>
           
        </span><span class="next">
           
          <a href="search-request-rescore.html">Rescoring
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
					<div id="rtpcontainer" style="display: block;">
						<div class="mktg-promo">
						<h3>Getting Started Videos</h3>
						<ul class="icons">
							<li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Elasticsearch Demo</a></li>
							<li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Kibana 101</a></li>
							<li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Primer</a></li>
						</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

        </div>
      	


<div id="footer-subscribe" class="home-footer-subscribe">
  <div class="subscribe-wrapper">
    <div class="container">
      <div class="subscribe-form-container">
        <div class="subscribe-title col-md-12 col-lg-6">
            <h5>Be in the know with the latest and greatest from Elastic.</h5>
        </div>
        <div class="subscribe-form col-md-12 col-lg-6">
          <form id="mktoForm_1398" class="mktoForm sb-form"></form>
        </div>
      </div>
      <div class="form_thanks hide">
        
          <p>Thanks for subscribing! We'll keep you updated with new releases.</p>
        
      </div>
    </div>
  </div>
</div>
<!--subscribe newsletter end-->

<!-- Footer Section -->
<footer class="footer-wrapper">
  <div class="container">
    <div class="row footer-content">
        
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/products">Products ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/products/elasticsearch">Elasticsearch</a></li>
                  
                
              
                
                  
                    <li><a href="/products/kibana">Kibana</a></li>
                  
                
              
                
                  
                    <li><a href="/products/beats">Beats</a></li>
                  
                
              
                
                  
                    <li><a href="/products/logstash">Logstash</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack">X-Pack</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud/as-a-service">Elastic Cloud</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud/enterprise">Elastic Cloud Enterprise</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/security">Security (formerly Shield)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/alerting">Alerting (via Watcher)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/monitoring">Monitoring (formerly Marvel)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/graph">Graph</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/reporting">Reporting</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/machine-learning">Machine Learning</a></li>
                  
                
              
                
                  
                    <li><a href="/products/hadoop">ES-Hadoop</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/solutions">Solutions ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/solutions/app-search">App Search</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/site-search">Site Search</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/logging">Logging</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/metrics">Metrics</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/security-analytics">Security Analytics</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3>Resources</h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/blog">Blog</a></li>
                  
                
              
                
                  
                    <li><a href="https://cloud-status.elastic.co">Cloud Status</a></li>
                  
                
              
                
                  
                    <li><a href="/community">Community</a></li>
                  
                
              
                
                  
                    <li><a href="/use-cases">Customers & Use Cases</a></li>
                  
                
              
                
                  
                    <li><a href="/guide">Documentation</a></li>
                  
                
              
                
                  
                    <li><a href="/elasticon">Elastic{ON} Events</a></li>
                  
                
              
                
                  
                    <li><a href="https://discuss.elastic.co/">Forums</a></li>
                  
                
              
                
                  
                    <li><a href="/community/meetups">Meetups</a></li>
                  
                
              
                
                  
                    <li><a href="/subscriptions">Subscriptions</a></li>
                  
                
              
                
                  
                    <li><a href="https://support.elastic.co">Support Portal</a></li>
                  
                
              
                
                  
                    <li><a href="/videos">Videos & Webinars</a></li>
                  
                
              
                
                  
                    <li><a href="/training">Training</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/about">About ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/about/careers">Careers/Jobs</a></li>
                  
                
              
                
                  
                    <li><a href="/contact">Contact</a></li>
                  
                
              
                
                  
                    <li><a href="/about/leadership">Leadership</a></li>
                  
                
              
                
                  
                    <li><a href="/about/partners">Partners</a></li>
                  
                
              
                
                  
                    <li><a href="/about/press">Press</a></li>
                  
                
              
                
                  
                    <li><a href="https://www.elastic.shop">Elastic Store</a></li>
                  
                
              
              </ul>
          </div>    
       
    </div>
     <!-- Social Media Section -->
    <div class="row social-icon">
      <div class="col-xs-12 col-sm-12 col-md-12">
        <p class="text-center font-size-10 m-0">FOLLOW US</p>
        <ul>
          
          <li class="facebook"><a id="footer_facebook" href="http://www.facebook.com/elastic.co"></a></li>
          
          <li class="twitter"><a id="footer_twitter" href="https://www.twitter.com/elastic"></a></li>
          
          <li class="linkedin"><a id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co"></a></li>
          
          <li class="xing"><a id="footer_xing" href="https://www.xing.com/companies/elastic.co"></a></li>
          
          <li class="youtube"><a id="footer_youtube" href="https://www.youtube.com/user/elasticsearch"></a></li>
          
        </ul>
      </div>
    </div>
    <!-- Social Media Section end-->
    <div class="row">
	<div class="col-xs-12 col-sm-12 col-md-12">
		<div class="copyright">
			<ul>
				<li><a href="/legal/trademarks">Trademarks</a></li>
				<li><a href="/legal/terms-of-use">Terms of Use</a></li>
				<li><a href="/legal/privacy-policy">Privacy</a></li>
				<li><a href="/legal/privacy-and-cookie-policy">Cookie Policy</a></li>
				<li><a href="/brand">Brand</a></li>
			</ul>
			<div class="copyright-content">
				<div class="footer-logo"><a href="/"><img src="/static/images/svg/logo-elastic-footer.svg" class="img-responsive"></a>
				</div>
				<div class="footer-text">
					<p>© 2017. All Rights Reserved - Elasticsearch
					</p>
					<p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries.
					</p>
					<p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.
					</p>
				</div>
			</div>
		</div>
	</div>
</div>
  </div>
</footer>
<!-- Footer Section end-->

<style type="text/css">
	
    
		.facebook{background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
    
    
      .facebook:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
    
	
    
		.twitter{background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
    
    
      .twitter:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
    
	
    
		.linkedin{background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
    
    
      .linkedin:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
    
	
    
		.xing{background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
    
    
      .xing:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
    
	
    
		.youtube{background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
    
    
      .youtube:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
    
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
  MktoForms2.whenReady(function (form) {
  //    // Put your code that uses the form object here
  //   $('#Email').attr("placeholder","Email Address");
  //   $('#FirstName').attr("placeholder","First Name");
  //   $('#LastName').attr("placeholder","Last Name");
  //   $('#Form_Message').attr("placeholder","Tell us in your words");
  // // ========================End Mktoform placeholder==================
  });
  MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
    console.log("inside footer form", form);
    form.onSuccess(function(form){
      $('#mktoForm_1398').css('display','none');
      $('.subscribe-wrapper .subscribe-form-container').hide();
      $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
      dataLayer.push({'event': 'mktoFormSubmit'});
        return false;
      });
  });
</script>
      </section>
    </div>
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script> 
     
<script type="text/javascript">
$(document).ready(function(){
	if (window.location.hash.length) {
	      var target = $(window.location.hash);
	      target = target.length ? target : $(window.location.hash);
	      if (target.length) {
	        setTimeout(function(){ $(window).scrollTop(target.offset().top - 60); }, 1200);        
	      }
	}
	$('#guide').on('click','a[href*=#]:not([href=#])',function(e) {
			var flag=true;
		      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
		          var target = $(this.hash);
		          target = target.length ? target :$(this.hash);
		          if (target.length) {
		            if(flag){
		              flag=false;
		              var heightScroll=($('.tertiary-nav.navbar-fixed-top').height())?60:110;
		              $('html,body').animate({
		                  scrollTop: target.offset().top - heightScroll
		                }, 2000, function(){
		                  flag=true;
		                });
		            }                    
		          }
		      }
		    
	});

})

</script>

     <style></style>
     
  
            <script type="text/javascript" src="docs.js"></script>
<script type='text/javascript' src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=yaml'></script>

            </body>
        
</html>