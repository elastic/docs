<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Search API
        | Java REST Client [6.0]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Java REST Client [6.0]" /><link rel="up" href="_supported_apis.html" title="Supported APIs" /><link rel="prev" href="java-rest-high-document-bulk.html" title="Bulk API" /><link rel="next" href="java-rest-high-search-scroll.html" title="Search Scroll API" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Docs/Clients/JavaREST/6.0" />
    <!-- RTP tag -->
    <script type='text/javascript' async>
    (function(c,h,a,f,i,e){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};c[a].a=i;c[a].e=e;var g=h.createElement("script");g.async=true;g.type="text/javascript";g.src=f+'?aid='+i;var b=h.getElementsByTagName("script")[0];b.parentNode.insertBefore(g,b);})(window,document,"rtp","//sjrtp2-cdn.marketo.com/rtp-api/v1/rtp.js","elasticco");

    rtp('send','view');
    rtp('get', 'campaign',true);
    </script> 
    <!-- End of RTP tag -->
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
<meta name="apple-mobile-web-app-title" content="Elastic">
<meta name="application-name" content="Elastic">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- DC tags section -->
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
<link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >



	



<!-- end DC tags -->


	<meta name="description" content="" />





		
			<meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
		

		

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">

	   

    <!-- css -->
    <link href="https://static-www.elastic.co/static/css/main.css?q=540" rel="stylesheet">
    
    

    <script src="https://static-www.elastic.co/static/js/jquery.min.js?q=540"></script>
    <script src="https://static-www.elastic.co/static/js/bootstrap.min.js?q=540"></script>
    <script src="https://static-www.elastic.co/static/js/jquery.cookie.js?q=540"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // ---------------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
        locales = {
          '/en/': '/',
          '/de/': '/de/',
          '/fr/': '/fr/',
          '/ja/':'/jp/',
          '/ko/':'/kr/',
          '/zh/':'/cn/'
        }
        localepages = ['/','/de/','/fr/','/jp/','/kr/','/cn/','/products','/de/products','/fr/products','/jp/products','/kr/products','/cn/products'],
        locationpath = window.location.pathname,
        localeUrl = '{"relative_url_prefix":"/","code":"en-us","url":"/guide_template"}',
        currentlocale = JSON.parse(localeUrl);
    
      if(localepages.indexOf(locationpath) != -1){
        if($.cookie("c_lang")){
          if($.cookie("c_lang") != currentlocale.relative_url_prefix){
            var cookieurl = $.cookie("c_lang") + currentlocale.url.slice(1,currentlocale.url.length);
            window.location = cookieurl;
          }
        }
        else{
          var locale_lang = "/";
          if(locales[lang] != undefined){
            locale_lang = locales[lang];
          }
          $.cookie("c_lang",locale_lang ,{ expires: 365, path: '/'}); 
          window.location = localepages[localepages.indexOf(locationpath)];
        }
      }
      
      // --------------------- end of set language based on browser language -----------------
      </script>


	
	<link type="text/css" rel="stylesheet" href="https://static-www.elastic.co/static/css/guide.css?q=540" />


  
<link rel="stylesheet" type="text/css" href="styles.css" />

</head>
  <body >
  	<!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
                              height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- begin olark code -->
    <script data-cfasync="false" type='text/javascript'>/*<![CDATA[*/window.olark||(function(c){var f=window,d=document,l=f.location.protocol=="https:"?"https:":"http:",z=c.name,r="load";var nt=function(){
    f[z]=function(){
    (a.s=a.s||[]).push(arguments)};var a=f[z]._={
    },q=c.methods.length;while(q--){(function(n){f[z][n]=function(){
    f[z]("call",n,arguments)}})(c.methods[q])}a.l=c.loader;a.i=nt;a.p={
    0:+new Date};a.P=function(u){
    a.p[u]=new Date-a.p[0]};function s(){
    a.P(r);f[z](r)}f.addEventListener?f.addEventListener(r,s,false):f.attachEvent("on"+r,s);var ld=function(){function p(hd){
    hd="head";return["<",hd,"></",hd,"><",i,' onl' + 'oad="var d=',g,";d.getElementsByTagName('head')[0].",j,"(d.",h,"('script')).",k,"='",l,"//",a.l,"'",'"',"></",i,">"].join("")}var i="body",m=d[i];if(!m){
    return setTimeout(ld,100)}a.P(1);var j="appendChild",h="createElement",k="src",n=d[h]("div"),v=n[j](d[h](z)),b=d[h]("iframe"),g="document",e="domain",o;n.style.display="none";m.insertBefore(n,m.firstChild).id=z;b.frameBorder="0";b.id=z+"-loader";if(/MSIE[ ]+6/.test(navigator.userAgent)){
    b.src="javascript:false"}b.allowTransparency="true";v[j](b);try{
    b.contentWindow[g].open()}catch(w){
    c[e]=d[e];o="javascript:var d="+g+".open();d.domain='"+d.domain+"';";b[k]=o+"void(0);"}try{
    var t=b.contentWindow[g];t.write(p());t.close()}catch(x){
    b[k]=o+'d.write("'+p().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}a.P(2)};ld()};nt()})({
    loader: "static.olark.com/jsclient/loader0.js",name:"olark",methods:["configure","extend","declare","identify"]});
    /* custom configuration goes here (www.olark.com/documentation) */
    olark.identify('1356-750-10-5709');/*]]>*/</script><noscript><a href="https://www.olark.com/site/1356-750-10-5709/contact" title="Contact us">Questions? Feedback?</a> powered by <a href="http://www.olark.com?welcome" title="Olark live chat software">Olark live chat software</a></noscript>
    <!-- end olark code -->

    <script> 
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ 
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), 
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) 
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); 
      ga('create', 'UA-12395217-16', 'auto'); 
      ga('send', 'pageview'); 
    </script>

    <!-- Header Section -->
    
<header class="header-wrapper">
   

  




<div class="navigation-wrapper">
  <div class="container">
    <nav class="navbar">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-mobile-header navbar-header mr-20 mr-xs-0">
      <div class="row hidden-sm hidden-md hidden-lg">
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg">
          <div class="navbar-mobile-header-icon navbar-mobile-header-icon-out">
            <span></span>
            <span></span>
            <span></span>
          </div>
          
        </div>
        <div class="col-xs-2 text-center">
          <div class="navbar-brand" id="elastic">
            <h1>
              <a class="logo-m hidden-sm hidden-md hidden-lg" href="/">
                <img src="https://static-www.elastic.co/assets/bltd5ac38b4549d53de/elastic-logo-mobile (1).svg?q=540" alt="elastic-logo-mobile">
              </a>
            </h1>
          </div>
        </div>
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right">
          <ul class="menu-m hidden-sm hidden-md hidden-lg">
            <li class=""><a class="icon-contact" href="/contact"></a></li>
            <li id="searchbar"><a class="button icon" href="#"></a></li>
            <li class="lang global-language">
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              <ul class="language-list">
                
                  
                    
                  
                <li><a href="/" data-value="/" id="locale-select">English</a></li>
                
                  
                    
                  
                <li><a href="/fr/" data-value="/fr/" id="locale-select">Français</a></li>
                
                  
                    
                  
                <li><a href="/de/" data-value="/de/" id="locale-select">Deutsch</a></li>
                
                  
                    
                  
                <li><a href="/jp/" data-value="/jp/" id="locale-select">日本語</a></li>
                
                  
                    
                  
                <li><a href="/kr/" data-value="/kr/" id="locale-select">한국어</a></li>
                
                  
                    
                  
                <li><a href="/cn/" data-value="/cn/" id="locale-select">简体中文</a></li>
                
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <div class="navbar-brand hidden-xs" id="elastic">
        <h1>
          <a class="hidden-xs" id="elastic-logo" href="/">
            <img src="https://static-www.elastic.co/assets/blt6050efb80ceabd47/elastic-logo (2).svg?q=540" alt="elastic-logo">
          </a>
        </h1>
      </div>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse mobile-inner-nav">
      <nav class="nav navbar-nav primary-nav-hover" id="nav">
        <ul>
        
          
            
              
            
            <li>
              <a id="nav_products" class=" " href="/products">Products</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_cloud" class=" " href="/cloud">Cloud</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_services" class=" " href="/services">Services</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_customers" class=" " href="/use-cases">Customers</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_learn" class=" " href="/learn">Learn</a>
            </li>
          
        
          
        
        </ul>
      </nav>
      <nav class="nav navbar-nav navbar-right hidden-xs">
        <ul>
          <li class="hidden-xs hidden-sm"><a href="/downloads">downloads</a></li>
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li>
          <!-- To set parameters to contact button -->
          
           
            
          

          
            
            
          
          <li class="hidden-xs hidden-sm"><a class="btn btn-secondary btn-contact" href="/contact?storm=global-header-en">contact</a></li>
          <!-- ////////////////ends here///////////////-->          
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact?storm=global-header-en"></a></li>
          <li class="hidden-xs" id="searchbar"><a class="button icon" href="#"></a></li>
          <li class="hidden-xs lang global-language">
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
               <ul class="language-list">
              
                
                  
                
              <li><a class="" href="/" data-value="/">English</a></li>
              
                
                  
                
              <li><a class="" href="/fr/" data-value="/fr/">Français</a></li>
              
                
                  
                
              <li><a class="" href="/de/" data-value="/de/">Deutsch</a></li>
              
                
                  
                
              <li><a class="" href="/jp/" data-value="/jp/">日本語</a></li>
              
                
                  
                
              <li><a class="" href="/kr/" data-value="/kr/">한국어</a></li>
              
                
                  
                
              <li><a class="" href="/cn/" data-value="/cn/">简体中文</a></li>
              
            </ul>
          </li>
        </ul>
      </nav>
    </div><!-- /.navbar-collapse -->
  </nav>
  </div>
</div>

<div class="header-search-wrapper open-search"> 
  <div class="container">
    <div class="big-search">
      <i class="big-search-icon"></i>
      <form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get">
        <ul class="tags-wrapper">
          <li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li>
        </ul>
      </form>
      <a class="header-search-cancel" href="#"></a>
    </div>
    <div class="nav-auto-complete"></div>
  </div>
</div>
</header>
<link rel="stylesheet" type="text/css" href="https://static-www.elastic.co/static/css/horizon-swiper.min.css?q=540">
<style> 
    
      .m-shortcuts li a.m-search {
        background: url("https://static-www.elastic.co/assets/blt7b9c4fe6528dc4ef/m-search-icon.png?q=540") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("https://static-www.elastic.co/assets/blt44d8b7530a76d01c/m-guide-icon.png?q=540") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("https://static-www.elastic.co/assets/blt878040795c9d083b/m-contact-icon.png?q=540") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
    
</style>
<script type="text/javascript" src="https://static-www.elastic.co/static/js/horizon-swiper.min.js?q=540"></script>
<script type="text/javascript">
  $(document).ready( function(){
    // if($('#scrollable-pane li').length > 3){
      $('.horizon-swiper').horizonSwiper({
        showItems: 3,
        arrows: true
      }); 
    // }
    
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
    });

    var active_url = "";

    $(".navbar-mobile-header-icon").click(function(index){
      $('.navigation-wrapper').toggleClass('menu-overlay');
      $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
      $(".mobile-inner-nav").slideToggle(500);
      $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
        $(this).css({'animation-delay': (index/25)+'0.4s'});
      });
    });

    $('.dropdown-btn').on('click', function(e){
      e.preventDefault();
      setDropdown();
    });
    
    function setDropdown() {
      $('#myDropdown').slideToggle();
    }

    $('body').on('click', function(event){
      if (!event.target.matches('.dropdown-btn')) {

        var dropdowns = $(".dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    });

    // if($(window).width() < 769){
    //   var $item = $('.scrollable-panel li'), 
    //       visible = 3, //Set the number of items that will be visible
    //       index = 0, //Starting index
    //       endIndex = ( $item.length / visible ) - 1; //End index (NOTE:: Requires visible to be a factor of $item.length... You can improve this by rounding...)

    //   $('#right-arrow').click(function(){
    //     if(index < endIndex ){
    //       index++;
    //       $item.animate({'left':'-=300px'});
    //     }
    //   });

    //   $('#left-arrow').click(function(){
    //     if(index > 0){
    //       index--;            
    //       $item.animate({'left':'+=300px'});
    //     }
    //   });
    // }
  });
  $(window).resize(function () {
    $('.horizon-swiper').horizonSwiper({
      showItems: 3,
      arrows: true
    });
  });
</script>
    


  





  
  
  
  
    <div class="tertiary-nav">
      <div class="container">
        <div class="p-t-b-15 bdr-btm-e0e0e0 clearfix">
          <div class="breadcrum-wrapper pull-left text-left">
          
            <a href="/guide">Docs</a> 
          
          </div>
          
          
          
        </div>
      </div>
    </div>

    <div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg bdr-btm-e0e0e0 clearfix">
      <div class="container text-right">
        <div class="breadcrum-wrapper pull-left text-left">
          
              <a href="/guide">Docs</a>
          
        </div>
        
        
      </div>
    </div>
  


<style type="text/css">

  
</style>
    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   
          
            
        			<!-- <div class="pageheader">
	<div class="common-container">
		
			<h2 class="page-title">Guide template</h2>
		
	</div>
</div> -->


        		
          

          
	<section id="guide" lang="en">
		<div class="container">
			<div class="row">
			  <!-- start body -->
				
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Java REST Client
      [6.0]
    </a></span> » <span class="breadcrumb-link"><a href="java-rest-high.html">Java High Level REST Client</a></span> » <span class="breadcrumb-link"><a href="_supported_apis.html">Supported APIs</a></span> » <span class="breadcrumb-node">Search API</span></div><div class="navheader"><span class="prev"><a href="java-rest-high-document-bulk.html">
              « 
              Bulk API</a>
           
        </span><span class="next">
           
          <a href="java-rest-high-search-scroll.html">Search Scroll API
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="java-rest-high-search"></a>Search API<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="java-rest-high-document-search-request"></a>Search Request<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">SearchRequest</code> is used for any operation that has to do with searching
documents, aggregations, suggestions and also offers ways of requesting
highlighting on the resulting documents.</p><p>In its most basic form, we can add a query to the request:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchRequest searchRequest = new SearchRequest(); <a id="CO103-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder(); <a id="CO103-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
searchSourceBuilder.query(QueryBuilders.matchAllQuery()); <a id="CO103-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO103-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Creates the <code class="literal">SeachRequest</code>. Without arguments this runs against all indices.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO103-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Most search parameters are added to the <code class="literal">SearchSourceBuilder</code>. It offers setters for everything that goes into the search request body.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO103-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Add a <code class="literal">match_all</code> query to the <code class="literal">SearchSourceBuilder</code>.
</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_optional_arguments_6"></a>Optional arguments<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>Let’s first look at some of the optional arguments of a <code class="literal">SearchRequest</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchRequest searchRequest = new SearchRequest("posts"); <a id="CO104-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
searchRequest.types("doc"); <a id="CO104-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO104-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Restricts the request to an index
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO104-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Limits the request to a type
</p></td></tr></table></div><p>There are a couple of other interesting optional parameters:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">searchRequest.routing("routing"); <a id="CO105-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO105-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set a routing parameter
</p></td></tr></table></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">searchRequest.indicesOptions(IndicesOptions.lenientExpandOpen()); <a id="CO106-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO106-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Setting <code class="literal">IndicesOptions</code> controls how unavailable indices are resolved and
how wildcard expressions are expanded
</p></td></tr></table></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">searchRequest.preference("_local"); <a id="CO107-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO107-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Use the preference parameter e.g. to execute the search to prefer local
shards. The default is to randomize across shards.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_using_the_searchsourcebuilder"></a>Using the SearchSourceBuilder<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>Most options controlling the search behavior can be set on the
<code class="literal">SearchSourceBuilder</code>,
which contains more or less the equivalent of the options in the search request
body of the Rest API.</p><p>Here are a few examples of some common options:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchSourceBuilder sourceBuilder = new SearchSourceBuilder(); <a id="CO108-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
sourceBuilder.query(QueryBuilders.termQuery("user", "kimchy")); <a id="CO108-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
sourceBuilder.from(0); <a id="CO108-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
sourceBuilder.size(5); <a id="CO108-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
sourceBuilder.timeout(new TimeValue(60, TimeUnit.SECONDS)); <a id="CO108-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO108-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Create a <code class="literal">SearchSourceBuilder</code> with default options.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO108-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set the query. Can be any type of <code class="literal">QueryBuilder</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO108-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set the <code class="literal">from</code> option that determines the result index to start searching
from. Defaults to 0.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO108-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set the <code class="literal">size</code> option that determines the number of search hits to return.
Defaults to 10.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO108-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set an optional timeout that controls how long the search is allowed to
take.
</p></td></tr></table></div><p>After this, the <code class="literal">SearchSourceBuilder</code> only needs to be added to the
<code class="literal">SearchRequest</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchRequest searchRequest = new SearchRequest();
searchRequest.source(sourceBuilder);</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_specifying_sorting"></a>Specifying Sorting<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>The <code class="literal">SearchSourceBuilder</code> allows to add one or more <code class="literal">SortBuilder</code> instances. There are four special implementations (Field-, Score-, GeoDistance- and ScriptSortBuilder).</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">sourceBuilder.sort(new ScoreSortBuilder().order(SortOrder.DESC)); <a id="CO109-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
sourceBuilder.sort(new FieldSortBuilder("_uid").order(SortOrder.ASC));  <a id="CO109-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO109-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Sort descending by <code class="literal">_score</code> (the default)
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO109-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Also sort ascending by <code class="literal">_id</code> field
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_source_filtering"></a>Source filtering<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>By default, search requests return the contents of the document <code class="literal">_source</code> but like in the Rest API you can overwrite this behavior. For example, you can turn off <code class="literal">_source</code> retrieval completely:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">sourceBuilder.fetchSource(false);</pre></div><p>The method also accepts an array of one or more wildcard patterns to control which fields get included or excluded in a more fine grained way:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">String[] includeFields = new String[] {"title", "user", "innerObject.*"};
String[] excludeFields = new String[] {"_type"};
sourceBuilder.fetchSource(includeFields, excludeFields);</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="java-rest-high-request-highlighting"></a>Requesting Highlighting<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>Highlighting search results can be achieved by setting a <code class="literal">HighlightBuilder</code> on the
<code class="literal">SearchSourceBuilder</code>. Different highlighting behaviour can be defined for each
fields by adding one or more <code class="literal">HighlightBuilder.Field</code> instances to a <code class="literal">HighlightBuilder</code>.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();
HighlightBuilder highlightBuilder = new HighlightBuilder(); <a id="CO110-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
HighlightBuilder.Field highlightTitle =
        new HighlightBuilder.Field("title"); <a id="CO110-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
highlightTitle.highlighterType("unified");  <a id="CO110-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
highlightBuilder.field(highlightTitle);  <a id="CO110-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
HighlightBuilder.Field highlightUser = new HighlightBuilder.Field("user");
highlightBuilder.field(highlightUser);
searchSourceBuilder.highlighter(highlightBuilder);</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO110-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Creates a new <code class="literal">HighlightBuilder</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO110-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Create a field highlighter for the <code class="literal">title</code> field
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO110-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set the field highlighter type
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO110-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Add the field highlighter to the highlight builder
</p></td></tr></table></div><p>There are many options which are explained in detail in the Rest API documentation. The Rest
API parameters (e.g. <code class="literal">pre_tags</code>) are usually changed by
setters with a similar name (e.g. <code class="literal">#preTags(String ...)</code>).</p><p>Highlighted text fragments can <a class="link" href="java-rest-high-search.html#java-rest-high-retrieve-highlighting" title="Retrieving Highlighting">later be retrieved</a> from the <code class="literal">SearchResponse</code>.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_requesting_aggregations"></a>Requesting Aggregations<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>Aggregations can be added to the search by first creating the appropriate
<code class="literal">AggregationBuilder</code> and then setting it on the <code class="literal">SearchSourceBuilder</code>. In the
following example we create a <code class="literal">terms</code> aggregation on company names with a
sub-aggregation on the average age of employees in the company:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();
TermsAggregationBuilder aggregation = AggregationBuilders.terms("by_company")
        .field("company.keyword");
aggregation.subAggregation(AggregationBuilders.avg("average_age")
        .field("age"));
searchSourceBuilder.aggregation(aggregation);</pre></div><p>We will later see how to <a class="link" href="java-rest-high-search.html#java-rest-high-retrieve-aggs" title="Retrieving Aggregations">access aggregations</a> in the <code class="literal">SearchResponse</code>.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_requesting_suggestions"></a>Requesting Suggestions<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>To add Suggestions to the search request, use one of the <code class="literal">SuggestionBuilder</code> implementations
that are easily accessible from the <code class="literal">SuggestBuilders</code> factory class. Suggestion builders
need to be added to the top level <code class="literal">SuggestBuilder</code>, which itself can be set on the  <code class="literal">SearchSourceBuilder</code>.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();
SuggestionBuilder termSuggestionBuilder =
    SuggestBuilders.termSuggestion("user").text("kmichy"); <a id="CO111-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
SuggestBuilder suggestBuilder = new SuggestBuilder();
suggestBuilder.addSuggestion("suggest_user", termSuggestionBuilder); <a id="CO111-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
searchSourceBuilder.suggest(suggestBuilder);</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO111-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Creates a new <code class="literal">TermSuggestionBuilder</code> for the <code class="literal">user</code> field and
the text <code class="literal">kmichy</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO111-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Adds the suggestion builder and names it <code class="literal">suggest_user</code>
</p></td></tr></table></div><p>We will later see how to <a class="link" href="java-rest-high-search.html#java-rest-high-retrieve-suggestions" title="Retrieving Suggestions">retrieve suggestions</a> from the
<code class="literal">SearchResponse</code>.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="java-rest-high-document-search-sync"></a>Synchronous Execution<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>When executing a <code class="literal">SearchRequest</code> in the following manner, the client waits
for the <code class="literal">SearchResponse</code> to be returned before continuing with code execution:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchResponse searchResponse = client.search(searchRequest);</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="java-rest-high-document-search-async"></a>Asynchronous Execution<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Executing a <code class="literal">SearchRequest</code> can also be done in an asynchronous fashion so that
the client can return directly. Users need to specify how the response or
potential failures will be handled by passing in appropriate listeners:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">client.searchAsync(searchRequest, new ActionListener&lt;SearchResponse&gt;() {
    @Override
    public void onResponse(SearchResponse searchResponse) {
        <a id="CO112-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    }

    @Override
    public void onFailure(Exception e) {
        <a id="CO112-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
    }
});</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO112-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Called when the execution is successfully completed.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO112-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Called when the whole <code class="literal">SearchRequest</code> fails.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_searchresponse"></a>SearchResponse<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The <code class="literal">SearchResponse</code> that is returned by executing the search provides details
about the search execution itself as well as access to the documents returned.
First, there is useful information about the request execution itself, like the
HTTP status code, execution time or wether the request terminated early or timed
out:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">RestStatus status = searchResponse.status();
TimeValue took = searchResponse.getTook();
Boolean terminatedEarly = searchResponse.isTerminatedEarly();
boolean timedOut = searchResponse.isTimedOut();</pre></div><p>Second, the response also provides information about the execution on the
shard level by offering statistics about the total number of shards that were
affected by the search, and the successful vs. unsuccessful shards. Possible
failures can also be handled by iterating over an array off
<code class="literal">ShardSearchFailures</code> like in the following example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">int totalShards = searchResponse.getTotalShards();
int successfulShards = searchResponse.getSuccessfulShards();
int failedShards = searchResponse.getFailedShards();
for (ShardSearchFailure failure : searchResponse.getShardFailures()) {
    // failures should be handled here
}</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="java-rest-high-retrieve-searchHits"></a>Retrieving SearchHits<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>To get access to the returned documents, we need to first get the <code class="literal">SearchHits</code>
contained in the response:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchHits hits = searchResponse.getHits();</pre></div><p>The <code class="literal">SearchHits</code> provides global information about all hits, like total number
of hits or the maximum score:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">long totalHits = hits.getTotalHits();
float maxScore = hits.getMaxScore();</pre></div><p>Nested inside the <code class="literal">SearchHits</code> are the individual search results that can
be iterated over:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchHit[] searchHits = hits.getHits();
for (SearchHit hit : searchHits) {
    // do something with the SearchHit
}</pre></div><p>The <code class="literal">SearchHit</code> provides access to basic information like index, type, docId and
score of each search hit:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">String index = hit.getIndex();
String type = hit.getType();
String id = hit.getId();
float score = hit.getScore();</pre></div><p>Furthermore, it lets you get back the document source, either as a simple
JSON-String or as a map of key/value pairs. In this map, regular fields
are keyed by the field name and contain the field value. Multi-valued fields are
returned as lists of objects, nested objects as another key/value map. These
cases need to be cast accordingly:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">String sourceAsString = hit.getSourceAsString();
Map&lt;String, Object&gt; sourceAsMap = hit.getSourceAsMap();
String documentTitle = (String) sourceAsMap.get("title");
List&lt;Object&gt; users = (List&lt;Object&gt;) sourceAsMap.get("user");
Map&lt;String, Object&gt; innerObject = (Map&lt;String, Object&gt;) sourceAsMap.get("innerObject");</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="java-rest-high-retrieve-highlighting"></a>Retrieving Highlighting<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>If <a class="link" href="java-rest-high-search.html#java-rest-high-request-highlighting" title="Requesting Highlighting">requested</a>, highlighted text fragments can be retrieved from each <code class="literal">SearchHit</code> in the result. The hit object offers
access to a map of field names to <code class="literal">HighlightField</code> instances, each of which contains one
or many highlighted text fragments:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">SearchHits hits = searchResponse.getHits();
for (SearchHit hit : hits.getHits()) {
    Map&lt;String, HighlightField&gt; highlightFields = hit.getHighlightFields();
    HighlightField highlight = highlightFields.get("title"); <a id="CO113-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    Text[] fragments = highlight.fragments();  <a id="CO113-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
    String fragmentString = fragments[0].string();
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO113-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Get the highlighting for the <code class="literal">title</code> field
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO113-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Get one or many fragments containing the highlighted field content
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="java-rest-high-retrieve-aggs"></a>Retrieving Aggregations<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>Aggregations can be retrieved from the <code class="literal">SearchResponse</code> by first getting the
root of the aggregation tree, the <code class="literal">Aggregations</code> object, and then getting the
aggregation by name.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Aggregations aggregations = searchResponse.getAggregations();
Terms byCompanyAggregation = aggregations.get("by_company"); <a id="CO114-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
Bucket elasticBucket = byCompanyAggregation.getBucketByKey("Elastic"); <a id="CO114-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
Avg averageAge = elasticBucket.getAggregations().get("average_age"); <a id="CO114-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
double avg = averageAge.getValue();</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO114-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Get the <code class="literal">by_company</code> terms aggregation
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO114-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Get the buckets that is keyed with <code class="literal">Elastic</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO114-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Get the <code class="literal">average_age</code> sub-aggregation from that bucket
</p></td></tr></table></div><p>Note that if you access aggregations by name, you need to specify the
aggregation interface according to the type of aggregation you requested,
otherwise a <code class="literal">ClassCastException</code> will be thrown:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Range range = aggregations.get("by_company"); <a id="CO115-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO115-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
This will throw an exception because "by_company" is a <code class="literal">terms</code> aggregation
but we try to retrieve it as a <code class="literal">range</code> aggregation
</p></td></tr></table></div><p>It is also possible to access all aggregations as a map that is keyed by the
aggregation name. In this case, the cast to the proper aggregation interface
needs to happen explicitly:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Map&lt;String, Aggregation&gt; aggregationMap = aggregations.getAsMap();
Terms companyAggregation = (Terms) aggregationMap.get("by_company");</pre></div><p>There are also getters that return all top level aggregations as a list:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">List&lt;Aggregation&gt; aggregationList = aggregations.asList();</pre></div><p>And last but not least you can iterate over all aggregations and then e.g.
decide how to further process them based on their type:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">for (Aggregation agg : aggregations) {
    String type = agg.getType();
    if (type.equals(TermsAggregationBuilder.NAME)) {
        Bucket elasticBucket = ((Terms) agg).getBucketByKey("Elastic");
        long numberOfDocs = elasticBucket.getDocCount();
    }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="java-rest-high-retrieve-suggestions"></a>Retrieving Suggestions<a href="https://github.com/elastic/elasticsearch/edit/6.0/docs/java-rest/high-level/apis/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>To get back the suggestions from a <code class="literal">SearchResponse</code>, use the <code class="literal">Suggest</code> object as an entry point and then retrieve the nested suggestion objects:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Suggest suggest = searchResponse.getSuggest(); <a id="CO116-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
TermSuggestion termSuggestion = suggest.getSuggestion("suggest_user"); <a id="CO116-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
for (TermSuggestion.Entry entry : termSuggestion.getEntries()) { <a id="CO116-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
    for (TermSuggestion.Entry.Option option : entry) { <a id="CO116-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
        String suggestText = option.getText().string();
    }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO116-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Use the <code class="literal">Suggest</code> class to access suggestions
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO116-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Suggestions can be retrieved by name. You need to assign them to the correct
type of Suggestion class (here <code class="literal">TermSuggestion</code>), otherwise a <code class="literal">ClassCastException</code> is thrown
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO116-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Iterate over the suggestion entries
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO116-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Iterate over the options in one entry
</p></td></tr></table></div></div></div></div><div class="navfooter"><span class="prev"><a href="java-rest-high-document-bulk.html">
              « 
              Bulk API</a>
           
        </span><span class="next">
           
          <a href="java-rest-high-search-scroll.html">Search Scroll API
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
					<div id="rtpcontainer" style="display: block;">
						<h3>Top Videos</h3>
						<ul>
							<li><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Elasticsearch Demo</a></li>
							<li><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Kibana 101</a></li>
							<li><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Primer</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</section>

        </div>
      	


<div id="footer-subscribe" class="home-footer-subscribe">
  <div class="subscribe-wrapper">
    <div class="container">
      <div class="subscribe-form-container">
        <div class="subscribe-title col-md-12 col-lg-6">
            <h5>Be in the know with the latest and greatest from Elastic.</h5>
        </div>
        <div class="subscribe-form col-md-12 col-lg-6">
          <form id="mktoForm_1398" class="mktoForm sb-form"></form>
        </div>
      </div>
      <div class="form_thanks hide">
        
          <p>Thanks for subscribing! We'll keep you updated with new releases.</p>
        
      </div>
    </div>
  </div>
</div>
<!--subscribe newsletter end-->

<!-- Footer Section -->
<footer class="footer-wrapper">
  <div class="container">
    <div class="row footer-content">
        
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/products">Products ></a></h3>
              
              <ul>
              
                
                  
                    <li><a href="/products/elasticsearch">Elasticsearch</a></li>
                  
                
              
                
                  
                    <li><a href="/products/kibana">Kibana</a></li>
                  
                
              
                
                  
                    <li><a href="/products/beats">Beats</a></li>
                  
                
              
                
                  
                    <li><a href="/products/logstash">Logstash</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack">X-Pack</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud">Elastic Cloud</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/security">Security (formerly Shield)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/alerting">Alerting (via Watcher)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/monitoring">Monitoring (formerly Marvel)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/graph">Graph</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/reporting">Reporting</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/machine-learning">Machine Learning</a></li>
                  
                
              
                
                  
                    <li><a href="/products/hadoop">ES-Hadoop</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3>Resources</h3>
              
              <ul>
              
                
                  
                    <li><a href="/blog">Blog</a></li>
                  
                
              
                
                  
                    <li><a href="https://cloud-status.elastic.co">Cloud Status</a></li>
                  
                
              
                
                  
                    <li><a href="/community">Community</a></li>
                  
                
              
                
                  
                    <li><a href="/use-cases">Customers & Use Cases</a></li>
                  
                
              
                
                  
                    <li><a href="/guide">Documentation</a></li>
                  
                
              
                
                  
                    <li><a href="/elasticon">Elastic{ON} Events</a></li>
                  
                
              
                
                  
                    <li><a href="https://discuss.elastic.co/">Forums</a></li>
                  
                
              
                
                  
                    <li><a href="/community/meetups">Meetups</a></li>
                  
                
              
                
                  
                    <li><a href="/subscriptions">Subscriptions</a></li>
                  
                
              
                
                  
                    <li><a href="https://support.elastic.co">Support Portal</a></li>
                  
                
              
                
                  
                    <li><a href="/videos">Videos & Webinars</a></li>
                  
                
              
                
                  
                    <li><a href="/training">Training</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/about">About ></a></h3>
              
              <ul>
              
                
                  
                    <li><a href="/about/careers">Careers/Jobs</a></li>
                  
                
              
                
                  
                    <li><a href="/contact">Contact</a></li>
                  
                
              
                
                  
                    <li><a href="/about/leadership">Leadership</a></li>
                  
                
              
                
                  
                    <li><a href="/about/partners">Partners</a></li>
                  
                
              
                
                  
                    <li><a href="/about/press">Press</a></li>
                  
                
              
                
                  
                    <li><a href="https://www.elastic.shop">Elastic Store</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3>Language</h3>
              
              <ul>
              
                
                  <li><a href="/" data-value="/">English</a></li>
                
              
                
                  <li><a href="/fr/" data-value="/fr/">Français</a></li>
                
              
                
                  <li><a href="/de/" data-value="/de/">Deutsch</a></li>
                
              
                
                  <li><a href="/jp/" data-value="/jp/">日本語</a></li>
                
              
                
                  <li><a href="/kr/" data-value="/kr/">한국어</a></li>
                
              
                
                  <li><a href="/cn/" data-value="/cn/">简体中文</a></li>
                
              
              </ul>
          </div>    
       
    </div>
     <!-- Social Media Section -->
    <div class="row social-icon">
      <div class="col-xs-12 col-sm-12 col-md-12">
        <p class="text-center font-size-10 m-0">FOLLOW US</p>
        <ul>
          
          <li class="facebook"><a id="footer_facebook" href="http://www.facebook.com/elastic.co"></a></li>
          
          <li class="twitter"><a id="footer_twitter" href="https://www.twitter.com/elastic"></a></li>
          
          <li class="linkedin"><a id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co"></a></li>
          
          <li class="xing"><a id="footer_xing" href="https://www.xing.com/companies/elastic.co"></a></li>
          
          <li class="youtube"><a id="footer_youtube" href="https://www.youtube.com/user/elasticsearch"></a></li>
          
        </ul>
      </div>
    </div>
    <!-- Social Media Section end-->
    <div class="row">
	<div class="col-xs-12 col-sm-12 col-md-12">
		<div class="copyright">
			<ul>
				<li><a href="/legal/trademarks">Trademarks</a></li>
				<li><a href="/legal/terms-of-use">Terms of Use</a></li>
				<li><a href="/legal/privacy-policy">Privacy</a></li>
				<li><a href="/legal/privacy-and-cookie-policy">Cookie Policy</a></li>
				<li><a href="/brand">Brand</a></li>
			</ul>
			<div class="copyright-content">
				<div class="footer-logo"><a href="/"><img src="/static/images/svg/logo-elastic-footer.svg" class="img-responsive"></a>
				</div>
				<div class="footer-text">
					<p>© 2017. All Rights Reserved - Elasticsearch
					</p>
					<p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries
					</p>
					<p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other countries.
					</p>
				</div>
			</div>
		</div>
	</div>
</div>
  </div>
</footer>
<!-- Footer Section end-->

<style type="text/css">
	
    
		.facebook{background:url("https://static-www.elastic.co/assets/bltf546ff2e0a8f2de5/facebook.svg?q=540") no-repeat;}
    
    
      .facebook:hover {background:url("https://static-www.elastic.co/assets/bltc24cf11c714ecfc4/facebook-hover.svg?q=540")}		
    
	
    
		.twitter{background:url("https://static-www.elastic.co/assets/bltdd9556d6b24e2b85/twitter.svg?q=540") no-repeat;}
    
    
      .twitter:hover {background:url("https://static-www.elastic.co/assets/blt90b0372cc07a54d3/twitter-hover.svg?q=540")}		
    
	
    
		.linkedin{background:url("https://static-www.elastic.co/assets/bltc4a77e0f52ce07f1/linkedin.svg?q=540") no-repeat;}
    
    
      .linkedin:hover {background:url("https://static-www.elastic.co/assets/blt01ce654380e4ea6c/linkedin-hover.svg?q=540")}		
    
	
    
		.xing{background:url("https://static-www.elastic.co/assets/bltc6347078dcc9ec76/xing.svg?q=540") no-repeat;}
    
    
      .xing:hover {background:url("https://static-www.elastic.co/assets/bltededebe5f7521a39/xing-hover.svg?q=540")}		
    
	
    
		.youtube{background:url("https://static-www.elastic.co/assets/blt4982061ce1aebc7f/youtube.svg?q=540") no-repeat;}
    
    
      .youtube:hover {background:url("https://static-www.elastic.co/assets/bltddeb6c6404ae81a5/youtube-hover.svg?q=540")}		
    
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
  MktoForms2.whenReady(function (form) {
  //    // Put your code that uses the form object here
  //   $('#Email').attr("placeholder","Email Address");
  //   $('#FirstName').attr("placeholder","First Name");
  //   $('#LastName').attr("placeholder","Last Name");
  //   $('#Form_Message').attr("placeholder","Tell us in your words");
  // // ========================End Mktoform placeholder==================
  });

  MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
    form.onSuccess(function(form){
      $('#mktoForm_1398').css('display','none');
      $('.subscribe-wrapper .subscribe-form-container').hide();
      $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
      dataLayer.push({'event': 'mktoFormSubmit'});
        return false;
      });
  });
</script>
      </section>
    </div>
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","url":"/guide_template"}';
</script>
<script src="https://static-www.elastic.co/static/js/jquery.autocomplete.js?q=540"></script>
<script type="text/javascript" src="https://static-www.elastic.co/static/js/slick.min.js?q=540"></script>
<script src="https://static-www.elastic.co/static/js/nav-v5.js?q=540"></script>
<script src="https://static-www.elastic.co/static/js/script.js?q=540"></script> 
     
<script type="text/javascript">
$(document).ready(function(){
	if (window.location.hash.length) {
	      var target = $(window.location.hash);
	      target = target.length ? target : $(window.location.hash);
	      if (target.length) {
	        setTimeout(function(){ $(window).scrollTop(target.offset().top - 60); }, 1200);        
	      }
	}
	$('#guide').on('click','a[href*=#]:not([href=#])',function(e) {
			var flag=true;
		      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
		          var target = $(this.hash);
		          target = target.length ? target :$(this.hash);
		          if (target.length) {
		            if(flag){
		              flag=false;
		              var heightScroll=($('.tertiary-nav.navbar-fixed-top').height())?60:110;
		              $('html,body').animate({
		                  scrollTop: target.offset().top - heightScroll
		                }, 2000, function(){
		                  flag=true;
		                });
		            }                    
		          }
		      }
		    
	});

})

</script>

     <style></style>
     
  
            <script type="text/javascript" src="docs.js"></script>
<script type='text/javascript' src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=yaml'></script>

            </body>
        
</html>