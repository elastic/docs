<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Public API
        | APM Java Agent Reference [master]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="APM Java Agent Reference [master]" /><link rel="up" href="index.html" title="APM Java Agent Reference [master]" /><link rel="prev" href="faq.html" title="Frequently Asked Questions" /><link rel="next" href="opentracing-bridge.html" title="Elastic APM OpenTracing bridge" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/APM Java Agent/Reference/master" /><meta name="DC.subject" content="APM" /><meta name="DC.identifier" content="master" />
    

    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
<meta name="apple-mobile-web-app-title" content="Elastic">
<meta name="application-name" content="Elastic">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">
<meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
<meta name="yandex-verification" content="d8a47e95d0972434" />
<!-- DC tags section -->
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
<link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >



	



<!-- end DC tags -->


	<meta name="description" content="" />



	<meta name="localized" content="true" />


















		
			<meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
		

		

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">

	 

    <!-- css -->
    <link href="/static/css/main.css" rel="stylesheet">
    
    

    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  <script type="text/javascript">
  // -------------------- set language based on browser language --------------------
  var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
      locales = {
        '/en':'/',
        '/de/': '/de/',
        '/fr/': '/fr/',
        '/ja/':'/jp/',
        '/ko/':'/kr/',
        '/zh/':'/cn/',
        '/es/': '/es/'
      },
      localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}',
      currentlocale = JSON.parse(localeUrl).relative_url_prefix;

  if($.cookie("is_lang_detected") == undefined){
    if(locales[lang] != undefined && locales[lang] != currentlocale){
      locale_lang_url = locales[lang] + window.location.pathname.slice(1,window.location.pathname.length);
      $.cookie("is_lang_detected",true ,{ path: '/'}); 
      window.location = locale_lang_url;
    } 
  }
        
  // --------------------- end of set language based on browser language -----------------
  </script>

  

	
	<link type="text/css" rel="stylesheet" href="/static/css/guide.css" />


  
<link rel="stylesheet" type="text/css" href="styles.css" />

</head>
  <body >
  	<!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
                              height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
<script src="/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>


<script type="text/javascript">
  var active;
  
  active = Math.random() < 1 //0.9 
  
  elasticApm.init({
    active: active,
    serviceName: "elastic-co-frontend",
    serverUrl: "https://elastic-co-apm-server.app.elstc.co"
  })

  var pageLoadName
  var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
  var parts = pathname.split('/');

  if (parts.length && parts[1] === 'blog') {
    if (parts.length === 2) {
      pageLoadName =  '/blog';
    }
    else if (parts[2] === 'category') {
      pageLoadName =  '/blog/category';
    }
    else if (parts[2] === 'archive') {
      pageLoadName =  '/blog/archive';
    }
    else {
      pageLoadName =  '/blog/detail';
    }
  }
  else if (parts.length && parts[1] === 'elasticon') {
    if (parts.length === 2) {
      pageLoadName =  '/elasticon';
    }
    else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
      pageLoadName =  '/elasticon/overview';
    }
    else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
      pageLoadName =  '/elasticon/video';
    }
  }
  else if (parts.length && parts[1] === 'guide') {
    pageLoadName =  '/guide';
  }
  else if (parts.length === 2 && parts[1] === 'videos') {
    pageLoadName =  '/videos';
  }
  else if (parts.length > 2 && parts[1] === 'videos') {
    pageLoadName =  '/videos/detail';
  }
  else if (parts.length > 2 && parts[1] === 'webinars') {
    pageLoadName =  '/webinars/detail';
  }
  else {
    pageLoadName =  window.location.pathname;
  }

  console.log('apm pageLoadName:', pageLoadName, parts)
  elasticApm.setTags({env:"production"});
  elasticApm.setInitialPageLoadName(pageLoadName);
</script>

<!-- Elastic APM -->


    <!-- Header Section -->
    
<header class="header-wrapper">
  



  




<div class="navigation-wrapper">
  <div class="container">
    <nav class="navbar">
    <!-- Brand and toggle get grouped for better mobile display -->

    <div class="navbar-mobile-header navbar-header mr-20 mr-xs-0">
      <div class="row hidden-sm hidden-md hidden-lg">
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg">
          <div class="navbar-mobile-header-icon navbar-mobile-header-icon-out">
            <span></span>
            <span></span>
            <span></span>
          </div>
          
        </div>
        <div class="col-xs-2 text-center">
          <div class="navbar-brand" id="elastic">
            <div id="logo">
              <a class="logo-m hidden-sm hidden-md hidden-lg" href="/">
                <img src="/assets/blta09706b1c5cc1e99/elastic-logo-mobile.svg" alt="elastic-logo-mobile">
              </a>
            </div>
          </div>
        </div>
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right">
          <ul class="menu-m hidden-sm hidden-md hidden-lg">
            <li class=""><a class="icon-contact" href="/contact"></a></li>

            <li id="searchbar"><a class="button icon" href="#" alt="Search"></a></li>
            <li class="lang global-language">
                
                  
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              <ul class="language-list">
                
                  
                    
                  
                  
                  <li><a href="/de/" data-value="/de/" id="locale-select">Deutsch</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="#" data-value="/" id="locale-select">English</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="/es/" data-value="/es/" id="locale-select">Español</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="/fr/" data-value="/fr/" id="locale-select">Français</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="/jp/" data-value="/jp/" id="locale-select">日本語</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="/kr/" data-value="/kr/" id="locale-select">한국어</a></li>
                  
                
                  
                    
                  
                  
                  <li><a href="/cn/" data-value="/cn/" id="locale-select">简体中文</a></li>
                  
                
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <div class="navbar-brand hidden-xs" id="elastic">
        <div id="logo">
          <a class="hidden-xs" id="elastic-logo" href="/">
            <img src="/assets/blt244a845f141977c3/elastic-logo.svg" alt="elastic-logo">
          </a>
        </div>
      </div>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse mobile-inner-nav">
      <nav class="nav navbar-nav primary-nav-hover" id="nav">
        <ul>
        
          
            
              
            
            <li>
              <a class=" " href="/products">Products</a>
            </li>
          
        
          
            
              
            
            <li>
              <a class=" " href="/cloud">Cloud</a>
            </li>
          
        
          
            
              
            
            <li>
              <a class=" " href="/services">Services</a>
            </li>
          
        
          
            
              
            
            <li>
              <a class=" " href="/use-cases">Customers</a>
            </li>
          
        
          
            
              
            
            <li>
              <a class=" " href="/learn">Learn</a>
            </li>
          
        
          
        
        </ul>
      </nav>
      <nav class="nav navbar-nav navbar-right hidden-xs">
        <ul>
          <li class="hidden-xs hidden-sm"><a href="/downloads">downloads</a></li>
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li>
          <!-- To set parameters to contact button -->
          
           
            
          

          
            
            
          
          <li class="hidden-xs hidden-sm"><a class="btn btn-secondary btn-contact" href="/contact?storm=global-header-en">contact</a></li>
          <!-- ////////////////ends here///////////////-->          
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact?storm=global-header-en"></a></li>
          <li class="hidden-xs" id="searchbar"><a class="button icon" href="#" alt="Search"></a></li>

          <li class="hidden-xs lang global-language">
                
                  
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
               <ul class="language-list">
              
                
                  
                
              
              <li><a class="" href="/de/" data-value="/de/">Deutsch</a></li>
              
              
                
                  
                
              
              <li><a class="" href="#" data-value="/">English</a></li>
              
              
                
                  
                
              
              <li><a class="" href="/es/" data-value="/es/">Español</a></li>
              
              
                
                  
                
              
              <li><a class="" href="/fr/" data-value="/fr/">Français</a></li>
              
              
                
                  
                
              
              <li><a class="" href="/jp/" data-value="/jp/">日本語</a></li>
              
              
                
                  
                
              
              <li><a class="" href="/kr/" data-value="/kr/">한국어</a></li>
              
              
                
                  
                
              
              <li><a class="" href="/cn/" data-value="/cn/">简体中文</a></li>
              
              
            </ul>
          </li>
        </ul>
      </nav>
    </div><!-- /.navbar-collapse -->
  </nav>
  </div>
</div>

<div class="header-search-wrapper open-search"> 
  <div class="container">
    <div class="big-search">
      <i class="big-search-icon"></i>
      <form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get">
        <ul class="tags-wrapper">
          <li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li>
        </ul>
      </form>
      <a class="header-search-cancel" href="#"></a>
    </div>
    <div class="nav-auto-complete"></div>
  </div>
</div>
</header>
<link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">
<style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
    
</style>
<script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>
<script type="text/javascript">
  $(document).ready( function(){
    // if($('#scrollable-pane li').length > 3){
      $('.horizon-swiper').horizonSwiper({
        showItems: 3,
        arrows: true
      }); 
    // }
    
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
    });

    var active_url = "";

    $(".navbar-mobile-header-icon").click(function(index){
      $('.navigation-wrapper').toggleClass('menu-overlay');
      $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
      $(".mobile-inner-nav").slideToggle(500);
      $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
        $(this).css({'animation-delay': (index/25)+'0.4s'});
      });
    });

    $('.dropdown-btn').on('click', function(e){
      e.preventDefault();
      setDropdown();
    });
    
    function setDropdown() {
      $('#myDropdown').slideToggle();
    }

    $('body').on('click', function(event){
      if (!event.target.matches('.dropdown-btn')) {

        var dropdowns = $(".dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    });

    // if($(window).width() < 769){
    //   var $item = $('.scrollable-panel li'), 
    //       visible = 3, //Set the number of items that will be visible
    //       index = 0, //Starting index
    //       endIndex = ( $item.length / visible ) - 1; //End index (NOTE:: Requires visible to be a factor of $item.length... You can improve this by rounding...)

    //   $('#right-arrow').click(function(){
    //     if(index < endIndex ){
    //       index++;
    //       $item.animate({'left':'-=300px'});
    //     }
    //   });

    //   $('#left-arrow').click(function(){
    //     if(index > 0){
    //       index--;            
    //       $item.animate({'left':'+=300px'});
    //     }
    //   });
    // }
  });
  $(window).resize(function () {
    $('.horizon-swiper').horizonSwiper({
      showItems: 3,
      arrows: true
    });
  });
</script>
    
      


  





  
  
  
  
    <div class="tertiary-nav bdr-btm-e0e0e0">
      <div class="container">
        <div class="p-t-b-15 clearfix">
          <div class="breadcrum-wrapper pull-left text-left">
          
            <a href="/guide">Docs</a> 
          
          </div>
          
          
          
        </div>
      </div>
    </div>

    <div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg bdr-btm-e0e0e0 clearfix">
      <div class="container text-right">
        <div class="breadcrum-wrapper pull-left text-left">
          
              <a href="/guide">Docs</a>
          
        </div>
        
        
      </div>
    </div>
  


<style type="text/css">

  
</style>
    
    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   
          
            
        			<!-- <div class="pageheader">
	<div class="common-container">
		
			<h2 class="page-title">Guide template</h2>
		
	</div>
</div> -->


        		
          

          
	<section id="guide" lang="en">
		<div class="container">
			<div class="row">
			  <!-- start body -->
				
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">APM Java Agent Reference
      [master]
    </a></span> » <span class="breadcrumb-node">Public API</span></div><div class="navheader"><span class="prev"><a href="faq.html">
              « 
              Frequently Asked Questions</a>
           
        </span><span class="next">
           
          <a href="opentracing-bridge.html">Elastic APM OpenTracing bridge
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="public-api"></a>Public API<a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h1></div></div></div><p>The public API of the Elastic APM Java agent lets you
customize and manually create spans and transactions,
as well as track errors.</p><p>The first step in getting started with the API is to declare a dependency to the API:</p><p><strong>pom.xml. </strong>
</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;co.elastic.apm&lt;/groupId&gt;
    &lt;artifactId&gt;apm-agent-api&lt;/artifactId&gt;
    &lt;version&gt;${elastic-apm.version}&lt;/version&gt;
&lt;/dependency&gt;</pre></div><p>
</p><p><strong>build.gradle. </strong>
</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-groovy">compile "co.elastic.apm:apm-agent-api:$elasticApmVersion"</pre></div><p>
</p><p>Replace the version placeholders with the
<a class="ulink" href="https://search.maven.org/search?q=g:co.elastic.apm%20AND%20a:apm-agent-api" target="_top">
latest version from maven central</a>:
<span class="inlinemediaobject"><img src="https://img.shields.io/maven-central/v/co.elastic.apm/apm-agent-api.svg" alt="Maven Central" /></span></p><h3><a id="api-tracer-api"></a>Tracer API<a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The tracer gives you access to the currently active transaction and span.
It can also be used to track an exception.</p><p>To use the API, you can just invoke the static methods on the class <code class="literal">co.elastic.apm.api.ElasticApm</code>.</p><h4><a id="api-current-transaction"></a><code class="literal">Transaction currentTransaction()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Returns the currently active transaction.
See <a class="xref" href="public-api.html#api-transaction" title="Transaction APIedit">Transaction API<a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> on how to customize the current transaction.</p><p>If there is no current transaction,
this method will return a noop transaction,
which means that you never have to check for <code class="literal">null</code> values.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import co.elastic.apm.api.ElasticApm;
import co.elastic.apm.api.Transaction;

Transaction transaction = ElasticApm.currentTransaction();</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Transactions created via <a class="link" href="public-api.html#api-start-transaction" title="Transaction startTransaction()edit"><code class="literal">ElasticApm.startTransaction()</code></a>
can not be retrieved by calling this method.
See <a class="link" href="public-api.html#api-span-activate" title="Scope activate()edit"><code class="literal">span.activate()</code></a> on how to achieve that.</p></div></div><h4><a id="api-current-span"></a><code class="literal">Span currentSpan()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Returns the currently active span or transaction.
See <a class="xref" href="public-api.html#api-span" title="Span APIedit">Span API<a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> on how to customize the current span.</p><p>If there is no current span,
this method will return a noop span,
which means that you never have to check for <code class="literal">null</code> values.</p><p>Note that even if this method is returning a noop span,
you can still <a class="link" href="public-api.html#api-span-capture-exception" title="void captureException(Exception e)edit">capture exceptions</a> on it.
These exceptions will not have a link to a Span or a Transaction.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">import co.elastic.apm.api.ElasticApm;
import co.elastic.apm.api.Span;

Span span = ElasticApm.currentSpan();</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Spans created via <a class="link" href="public-api.html#api-span-start-span" title="Span startSpan()edit"><code class="literal">startSpan()</code></a> or <a class="link" href="public-api.html#api-span-start-span-with-type" title="Span startSpan(String type, String subtype, String action)edit"><code class="literal">startSpan(String, String, String)</code></a>
can not be retrieved by calling this method.
See <a class="link" href="public-api.html#api-span-activate" title="Scope activate()edit"><code class="literal">span.activate()</code></a> on how to achieve that.</p></div></div><h4><a id="api-start-transaction"></a><code class="literal">Transaction startTransaction()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Use this method to create a custom transaction.</p><p>Note that the agent will do this for you automatically when ever your application receives an incoming HTTP request.
You only need to use this method to create custom transactions.</p><p>It is important to call <a class="xref" href="public-api.html#api-transaction-end" title="void end()edit"><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> when the transaction has ended.
A best practice is to use the transaction in a try-catch-finally block.
Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Transaction transaction = ElasticApm.startTransaction();
try {
    transaction.setName("MyController#myAction");
    transaction.setType(Transaction.TYPE_REQUEST);
    // do your thing...
} catch (Exception e) {
    transaction.captureException(e);
    throw e;
} finally {
    transaction.end();
}</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Transactions created via this method can not be retrieved by calling <a class="link" href="public-api.html#api-current-span" title="Span currentSpan()edit"><code class="literal">ElasticApm.currentSpan()</code></a>
or <a class="link" href="public-api.html#api-current-transaction" title="Transaction currentTransaction()edit"><code class="literal">ElasticApm.currentTransaction()</code></a>.
See <a class="link" href="public-api.html#api-transaction-activate" title="Scope activate()edit"><code class="literal">transaction.activate()</code></a> on how to achieve that.</p></div></div><h4><a id="api-start-transaction-with-remote-parent-header"></a><code class="literal">Transaction startTransactionWithRemoteParent(HeaderExtractor)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Similar to <a class="xref" href="public-api.html#api-start-transaction" title="Transaction startTransaction()edit"><code class="literal">Transaction startTransaction()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> but creates this transaction as the child of a remote parent.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">headerExtractor</code>: a functional interface which receives a header name and returns the fist header with that name
</li></ul></div><p>Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Transaction transaction = ElasticApm.startTransactionWithRemoteParent(request::getHeader);</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If the protocol supports multi-value headers, use <a class="xref" href="public-api.html#api-start-transaction-with-remote-parent-headers" title="Transaction startTransactionWithRemoteParent(HeaderExtractor, HeadersExtractor)edit"><code class="literal">Transaction startTransactionWithRemoteParent(HeaderExtractor, HeadersExtractor)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a></p></div></div><p>since 1.3.0</p><h4><a id="api-start-transaction-with-remote-parent-headers"></a><code class="literal">Transaction startTransactionWithRemoteParent(HeaderExtractor, HeadersExtractor)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Similar to <a class="xref" href="public-api.html#api-start-transaction" title="Transaction startTransaction()edit"><code class="literal">Transaction startTransaction()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> but creates this transaction as the child of a remote parent.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">headerExtractor</code>:  a functional interface which receives a header name and returns the fist header with that name
</li><li class="listitem">
<code class="literal">headersExtractor</code>: a functional interface which receives a header name and returns all headers with that name
</li></ul></div><p>Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Transaction transaction = ElasticApm.startTransactionWithRemoteParent(request::getHeader, request::getHeaders);</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If the protocol does not support multi-value headers, use <a class="xref" href="public-api.html#api-start-transaction-with-remote-parent-header" title="Transaction startTransactionWithRemoteParent(HeaderExtractor)edit"><code class="literal">Transaction startTransactionWithRemoteParent(HeaderExtractor)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a></p></div></div><p>since 1.3.0</p><h3><a id="api-annotation"></a>Annotation API<a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The API comes with two annotations which make it easier to create custom spans and transactions.
Just put the annotations on top of your methods and the agent will take care of creating and reporting the corresponding transaction and spans.
It will also make sure to capture any uncaught exceptions.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>It is required to configure the <a class="xref" href="config-stacktrace.html#config-application-packages" title="application_packagesedit"><code class="literal">application_packages</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/configuration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a>, otherwise these annotations will be ignored.</p></div></div><h4><a id="api-capture-transaction"></a><code class="literal">@CaptureTransaction</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Annotating a method with <code class="literal">@CaptureTransaction</code> creates a transaction for that method.</p><p>Note that this only works when there is no active transaction on the same thread.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">value</code>: The name of the span. Defaults to <code class="literal">ClassName#methodName</code>
</li><li class="listitem">
<code class="literal">type</code>: The type of the transaction. Defaults to <code class="literal">request</code>
</li></ul></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Using this annotation implicitly creates a Transaction and activates it when entering the annotated
method. It also implicitly ends it and deactivates it before exiting the annotated method.
See <a class="link" href="public-api.html#api-start-transaction" title="Transaction startTransaction()edit"><code class="literal">ElasticApm.startTransaction()</code></a>, <a class="link" href="public-api.html#api-transaction-activate" title="Scope activate()edit"><code class="literal">transaction.activate()</code></a>
and <a class="link" href="public-api.html#api-transaction-end" title="void end()edit"><code class="literal">transaction.end()</code></a></p></div></div><h4><a id="api-capture-span"></a><code class="literal">@CaptureSpan</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Annotating a method with <code class="literal">@CaptureSpan</code> creates a span as the child of the currently active span or transaction
(<a class="xref" href="public-api.html#api-current-span" title="Span currentSpan()edit"><code class="literal">Span currentSpan()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a>).</p><p>When there is no current span,
no span will be created.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">value</code>: The name of the span. Defaults to <code class="literal">ClassName#methodName</code>
</li><li class="listitem">
<code class="literal">type</code>: The type of the span, e.g. <code class="literal">db</code> for DB span. Defaults to <code class="literal">app</code>
</li><li class="listitem">
<code class="literal">subtype</code>: The subtype of the span, e.g. <code class="literal">mysql</code> for DB span. Defaults to empty string
</li><li class="listitem">
<code class="literal">action</code>: The action related to the span, e.g. <code class="literal">query</code> for DB spans. Defaults to empty string
</li></ul></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Using this annotation implicitly creates a Span and activates it when entering the annotated
method. It also implicitly ends it and deactivates it before exiting the annotated method.
See <a class="link" href="public-api.html#api-span-start-span" title="Span startSpan()edit"><code class="literal">startSpan()</code></a>, <a class="link" href="public-api.html#api-span-start-span-with-type" title="Span startSpan(String type, String subtype, String action)edit"><code class="literal">startSpan(String, String, String)</code></a>,
<a class="link" href="public-api.html#api-transaction-activate" title="Scope activate()edit"><code class="literal">span.activate()</code></a> and <a class="link" href="public-api.html#api-span-end" title="void end()edit"><code class="literal">span.end()</code></a></p></div></div><h3><a id="api-transaction"></a>Transaction API<a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>A transaction is the data captured by an agent representing an event occurring in a monitored service
and groups multiple spans in a logical group.
A transaction is the first <a class="link" href="public-api.html#api-span" title="Span APIedit"><code class="literal">Span</code></a> of a service, and is also known under the term entry span.</p><p>See <a class="xref" href="public-api.html#api-current-transaction" title="Transaction currentTransaction()edit"><code class="literal">Transaction currentTransaction()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> on how to get a reference of the current transaction.</p><p><code class="literal">Transaction</code> is a sub-type of <code class="literal">Span</code>.
So it has all the methods a <a class="link" href="public-api.html#api-span" title="Span APIedit"><code class="literal">Span</code></a> offers plus additional ones.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Calling any of the transaction’s methods after <a class="xref" href="public-api.html#api-transaction-end" title="void end()edit"><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> has been called is illegal.
You may only interact with transaction when you have control over its lifecycle.
For example, if a span is ended in another thread you must not add tags if there is a chance for a race between the <a class="xref" href="public-api.html#api-transaction-end" title="void end()edit"><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a>
and the <a class="xref" href="public-api.html#api-transaction-add-tag" title="Transaction addTag(String key, String value)edit"><code class="literal">Transaction addTag(String key, String value)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> method.</p></div></div><h4><a id="api-set-name"></a><code class="literal">Transaction setName(String name)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Override the name of the current transaction.
For supported frameworks,
the transaction name is determined automatically,
and can be overridden using this method.</p><p>Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">transaction.setName("My Transaction");</pre></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">name</code>: (required) A string describing name of the transaction
</li></ul></div><h4><a id="api-transaction-set-type"></a><code class="literal">Transaction setType(String type)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Sets the type of the transaction.
There’s a special type called <code class="literal">request</code>,
which is used by the agent for the transactions automatically created when an incoming HTTP request is detected.</p><p>Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">transaction.setType(Transaction.TYPE_REQUEST);</pre></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">type</code>: The type of the transaction
</li></ul></div><h4><a id="api-transaction-add-tag"></a><code class="literal">Transaction addTag(String key, String value)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A flat mapping of user-defined tags with string values.
Note: the tags are indexed in Elasticsearch so that they are searchable and aggregatable.
By all means,
you should avoid that user specified data,
like URL parameters,
is used as a tag key as it can lead to mapping explosions.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">transaction.setTag("foo", "bar");</pre></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">key</code>:   The tag key
</li><li class="listitem">
<code class="literal">value</code>: The tag value
</li></ul></div><h4><a id="api-transaction-set-user"></a><code class="literal">Transaction setUser(String id, String email, String username)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Call this to enrich collected performance data and errors with information about the user/client.
This method can be called at any point during the request/response life cycle (i.e. while a transaction is active).
The given context will be added to the active transaction.</p><p>If an error is captured, the context from the active transaction is used as context for the captured error.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">transaction.setUser(user.getId(), user.getEmail(), user.getUsername());</pre></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">id</code>:       The user’s id or <code class="literal">null</code>, if not applicable.
</li><li class="listitem">
<code class="literal">email</code>:    The user’s email address or <code class="literal">null</code>, if not applicable.
</li><li class="listitem">
<code class="literal">username</code>: The user’s name or <code class="literal">null</code>, if not applicable.
</li></ul></div><h4><a id="api-transaction-capture-exception"></a><code class="literal">void captureException(Exception e)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Captures an exception and reports it to the APM server.</p><h4><a id="api-transaction-get-id"></a><code class="literal">String getId()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Returns the id of this transaction (never <code class="literal">null</code>)</p><p>If this transaction represents a noop,
this method returns an empty string.</p><h4><a id="api-transaction-get-trace-id"></a><code class="literal">String getTraceId()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Returns the trace-id of this transaction.</p><p>The trace-id is consistent across all transactions and spans which belong to the same logical trace,
even for transactions and spans which happened in another service (given this service is also monitored by Elastic APM).</p><p>If this span represents a noop,
this method returns an empty string.</p><h4><a id="api-ensure-parent-id"></a><code class="literal">String ensureParentId()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>If the transaction does not have a parent-ID yet,
calling this method generates a new ID,
sets it as the parent-ID of this transaction,
and returns it as a <code class="literal">String</code>.</p><p>This enables the correlation of the spans the JavaScript Real User Monitoring (RUM) agent creates for the initial page load
with the transaction of the backend service.
If your backend service generates the HTML page dynamically,
initializing the JavaScript RUM agent with the value of this method allows analyzing the time spent in the browser vs in the backend services.</p><p>To enable the JavaScript RUM agent when using an HTML templating language like Freemarker,
add <code class="literal">ElasticApm.currentTransaction()</code> with the key <code class="literal">"transaction"</code> to the model.</p><p>Also, add a snippet similar to this to the body of your HTML page,
preferably before other JS libraries:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-html">&lt;script src="elastic-apm-js-base/dist/bundles/elastic-apm-js-base.umd.min.js"&gt;&lt;/script&gt;
&lt;script&gt;
  elasticApm.init({
    serviceName: "service-name",
    serverUrl: "http://localhost:8200",
    pageLoadTraceId: "${transaction.traceId}",
    pageLoadSpanId: "${transaction.ensureParentId()}",
    pageLoadSampled: ${transaction.sampled}
  })
&lt;/script&gt;</pre></div><p>See the <a class="ulink" href="https://www.elastic.co/guide/en/apm/agent/js-base/current" target="_top">JavaScript RUM agent documentation</a> for more information.</p><h4><a id="api-transaction-start-span-with-type"></a><code class="literal">Span startSpan(String type, String subtype, String action)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Start and return a new span with a type, a subtype and an action, as a child of this transaction.</p><p>The type, subtype and action strings are used to group similar spans together, with different resolution.
For instance, all DB spans are given the type <code class="literal">db</code>; all spans of MySQL queries are given the subtype <code class="literal">mysql</code> and all spans
describing queries are given the action <code class="literal">query</code>.
In this example <code class="literal">db</code> is considered the general type. Though there are no naming restrictions for the general types,
the following are standardized across all Elastic APM agents: <code class="literal">app</code>, <code class="literal">db</code>, <code class="literal">cache</code>, <code class="literal">template</code>, and <code class="literal">ext</code>.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p><span class="emphasis"><em>.</em></span> (dot) character is not allowed within type, subtype and action. Any such character will be replaced with a <span class="emphasis"><em>_</em></span>
(underscore) character.</p></div></div><p>It is important to call <a class="xref" href="public-api.html#api-span-end" title="void end()edit"><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> when the span has ended.
A best practice is to use the span in a try-catch-finally block.
Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Span span = parent.startSpan("db", "mysql", "query");
try {
    span.setName("SELECT FROM customer");
    // do your thing...
} catch (Exception e) {
    span.captureException(e);
    throw e;
} finally {
    span.end();
}</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Spans created via this method can not be retrieved by calling <a class="link" href="public-api.html#api-current-span" title="Span currentSpan()edit"><code class="literal">ElasticApm.currentSpan()</code></a>.
See <a class="link" href="public-api.html#api-span-activate" title="Scope activate()edit"><code class="literal">span.activate()</code></a> on how to achieve that.</p></div></div><h4><a id="api-transaction-start-span"></a><code class="literal">Span startSpan()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Start and return a new custom span with no type as a child of this transaction.</p><p>It is important to call <a class="xref" href="public-api.html#api-span-end" title="void end()edit"><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> when the span has ended.
A best practice is to use the span in a try-catch-finally block.
Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Span span = parent.startSpan();
try {
    span.setName("SELECT FROM customer");
    // do your thing...
} catch (Exception e) {
    span.captureException(e);
    throw e;
} finally {
    span.end();
}</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Spans created via this method can not be retrieved by calling <a class="link" href="public-api.html#api-current-span" title="Span currentSpan()edit"><code class="literal">ElasticApm.currentSpan()</code></a>.
See <a class="link" href="public-api.html#api-span-activate" title="Scope activate()edit"><code class="literal">span.activate()</code></a> on how to achieve that.</p></div></div><h4><a id="api-transaction-set-result"></a><code class="literal">Transaction setResult(String result)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A string describing the result of the transaction.
This is typically the HTTP status code, or e.g. "success" for a background task</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">result</code>: a string describing the result of the transaction
</li></ul></div><h4><a id="api-transaction-end"></a><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Ends the transaction and schedules it to be reported to the APM Server.
It is illegal to call any methods on a span instance which has already ended.
This also includes this method and <a class="xref" href="public-api.html#api-transaction-start-span" title="Span startSpan()edit"><code class="literal">Span startSpan()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a>.
Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">transaction.end();</pre></div><h4><a id="api-transaction-activate"></a><code class="literal">Scope activate()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Makes this span the active span on the current thread until <code class="literal">Scope#close()</code> has been called.
Scopes should only be used in try-with-resource statements in order to make sure the <code class="literal">Scope#close()</code> method is called in all
circumstances.
Failing to close a scope can lead to memory leaks and corrupts the parent-child relationships.</p><p>This method should always be used within a try-with-resources statement:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Transaction transaction = ElasticApm.startTransaction();
// Within the try block the transaction is available
// on the current thread via ElasticApm.currentTransaction().
// This is also true for methods called within the try block.
try (final Scope scope = transaction.activate()) {
    transaction.setName("MyController#myAction");
    transaction.setType(Transaction.TYPE_REQUEST);
    // do your thing...
} catch (Exception e) {
    transaction.captureException(e);
    throw e;
} finally {
    transaction.end();
}</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p><a class="xref" href="public-api.html#api-transaction-activate" title="Scope activate()edit"><code class="literal">Scope activate()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> and <code class="literal">Scope#close()</code> have to be called on the same thread.</p></div></div><h4><a id="api-transaction-is-sampled"></a><code class="literal">boolean isSampled()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Returns true if this transaction is recorded and sent to the APM Server</p><h4><a id="api-transaction-inject-trace-headers"></a><code class="literal">void injectTraceHeaders(HeaderInjector headerInjector)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">headerInjector</code>: tells the agent how to inject a header into the request object
</li></ul></div><p>Allows for manual propagation of the tracing headers.</p><p>If you want to manually instrument an RPC framework which is not already supported by the auto-instrumentation capabilities of the agent,
you can use this method to inject the required tracing headers into the header section of that framework’s request object.</p><p>Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">span.injectTraceHeaders(request::addHeader);</pre></div><p>since 1.3.0</p><h3><a id="api-span"></a>Span API<a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>A span contains information about a specific code path, executed as part of a transaction.</p><p>If for example a database query happens within a recorded transaction,
a span representing this database query may be created.
In such a case the name of the span will contain information about the query itself,
and the type will hold information about the database type.</p><p>See <a class="xref" href="public-api.html#api-current-span" title="Span currentSpan()edit"><code class="literal">Span currentSpan()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> on how to get a reference of the current span.</p><h4><a id="api-span-set-name"></a><code class="literal">Span setName(String name)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Override the name of the current span.</p><p>Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">span.setName("SELECT FROM customer");</pre></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">name</code>: the name of the span
</li></ul></div><h4><a id="api-span-add-tag"></a><code class="literal">Span addTag(String key, String value)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A flat mapping of user-defined tags with string values.
Note: the tags are indexed in Elasticsearch so that they are searchable and aggregatable.
By all means,
you should avoid that user specified data,
like URL parameters,
is used as a tag key as it can lead to mapping explosions.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">span.setTag("foo", "bar");</pre></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">key</code>:   The tag key
</li><li class="listitem">
<code class="literal">value</code>: The tag value
</li></ul></div><h4><a id="api-span-capture-exception"></a><code class="literal">void captureException(Exception e)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Captures an exception and reports it to the APM server.</p><h4><a id="api-span-get-id"></a><code class="literal">String getId()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Returns the id of this span (never <code class="literal">null</code>)</p><p>If this span represents a noop,
this method returns an empty string.</p><h4><a id="api-span-get-trace-id"></a><code class="literal">String getTraceId()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Returns the trace-ID of this span.</p><p>The trace-ID is consistent across all transactions and spans which belong to the same logical trace,
even for transactions and spans which happened in another service (given this service is also monitored by Elastic APM).</p><p>If this span represents a noop,
this method returns an empty string.</p><h4><a id="api-span-end"></a><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Ends the span and schedules it to be reported to the APM Server.
It is illegal to call any methods on a span instance which has already ended.
This also includes this method and <a class="xref" href="public-api.html#api-span-start-span" title="Span startSpan()edit"><code class="literal">Span startSpan()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a>.</p><h4><a id="api-span-start-span-with-type"></a><code class="literal">Span startSpan(String type, String subtype, String action)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Start and return a new span with a type, a subtype and an action, as a child of this transaction.</p><p>The type, subtype and action strings are used to group similar spans together, with different resolution.
For instance, all DB spans are given the type <code class="literal">db</code>; all spans of MySQL queries are given the subtype <code class="literal">mysql</code> and all spans
describing queries are give the action <code class="literal">query</code>.
In this example <code class="literal">db</code> is considered the general type. Though there are no naming restrictions for the general types,
the following are standardized across all Elastic APM agents: <code class="literal">app</code>, <code class="literal">db</code>, <code class="literal">cache</code>, <code class="literal">template</code>, and <code class="literal">ext</code>.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p><span class="emphasis"><em>.</em></span> (dot) character is not allowed within type, subtype and action. Any such character will be replaced with a <span class="emphasis"><em>_</em></span>
(underscore) character.</p></div></div><p>It is important to call <a class="xref" href="public-api.html#api-span-end" title="void end()edit"><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> when the span has ended.
A best practice is to use the span in a try-catch-finally block.
Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Span span = parent.startSpan("db", "mysql", "query");
try {
    span.setName("SELECT FROM customer");
    // do your thing...
} catch (Exception e) {
    span.captureException(e);
    throw e;
} finally {
    span.end();
}</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Spans created via this method can not be retrieved by calling <a class="link" href="public-api.html#api-current-span" title="Span currentSpan()edit"><code class="literal">ElasticApm.currentSpan()</code></a>.
See <a class="link" href="public-api.html#api-span-activate" title="Scope activate()edit"><code class="literal">span.activate()</code></a> on how to achieve that.</p></div></div><h4><a id="api-span-start-span"></a><code class="literal">Span startSpan()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Start and return a new custom span with no type as a child of this transaction.</p><p>It is important to call <a class="xref" href="public-api.html#api-span-end" title="void end()edit"><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> when the span has ended.
A best practice is to use the span in a try-catch-finally block.
Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Span span = parent.startSpan();
try {
    span.setName("SELECT FROM customer");
    // do your thing...
} catch (Exception e) {
    span.captureException(e);
    throw e;
} finally {
    span.end();
}</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Spans created via this method can not be retrieved by calling <a class="link" href="public-api.html#api-current-span" title="Span currentSpan()edit"><code class="literal">ElasticApm.currentSpan()</code></a>.
See <a class="link" href="public-api.html#api-span-activate" title="Scope activate()edit"><code class="literal">span.activate()</code></a> on how to achieve that.</p></div></div><h4><a id="api-span-activate"></a><code class="literal">Scope activate()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Makes this span the active span on the current thread until <code class="literal">Scope#close()</code> has been called.
Scopes should only be used in try-with-resource statements in order to make sure the <code class="literal">Scope#close()</code> method is called in all
circumstances.
Failing to close a scope can lead to memory leaks and corrupts the parent-child relationships.</p><p>This method should always be used within a try-with-resources statement:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">Span span = parent.startSpan("db", "mysql", "query");
// Within the try block the span is available
// on the current thread via ElasticApm.currentSpan().
// This is also true for methods called within the try block.
try (final Scope scope = span.activate()) {
    span.setName("SELECT FROM customer");
    // do your thing...
} catch (Exception e) {
    span.captureException(e);
    throw e;
} finally {
    span.end();
}</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Calling any of the span’s methods after <a class="xref" href="public-api.html#api-span-end" title="void end()edit"><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> has been called is illegal.
You may only interact with span when you have control over its lifecycle.
For example, if a span is ended in another thread you must not add tags if there is a chance for a race between the <a class="xref" href="public-api.html#api-span-end" title="void end()edit"><code class="literal">void end()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a>
and the <a class="xref" href="public-api.html#api-span-add-tag" title="Span addTag(String key, String value)edit"><code class="literal">Span addTag(String key, String value)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></a> method.</p></div></div><h4><a id="api-span-is-sampled"></a><code class="literal">boolean isSampled()</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Returns true if this span is recorded and sent to the APM Server</p><h4><a id="api-span-inject-trace-headers"></a><code class="literal">void injectTraceHeaders(HeaderInjector headerInjector)</code><a href="https://github.com/elastic/apm-agent-java/edit/master/docs/public-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">headerInjector</code>: tells the agent how to inject a header into the request object
</li></ul></div><p>Allows for manual propagation of the tracing headers.</p><p>If you want to manually instrument an RPC framework which is not already supported by the auto-instrumentation capabilities of the agent,
you can use this method to inject the required tracing headers into the header section of that framework’s request object.</p><p>Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-java">span.injectTraceHeaders(request::addHeader);</pre></div><p>since 1.3.0</p></div><div class="navfooter"><span class="prev"><a href="faq.html">
              « 
              Frequently Asked Questions</a>
           
        </span><span class="next">
           
          <a href="opentracing-bridge.html">Elastic APM OpenTracing bridge
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
					<div id="rtpcontainer" style="display: block;">
						<div class="mktg-promo">
						<h3>Getting Started Videos</h3>
						<ul class="icons">
							<li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
							<li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
							<li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
						</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

        </div>
      	


<div id="footer-subscribe" class="home-footer-subscribe">
  <div class="subscribe-wrapper">
    <div class="container">
      <div class="subscribe-form-container">
        <div class="subscribe-title col-md-12 col-lg-6">
            <h5>Be in the know with the latest and greatest from Elastic.</h5>
        </div>
        <div class="subscribe-form col-md-12 col-lg-6">
          <form class="mktoForm sb-form"></form>
        </div>
      </div>
      <div class="form_thanks hide">
        
          <p>Thanks for subscribing! We'll keep you updated with new releases.</p>
        
      </div>
    </div>
  </div>
</div>
<!--subscribe newsletter end-->

<!-- Footer Section -->
<footer class="footer-wrapper">
  <div class="container">
    <div class="row footer-content">
        
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/products">Products ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/products/elasticsearch">Elasticsearch</a></li>
                  
                
              
                
                  
                    <li><a href="/products/kibana">Kibana</a></li>
                  
                
              
                
                  
                    <li><a href="/products/beats">Beats</a></li>
                  
                
              
                
                  
                    <li><a href="/products/logstash">Logstash</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack">Stack Features (formerly X-Pack)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/security">Security</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/alerting">Alerting</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/canvas">Canvas</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/monitoring">Monitoring</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/graph">Graph</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/reporting">Reporting</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/machine-learning">Machine Learning</a></li>
                  
                
              
                
                  
                    <li><a href="/products/stack/elasticsearch-sql">Elasticsearch SQL</a></li>
                  
                
              
                
                  
                    <li><a href="/products/hadoop">Elasticsearch-Hadoop</a></li>
                  
                
              
                
                  
                    <li><a href="/products/ece">Elastic Cloud Enterprise</a></li>
                  
                
              
              </ul>
              
                <h3><a href=""></a></h3>
              
              
              
              <ul class="">
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/solutions">Solutions ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/solutions/logging">Logging</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/metrics">Metrics</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/site-search">Site Search</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/security-analytics">Security Analytics</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/apm">APM</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/app-search">App Search</a></li>
                  
                
              
              </ul>
              
                <h3><a href="/cloud">Elastic Cloud ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/cloud/elasticsearch-service">Elasticsearch Service</a></li>
                  
                
              
                
                  
                    <li><a href="/aws-elasticsearch-service">AWS Elasticsearch Service Comparison</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud/app-search-service">Elastic App Search Service</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud/site-search-service">Elastic Site Search Service</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3>Resources</h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/blog">Blog</a></li>
                  
                
              
                
                  
                    <li><a href="https://cloud-status.elastic.co">Cloud Status</a></li>
                  
                
              
                
                  
                    <li><a href="/community">Community</a></li>
                  
                
              
                
                  
                    <li><a href="/use-cases">Customers & Use Cases</a></li>
                  
                
              
                
                  
                    <li><a href="/guide">Documentation</a></li>
                  
                
              
                
                  
                    <li><a href="/elasticon">Elastic{ON} Events</a></li>
                  
                
              
                
                  
                    <li><a href="https://discuss.elastic.co/">Forums</a></li>
                  
                
              
                
                  
                    <li><a href="/community/meetups">Meetups</a></li>
                  
                
              
                
                  
                    <li><a href="/subscriptions">Subscriptions</a></li>
                  
                
              
                
                  
                    <li><a href="https://support.elastic.co">Support Portal</a></li>
                  
                
              
                
                  
                    <li><a href="/videos">Videos & Webinars</a></li>
                  
                
              
                
                  
                    <li><a href="/training">Training</a></li>
                  
                
              
              </ul>
              
                <h3></h3>
              
              
              
              <ul class="">
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/about">About ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/about/careers">Careers/Jobs</a></li>
                  
                
              
                
                  
                    <li><a href="/about/our-source-code">Our Source Code</a></li>
                  
                
              
                
                  
                    <li><a href="/about/teams">Teams</a></li>
                  
                
              
                
                  
                    <li><a href="/about/teams/board">Board of Directors</a></li>
                  
                
              
                
                  
                    <li><a href="/about/teams/leadership">Leadership</a></li>
                  
                
              
                
                  
                    <li><a href="/contact">Contact</a></li>
                  
                
              
                
                  
                    <li><a href="/about/history-of-elasticsearch">Our Story</a></li>
                  
                
              
                
                  
                    <li><a href="/about/why-open-source">Why Open Source</a></li>
                  
                
              
                
                  
                    <li><a href="/about/distributed">Distributed by Intention</a></li>
                  
                
              
                
                  
                    <li><a href="/about/partners">Partners</a></li>
                  
                
              
                
                  
                    <li><a href="/about/press">Media</a></li>
                  
                
              
                
                  
                    <li><a href="https://ir.elastic.co">Investor Relations</a></li>
                  
                
              
                
                  
                    <li><a href="https://www.elastic.shop">Elastic Store</a></li>
                  
                
              
              </ul>
              
                <h3><a href=""></a></h3>
              
              
              
              <ul class="">
              
              </ul>
          </div>    
       
    </div>
     <!-- Social Media Section -->
    <div class="row social-icon">
      <div class="col-xs-12 col-sm-12 col-md-6 col-md-offset-3">
	    <div class="row">
		     <div class="follow-us col-xs-12 col-sm-12 col-md-12">
			    <div class="social-label">FOLLOW US</div>
			    <ul class="social-icon-list">
          
          		 	<li class="Facebook"><a id="footer_facebook" href="https://www.facebook.com/elastic.co">Facebook</a></li>
          
          		 	<li class="Twitter"><a id="footer_twitter" href="https://www.twitter.com/elastic">Twitter</a></li>
          
          		 	<li class="LinkedIn"><a id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co">LinkedIn</a></li>
          
          		 	<li class="Xing"><a id="footer_xing" href="https://www.xing.com/companies/elastic.co">Xing</a></li>
          
          		 	<li class="YouTube"><a id="footer_youtube" href="https://www.youtube.com/user/elasticsearch">YouTube</a></li>
          
		  		</ul>
		     </div>
	    </div>
      </div>
    </div>
    <!-- Social Media Section end-->
    <div class="row">
	<div class="col-xs-12 col-sm-12 col-md-11">
		<div class="copyright">
			<ul>
				<li><a href="/legal/trademarks">Trademarks</a></li>
				<li><a href="/legal/terms-of-use">Terms of Use</a></li>
				<li><a href="/legal/privacy-statement">Privacy</a></li>
				<li><a href="/brand">Brand</a></li>
			</ul>
			<div class="copyright-content">
				<div class="footer-text">
					<p>© 2019. Elasticsearch B.V. All Rights Reserved
					</p>
					<p>Elasticsearch is a trademark of Elasticsearch B.V., registered in the U.S. and in other countries.
					</p>
					<p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a> in the United States and/or other countries.
					</p>
				</div>
			</div>
		</div>
	</div>
	<div class="col-xs-2 col-xs-offset-5 col-sm-1 col-sm-offset-5 col-md-1 col-md-offset-0">
		<div class="footer-logo"><a href="/"><img src="/static/images/svg/logo-elastic-footer-stacked-999.svg" class="img-responsive"></a>
		</div>
	</div>
</div>
  </div>
</footer>
<!-- Footer Section end-->

<style type="text/css">
	
        
            .Facebook a {background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
            .Facebook a:before {
                content: url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Facebook a:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
        
	
        
            .Twitter a {background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
            .Twitter a:before {
                content: url("/assets/blt90b0372cc07a54d3/twitter-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Twitter a:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
        
	
        
            .LinkedIn a {background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
            .LinkedIn a:before {
                content: url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .LinkedIn a:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
        
	
        
            .Xing a {background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
            .Xing a:before {
                content: url("/assets/bltededebe5f7521a39/xing-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Xing a:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
        
	
        
            .YouTube a {background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
            .YouTube a:before {
                content: url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .YouTube a:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
        
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
$(document).ready(function(){

    var ipSuccess = function(data) {
        country = data.country_code;
        if (data.in_eu){
                        
            marketo_id = "6196";
            
        }else{ 
            marketo_id = "1398";

        }

        $('.subscribe-form form.sb-form').attr('id', 'mktoForm_' + marketo_id);
        if(window.MktoForms2){
            MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", marketo_id,function(form){
                form.onSuccess(function(form){
                    $('#mktoForm_'+marketo_id).css('display','none');
                    $('.subscribe-wrapper .subscribe-form-container').hide();
                    $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
                    dataLayer.push({'event': 'mktoFormSubmit'});
                    return false;
                });
            });  
        }
    }

    var marketo_id;

    $.ajax({
        url: "/gdpr-data"
    }).success(function(data) {
        ipSuccess(data);
    });

})
</script>

      </section>
    </div>

    
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script>
 
     
<script type="text/javascript">
$(document).ready(function(){
	if (window.location.hash.length) {
	      var target = $(window.location.hash);
	      target = target.length ? target : $(window.location.hash);
	      if (target.length) {
	        setTimeout(function(){ $(window).scrollTop(target.offset().top - 60); }, 1200);        
	      }
	}
	$('#guide').on('click','a[href*=#]:not([href=#])',function(e) {
			var flag=true;
		      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
		          var target = $(this.hash);
		          target = target.length ? target :$(this.hash);
		          if (target.length) {
		            if(flag){
		              flag=false;
		              var heightScroll=($('.tertiary-nav.navbar-fixed-top').height())?60:110;
		              $('html,body').animate({
		                  scrollTop: target.offset().top - heightScroll
		                }, 2000, function(){
		                  flag=true;
		                });
		            }                    
		          }
		      }
		    
	});

})

</script>

     <style></style>
     
  
            <script type="text/javascript" src="docs.js"></script>
<script type='text/javascript' src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=yaml'></script>

            </body>
        
</html>