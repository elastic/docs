<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Securing Communication With Elasticsearch
        | Metricbeat Reference [5.3]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Metricbeat Reference [5.3]" /><link rel="up" href="securing-meticbeat.html" title="Securing Metricbeat" /><link rel="prev" href="securing-meticbeat.html" title="Securing Metricbeat" /><link rel="next" href="configuring-ssl-logstash.html" title="Securing Communication With Logstash by Using SSL" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Metricbeat/Reference/5.3" /></head><body><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Metricbeat Reference
      [5.3]
    </a></span> » <span class="breadcrumb-link"><a href="securing-meticbeat.html">Securing Metricbeat</a></span> » <span class="breadcrumb-node">Securing Communication With Elasticsearch</span></div><div xmlns="" class="navheader"><span class="prev"><a href="securing-meticbeat.html">
              « 
              Securing Metricbeat</a>
           
        </span><span class="next">
           
          <a href="configuring-ssl-logstash.html">Securing Communication With Logstash by Using SSL
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="securing-communication-elasticsearch"></a>Securing Communication With Elasticsearch<a xmlns="" href="https://github.com/elastic/beats/edit/5.3/libbeat/docs/https.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>To secure the communication between Metricbeat and Elasticsearch, you can use HTTPS
and basic authentication. Here is a sample configuration:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">output.elasticsearch:
  username: metricbeat <a id="CO9-1"></a><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span>
  password: verysecret <a id="CO9-2"></a><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span>
  protocol: https <a id="CO9-3"></a><span xmlns=""><img src="images/icons/callouts/3.png" alt="" /></span>
  hosts: ["elasticsearch.example.com:9200"] <a id="CO9-4"></a><span xmlns=""><img src="images/icons/callouts/4.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO9-1"><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The username to use for authenticating to Elasticsearch.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO9-2"><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The password to use for authenticating to Elasticsearch.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO9-3"><span xmlns=""><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
This setting enables the HTTPS protocol.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO9-4"><span xmlns=""><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The IP and port of the Elasticsearch nodes.
</p></td></tr></table></div><p>Elasticsearch doesn’t have built-in basic authentication, but you can achieve it
either by using a web proxy or by using X-Pack to secure Elasticsearch. For more
information, see the X-Pack documentation about
<a class="ulink" href="https://www.elastic.co/guide/en/x-pack/5.2/xpack-security.html" target="_top">securing Elasticsearch</a>, including the topic
about <a class="ulink" href="https://www.elastic.co/guide/en/x-pack/5.2/beats.html" target="_top">Beats and security</a>.</p><p>Metricbeat verifies the validity of the server certificates and only accepts trusted
certificates. Creating a correct SSL/TLS infrastructure is outside the scope of
this document.</p><p>By default Metricbeat uses the list of trusted certificate authorities from the
operating system where Metricbeat is running. You can configure Metricbeat to use a specific list of
CA certificates instead of the list from the OS. You can also configure it to use client authentication
by specifying the certificate and key to use when the server requires the Beat to authenticate. Here is an example
configuration:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">output.elasticsearch:
  username: metricbeat
  password: verysecret
  protocol: https
  hosts: ["elasticsearch.example.com:9200"]
  ssl.certificate_authorities: <a id="CO10-1"></a><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span>
    - /etc/pki/my_root_ca.pem
    - /etc/pki/my_other_ca.pem
  ssl.certificate: "/etc/pki/client.pem" <a id="CO10-2"></a><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span>
  ssl.key: "/etc/pki/key.pem" <a id="CO10-3"></a><span xmlns=""><img src="images/icons/callouts/3.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO10-1"><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The list of CA certificates to trust
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO10-2"><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The path to the certificate for SSL client authentication
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO10-3"><span xmlns=""><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The client certificate key
</p></td></tr></table></div><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">For any given connection, the SSL/TLS certificates must have a subject
that matches the value specified for <code class="literal">hosts</code>, or the SSL handshake fails.
For example, if you specify <code class="literal">hosts: ["foobar:9200"]</code>, the certificate MUST
include <code class="literal">foobar</code> in the subject (<code class="literal">CN=foobar</code>) or as a subject alternative name
(SAN). Make sure the hostname resolves to the correct IP address. If no DNS is available, then
you can associate the IP address with your hostname in <code class="literal">/etc/hosts</code>
(on Unix) or <code class="literal">C:\Windows\System32\drivers\etc\hosts</code> (on Windows).</p></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="securing-meticbeat.html">
              « 
              Securing Metricbeat</a>
           
        </span><span class="next">
           
          <a href="configuring-ssl-logstash.html">Securing Communication With Logstash by Using SSL
               »
            </a></span></div></body></html>