<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Configuring Metricbeat to Use Ingest Node
        | Metricbeat Reference [5.3]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Metricbeat Reference [5.3]" /><link rel="up" href="configuring-howto-metricbeat.html" title="Configuring Metricbeat" /><link rel="prev" href="filtering-and-enhancing-data.html" title="Filtering and Enhancing the Exported Data" /><link rel="next" href="config-metricbeat-logstash.html" title="Configuring Metricbeat to Use Logstash" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Metricbeat/Reference/5.3" /></head><body><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Metricbeat Reference
      [5.3]
    </a></span> » <span class="breadcrumb-link"><a href="configuring-howto-metricbeat.html">Configuring Metricbeat</a></span> » <span class="breadcrumb-node">Configuring Metricbeat to Use Ingest Node</span></div><div xmlns="" class="navheader"><span class="prev"><a href="filtering-and-enhancing-data.html">
              « 
              Filtering and Enhancing the Exported Data</a>
           
        </span><span class="next">
           
          <a href="config-metricbeat-logstash.html">Configuring Metricbeat to Use Logstash
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="configuring-ingest-node"></a>Configuring Metricbeat to Use Ingest Node<a xmlns="" href="https://github.com/elastic/beats/edit/5.3/libbeat/docs/shared-config-ingest.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>When you use Elasticsearch for output, you can configure Metricbeat to use
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/5.3/ingest.html" target="_top">ingest node</a> to pre-process documents
before the actual indexing takes place in Elasticsearch. Ingest node is a convenient processing option when you
want to do some extra processing on your data, but you do not require the full power of Logstash. For
example, you can create an ingest node pipeline in Elasticsearch that consists of one processor
that removes a field in a document followed by another processor that renames a field.</p><p>After defining the pipeline in Elasticsearch, you simply configure your Beat to use the pipeline. To configure
Metricbeat, you specify the pipeline ID in the <code class="literal">parameters</code> option under <code class="literal">elasticsearch</code> in the
<code class="literal">metricbeat.yml</code> file:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["localhost:9200"]
  pipeline: my_pipeline_id</pre></div><p>For example, let’s say that you’ve defined the following pipeline in a file named <code class="literal">pipeline.json</code>:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-json">{
    "description": "Test pipeline",
    "processors": [
        {
            "lowercase": {
                "field": "beat.name"
            }
        }
    ]
}</pre></div><p>To add the pipeline in Elasticsearch, you would run:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">curl -H 'Content-Type: application/json' -XPUT 'http://localhost:9200/_ingest/pipeline/test-pipeline' -d@pipeline.json</pre></div><p>Then in the <code class="literal">metricbeat.yml</code> file, you would specify:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["localhost:9200"]
  pipeline: "test-pipeline"</pre></div><p>When you run Metricbeat, the value of <code class="literal">beat.name</code> is converted to lowercase before indexing.</p><p>For more information about defining a pre-processing pipeline, see the <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/5.3/ingest.html" target="_top">Ingest Node</a>
documentation.</p></div><div xmlns="" class="navfooter"><span class="prev"><a href="filtering-and-enhancing-data.html">
              « 
              Filtering and Enhancing the Exported Data</a>
           
        </span><span class="next">
           
          <a href="config-metricbeat-logstash.html">Configuring Metricbeat to Use Logstash
               »
            </a></span></div></body></html>